<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <title>Smalltalk76/Windows.st</title>
	<link rel="stylesheet" type="text/css" href="font.css"/>
  </head>
  <body>
    <div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">&rsquo;From Smalltalk 5.5k XM November 24 on 22 November 1980 at 2:57:08 am.&rsquo;<br></span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span class="medium bold">"FontWindow"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold">Class new title: &rsquo;FontWindow&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">subclassof: Object<br></span><span class="tab" val="79"></span><span class="medium bold">fields: &rsquo;frame font fontht fontraster fontxtabl bitsetter char charx charwid charstr altostyle fontnumber clearframe scale boxer&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">declare: &rsquo;fontmenu &rsquo;;<br></span><span class="tab" val="79"></span><span class="medium bold">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small italic"><br>I am a window that displays one blown up character at a time of a strike-format font</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Help</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">help<br></span><span class="small">[</span><span class="small italic">"<br>**sysFontWindow is declared in the Smalltalk dictionary, and bound to the font window displayed on the screen of most system releases -- intended to provide an easy way to play around with the font editor.<br>**to create a window for editing default font 0 at middle-click:<br></span><span class="tab" val="79"></span><span class="small italic"> user schedule: (sysFontWindow &larr; FontWindow new<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">altostyle: DefaultTextStyle<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">fontnumber: 1<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">at: (OriginCursor showwhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">[user waitbug ⇒[user mp]])).<br>**to create a new font<br></span><span class="tab" val="79"></span><span class="small italic">yourfont &larr; FontWindow new newfont: 16 maxcharwidth: 16 min: 0<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">max: 177 ascent: 12 kern: 0.<br><br>**to edit newly created font<br></span><span class="tab" val="79"></span><span class="small italic">yourtextstyle setfont: n name: yourfont.</span><span class="tab" val="79"></span><span class="small italic">**insert it into a TextStyle<br></span><span class="tab" val="79"></span><span class="small italic">**now create a window as above with yourtextstyle and appropriate<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">fontnumber<br></span><span class="tab" val="79"></span><span class="small italic"><br><br>**examples of manual manipulation of yourfontwindow:<br></span><span class="tab" val="79"></span><span class="small italic">sysFontWindow setascent: 2.</span><span class="tab" val="79"></span><span class="small italic">**Deltas -- for entire font**<br></span><span class="tab" val="79"></span><span class="small italic">sysFontWindow setascent: ¬3.<br></span><span class="tab" val="79"></span><span class="small italic">sysFontWindow setdescent: 2.<br></span><span class="tab" val="79"></span><span class="small italic">sysFontWindow setdescent: ¬2.<br></span><span class="tab" val="79"></span><span class="small italic">sysFontWindow setchar: 046.<br></span><span class="tab" val="79"></span><span class="small italic">sysFontWindow setwidth: 5.</span><span class="tab" val="79"></span><span class="small italic">**Absolute--for char in window. <br></span><span class="tab" val="79"></span><span class="small italic">Useful for characters of zero width.**<br>"</span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">altostyle: altostyle fontnumber: fontnumber at: origin<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"set up an instance"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[fontmenu≡nil⇒[self init]].<br></span><span class="tab" val="79"></span><span class="small">scale &larr; 9. charstr &larr; String new: 1. char &larr; 65. charstr◦1 &larr; char.<br></span><span class="tab" val="79"></span><span class="small">bitsetter &larr; BitBlt init.<br></span><span class="tab" val="79"></span><span class="small">boxer &larr; Rectangle new<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">origin: 0 ⌾ 0 extent: (scale-1) ⌾ (scale-1).<br></span><span class="tab" val="79"></span><span class="small">frame &larr; Rectangle  new origin: origin  extent:  scale ⌾ 0.<br></span><span class="tab" val="79"></span><span class="small">clearframe &larr; Rectangle  new origin: origin  extent:  scale ⌾ 0.<br></span><span class="tab" val="79"></span><span class="small">self setfont: altostyle fonts◦fontnumber.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">classInit<br></span><span class="tab" val="79"></span><span class="small">[fontmenu &larr; Menu new string:<br>&rsquo;strike<br>set width<br>debug<br>move<br>close&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Scheduler</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">eachtime</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"while active"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[clearframe has: user mp⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[user redbug ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[self setbit: user mp color: black]</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"make dot black"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user yellowbug ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[self setbit: user mp color: white]</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"make dot white"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user bluebug ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[fontmenu bug<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=1⇒[self strike];</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"put strike of font in dialogue window"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=2⇒[self setwidth];</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"grow character"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=3⇒[self updateseglength: font raster: fontraster.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">self updatemaxwidth.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"clean things up"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user notify: &rsquo;font debugging&rsquo;];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=4⇒[self frame];</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"move fontwindow"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=5⇒[clearframe clear.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">self updateseglength: font raster: fontraster.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">self updatemaxwidth.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"clean things up"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user unschedule: self. ⇑false]]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user kbck⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[char &larr; user kbd. self setchar: char]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">user anybug⇒[⇑false]<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold"> firsttime</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"upon entry"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">clearframe has: user mp⇒[self show]<br></span><span class="tab" val="79"></span><span class="small">⇑false<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">lasttime</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"upon exit"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Editing</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">setascent: ascentdelta </span><span class="small">| updatedfont ascent<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small"> </span><span class="small italic">"ascent delta"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">ascent &larr; font word: 6.<br></span><span class="tab" val="79"></span><span class="small">[ascent + ascentdelta &lt; 0 ⇒[ascentdelta &larr; 0 - ascent]].<br></span><span class="tab" val="79"></span><span class="small">[ascentdelta &gt; 0 ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">updatedfont &larr; String new: (2 * fontraster * ascentdelta).</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"grow"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">updatedfont all &larr;  0.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"fill with white"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">updatedfont &larr;</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"add oldfont header and new space together"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(font◦(1 to: 18) concat: updatedfont◦(1 to: updatedfont length)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">updatedfont &larr;</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"now add on rest of old font"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(updatedfont concat: font◦(19 to: font length)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">updatedfont &larr; (font◦(1 to: 18) concat:</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"shrink"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">font◦((19 + (0 - (2 * fontraster * ascentdelta))) to: font length)).<br></span><span class="tab" val="79"></span><span class="small">].<br></span><span class="tab" val="79"></span><span class="small">updatedfont word: 6 &larr; ascent + ascentdelta.</span><span class="tab" val="79"></span><span class="small italic">"reset ascent word in font"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">self setfont: updatedfont.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"updatedfont now font of interest"<br></span><span class="tab" val="79"></span><span class="small">self updateseglength: font raster: fontraster.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">setbit: bitpoint color: color</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"turn bits on, off"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">| x y<br></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">bitpoint &larr;  bitpoint - frame origin.<br></span><span class="tab" val="79"></span><span class="small"> x &larr; (0 max: (charwid-1)) min: (bitpoint x/scale).<br></span><span class="tab" val="79"></span><span class="small"> y &larr; (0 max: (fontht-1)) min: (bitpoint y/scale).<br></span><span class="tab" val="79"></span><span class="small"> boxer moveto: frame origin + ((scale*x) ⌾ (scale*y)).<br></span><span class="tab" val="79"></span><span class="small"> boxer color: color mode: storing.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"turn bit on/off in blowup"</span><span class="small"><br><br></span><span class="tab" val="79"></span><span class="small">bitsetter destraster &larr; fontraster.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"set up bitblt table."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">bitsetter destx &larr; charx + x.<br></span><span class="tab" val="79"></span><span class="small">bitsetter desty &larr; y.<br></span><span class="tab" val="79"></span><span class="small">bitsetter destbase &larr; font; dstrike&larr; true.  </span><span class="small italic">"lock font and get core ptr"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">bitsetter fill: storing color: color.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"turn bit on/off in font"</span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">setchar: char<br></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">charstr◦1 &larr;  char.<br></span><span class="tab" val="79"></span><span class="small">[((font word: 2) ≤ char) and: (char ≤ (font word: 3))⇒<br></span><span class="tab" val="79"></span><span class="small">[char &larr; char - (font word: 2)]<br></span><span class="tab" val="79"></span><span class="small">char &larr; ((font word: 3) - (font word: 2)) + 1].</span><span class="tab" val="79"></span><span class="small italic">"char out of range"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">charx &larr; (font word: (fontxtabl+ (char))).<br></span><span class="tab" val="79"></span><span class="small">charwid &larr; (font word: (fontxtabl + char+1)) - charx.<br></span><span class="tab" val="79"></span><span class="small">clearframe clear.<br></span><span class="tab" val="79"></span><span class="small">frame extent &larr; charwid ⌾  fontht.<br></span><span class="tab" val="79"></span><span class="small">clearframe &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">frame inset: ¬2 ⌾ ¬2</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"for clearing everything including outline"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">and: (charwid - (charwid * scale + 2)) ⌾ (fontht - (fontht * scale + 2)).<br></span><span class="tab" val="79"></span><span class="small">self show.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">setdescent: descentdelta </span><span class="small">| updatedfont descent space<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"descent delta"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">descent &larr; font word: 7.<br></span><span class="tab" val="79"></span><span class="small">[descent + descentdelta &lt; 0 ⇒ [ descentdelta &larr; 0 - descent]].<br></span><span class="tab" val="79"></span><span class="small">[descentdelta &gt; 0 ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[space &larr; String new: 2 * fontraster * descentdelta.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">space all &larr; 0.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">updatedfont &larr; (font ◦ (1 to: fontxtabl - 1 * 2) concat: space).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">updatedfont &larr; (self appendxtable: updatedfont).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">updatedfont &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(font ◦ (1 to: ((fontxtabl - 1 * 2) + (fontraster * descentdelta * 2)))).<br></span><span class="tab" val="79"></span><span class="small">updatedfont &larr; (self appendxtable: updatedfont).<br></span><span class="tab" val="79"></span><span class="small">].<br></span><span class="tab" val="79"></span><span class="small">updatedfont word: 7 &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">descent + descentdelta.</span><span class="tab" val="79"></span><span class="small italic">"reset descent word in font"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">self setfont: updatedfont.</span><span class="tab" val="79"></span><span class="small italic">"updatedfont now font of interest"<br></span><span class="tab" val="79"></span><span class="small">self updateseglength: font raster: fontraster.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">setfont: font<br></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">altostyle fonts ◦ fontnumber &larr; font.<br></span><span class="tab" val="79"></span><span class="small">fontraster &larr; font word: 9.<br></span><span class="tab" val="79"></span><span class="small">fontht &larr; (font word: 6) + ( font word: 7).</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"ascent + descent"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">fontxtabl &larr; fontraster * fontht + 9 </span><span class="small italic">"header"</span><span class="small"> + 1 </span><span class="small italic">"for 0 addressing"</span><span class="small">.<br></span><span class="tab" val="79"></span><span class="small">bitsetter width &larr;  1. bitsetter height &larr; 1.<br></span><span class="tab" val="79"></span><span class="small">self setchar: charstr◦1.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">setwidth </span><span class="small">| newextentx outlineframe<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"get new size"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">outlineframe &larr; clearframe inset: 1 ⌾ 1 and: 0 ⌾ 1.<br></span><span class="tab" val="79"></span><span class="small">OriginCursor showwhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[user waitbug⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[while⦂ user anybug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[outlineframe growto:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">((clearframe origin x + 2) +<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(newextentx &larr; (user mp x - clearframe origin x + 2) | scale))<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small"> ⌾ (outlineframe corner y).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">outlineframe border: 2 color: black.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">outlineframe border: 2 color: background<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">outlineframe border: 2 color: black.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">self setwidth: newextentx / scale.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">setwidth: delta<br></span><span class="tab" val="79"></span><span class="small">| fontrightx newraster newxtabl newmaxwidth updatedfont i<br><br></span><span class="tab" val="79"></span><span class="small">[</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"change in width"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">delta &larr; delta - charwid. delta = 0 ⇒ [self show. ⇑false].<br></span><span class="tab" val="79"></span><span class="small">fontrightx &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">font word: (fontxtabl + ((font word: 3) - (font word: 2)) + 2).<br></span><span class="tab" val="79"></span><span class="small">newraster &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[(fontrightx + 15 / 16) ≠ (i &larr; (fontrightx + delta + 15 / 16)) ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[ i ] fontraster].<br></span><span class="tab" val="79"></span><span class="small">newxtabl &larr; newraster * fontht + 9 </span><span class="small italic">"header"</span><span class="small"> + 1 </span><span class="small italic">"for 0 addressing"</span><span class="small">.<br><br></span><span class="tab" val="79"></span><span class="small">XeqCursor showwhile⦂ <br></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">updatedfont &larr; String new:<br></span><span class="tab" val="79"></span><span class="small">(9 </span><span class="small italic">"header"</span><span class="small"> + (newraster * fontht </span><span class="small italic">"bits"</span><span class="small">)) * 2.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"grow/shrink the bits"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: 8 do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[updatedfont word: i &larr; font word: i].</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"fill in header of new font"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">updatedfont word: 9 &larr; newraster.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"set raster in new font"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small italic">"copy the xtable"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">updatedfont &larr; (self appendxtable: updatedfont).<br><br></span><span class="tab" val="79"></span><span class="small italic">"set up to copy up to old bits of char"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">bitsetter destraster &larr; newraster.<br></span><span class="tab" val="79"></span><span class="small">bitsetter destx &larr; 0. bitsetter desty &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">bitsetter sourcex &larr; 0. bitsetter sourcey &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">bitsetter width &larr; charx + charwid.<br></span><span class="tab" val="79"></span><span class="small">bitsetter height &larr; fontht.<br></span><span class="tab" val="79"></span><span class="small">bitsetter sourceraster &larr; fontraster.<br></span><span class="tab" val="79"></span><span class="small">bitsetter destbase &larr; updatedfont.<br></span><span class="tab" val="79"></span><span class="small">bitsetter sourcebase &larr; font.<br></span><span class="tab" val="79"></span><span class="small">bitsetter sstrike&larr; true; dstrike&larr; true.<br></span><span class="tab" val="79"></span><span class="small">bitsetter copy: storing.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"if char grown, clean out right side of char"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">delta&lt; 0 ⇒[]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">bitsetter destx &larr; charx + charwid.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">bitsetter width &larr; delta.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">bitsetter fill: storing color: 0.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"now copy remainder of font"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">bitsetter destx &larr; charx + charwid + delta.<br></span><span class="tab" val="79"></span><span class="small">bitsetter width &larr; fontrightx - charx - charwid.<br></span><span class="tab" val="79"></span><span class="small">bitsetter sourcex &larr; charx + charwid.<br></span><span class="tab" val="79"></span><span class="small">bitsetter copy: storing.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"shift x-vals"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">for⦂ i from: ((char + 1)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">to: (2 + (updatedfont word: 3) - (updatedfont word: 2) </span><span class="small italic">"max"</span><span class="small">)) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[updatedfont word: (newxtabl + i) &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">delta + (updatedfont word: (newxtabl +i ))].<br></span><span class="tab" val="79"></span><span class="small">clearframe clear.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"clear out old version of character"<br></span><span class="tab" val="79"></span><span class="small">self setfont: updatedfont.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"set up the new copy of the font"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">self updateseglength: font raster: fontraster.<br></span><span class="tab" val="79"></span><span class="small">self updatemaxwidth.<br></span><span class="tab" val="79"></span><span class="small">].<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Image</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">frame<br></span><span class="tab" val="79"></span><span class="small">[clearframe clear.<br></span><span class="tab" val="79"></span><span class="small">frame moveto:<br></span><span class="tab" val="79"></span><span class="small">(OriginCursor showwhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[user waitbug⇒[user mp]]).<br></span><span class="tab" val="79"></span><span class="small">self setchar: char.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">show </span><span class="small">|</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"refresh window"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">tempframe showrun showpara<br></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">showrun &larr; String new: 2.<br></span><span class="tab" val="79"></span><span class="small">showrun word: 1 &larr;  16 * (fontnumber-1) + 0177400.<br></span><span class="tab" val="79"></span><span class="small">showpara &larr; Paragraph new text: charstr runs: showrun alignment: 0.<br></span><span class="tab" val="79"></span><span class="small">tempframe &larr; Textframe new para: showpara frame: frame style: altostyle.<br></span><span class="tab" val="79"></span><span class="small">tempframe show.<br></span><span class="tab" val="79"></span><span class="small">frame blowup: (frame origin) by: scale.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Strike format</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">appendxtable: thefont<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"put fontⓢxtable on end of a grown/shrunk font"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">thefont &larr; thefont concat: font ◦ ((fontxtabl * 2 - 1) to: font length).<br></span><span class="tab" val="79"></span><span class="small">⇑thefont.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">cufixup </span><span class="small">|  </span><span class="small italic">"Carnegie-Mellon fixup for scale compatibility"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[boxer extent &larr; (scale-1)⌾(scale-1).<br></span><span class="tab" val="79"></span><span class="small">frame extent &larr; scale⌾0.<br></span><span class="tab" val="79"></span><span class="small">clearframe extent &larr; scale⌾0.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">makecu: name scale: cuscale  </span><span class="small italic">"Put out font in Carnegie-Mellon format"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">| f svscale svchar  bitwidth i bitmover bits<br></span><span class="tab" val="79"></span><span class="small">[f &larr; dp0 file: name + &rsquo;.cu.&rsquo;.<br></span><span class="tab" val="79"></span><span class="small">self updateseglength: font raster: fontraster.  self updatemaxwidth.<br></span><span class="tab" val="79"></span><span class="small">svscale &larr; scale. scale &larr; cuscale.  svchar &larr; char.<br></span><span class="tab" val="79"></span><span class="small">self cufixup.<br></span><span class="tab" val="79"></span><span class="small">f nextword &larr; fontht*scale.<br></span><span class="tab" val="79"></span><span class="small">f nextword &larr; (bitwidth &larr; (font word: 4)) * scale + 15 / 16.<br></span><span class="tab" val="79"></span><span class="small">bits &larr; String new: ((fontht * scale) * ((bitwidth * scale + 15)/16)) * 2.<br></span><span class="tab" val="79"></span><span class="small">bitmover &larr; BitBlt init.<br></span><span class="tab" val="79"></span><span class="small">bitmover destbase &larr; bits lock.<br></span><span class="tab" val="79"></span><span class="small">bitmover destraster &larr; bitwidth * scale + 15 / 16.<br></span><span class="tab" val="79"></span><span class="small">bitmover destx &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">bitmover desty &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">bitmover sourcebase &larr; mem◦066.<br></span><span class="tab" val="79"></span><span class="small">bitmover sourceraster &larr; (user screenrect extent x) + 15/16.<br></span><span class="tab" val="79"></span><span class="small">bitmover sourcex &larr; frame origin x.<br></span><span class="tab" val="79"></span><span class="small">bitmover sourcey &larr; frame origin y.<br></span><span class="tab" val="79"></span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">for⦂ i from: ((font word: 2) to: (font word: 3) by: 1) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[self setchar: i.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">f nextword &larr; i. f nextword &larr; charwid*scale.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">bitmover width &larr; (frame extent x) * scale.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">bitmover height &larr; (frame extent y) * scale.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">bits all &larr; 0.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">bitmover copy: storing.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">f append: bits].<br></span><span class="tab" val="79"></span><span class="small">f close. scale &larr; svscale. self cufixup. bits unlock. self setchar: svchar]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">newfont: fontht maxcharwidth: maxcharwidth min: min max: max ascent: ascent kern: kern<br></span><span class="tab" val="79"></span><span class="small">| raster i x<br></span><span class="tab" val="79"></span><span class="small">[XeqCursor showwhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[raster &larr; (2 + max - min * maxcharwidth + 15)/16.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">font &larr; String new:  (3 + max - min + (fontht * raster) + 9 * 2).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">font word: 1 &larr; 0100000.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"format: strike, simple, varwidth"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">font word: 2 &larr; min.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"min ascii code"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">font word: 3 &larr; max.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"max ascii code"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">font word: 4 &larr; maxcharwidth.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"max char width"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">font word: 5 &larr; (2+max-min + 5 + (fontht*raster)).</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"segment length"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">font word: 6 &larr; ascent.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"bits above baseline"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">font word: 7 &larr; fontht-ascent.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"bits below baseline"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">font word: 8 &larr; kern.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"kerning offset"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">font word: 9 &larr; raster.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"#words per scan-line in bitmap"</span><span class="small"><br><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(font◦((18 + 1) to: 2 * raster * fontht + 18)) all &larr; 0.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"chars all white"</span><span class="small"><br><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">ascent &larr; ascent min: (fontht-1).</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"keep baseline within char"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(font◦(2 * raster * ascent + 18 + 1 to:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">ascent+1*raster*2 + 18)) all &larr; 0377.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"put in a black baseline"</span><span class="small"><br><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">x &larr; 0.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">for⦂ i  from: (raster * fontht + 9 + 1 to:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">raster * fontht + 9 + 3 + max - min by: 1) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[font word: i &larr; x. x &larr; x+maxcharwidth].</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"table of left x"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">].<br></span><span class="tab" val="79"></span><span class="small">⇑font.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">strike </span><span class="small">| i</span><span class="tab" val="79"></span><span class="small">showstr </span><span class="small italic">"Put a strike of font into dialogue window"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[showstr &larr; String new: 128. for⦂ i to: 128 do⦂ [showstr◦i &larr;i].<br></span><span class="tab" val="79"></span><span class="small">user clearshow: showstr]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">updatemaxwidth </span><span class="small">| newmaxwidth i<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"update max width"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">newmaxwidth &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">for⦂ i from: (fontxtabl to: fontxtabl + ((font word: 3) - (font word: 2) + 1) by: 1) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[newmaxwidth &larr; (newmaxwidth max: ((font word: i+1) - (font word: i)))].<br></span><span class="tab" val="79"></span><span class="small">font word: 4 &larr; newmaxwidth.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">updateseglength: newfont raster: newraster<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"compute new segment length for a font"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">newfont word: 5 &larr;</span><span class="tab" val="79"></span><span class="small">(5</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"length, ascent, descent, kern, and raster"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">+ (newraster * fontht)</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"bits"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">+ ((font word: 3 </span><span class="small italic">"max"</span><span class="small">) -<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(font word: 2</span><span class="small italic">"min"</span><span class="small">) + 2)</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"xtabl"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">).<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">SystemOrganization classify: ↪FontWindow under: &rsquo;Windows&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">FontWindow classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>"Window"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold">Class new title: &rsquo;Window&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">subclassof: Object<br></span><span class="tab" val="79"></span><span class="medium bold">fields: &rsquo;frame collapsed titlepara growing exitflag &rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">declare: &rsquo;titlerun border titleloc titleframe windowmenu &rsquo;;<br></span><span class="tab" val="79"></span><span class="medium bold">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small italic"><br>This is a superclass for presenting windows on the screen.  Besides outlining and scheduling the frame, it includes the distribution of user events which will someday be driven by interrupts.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">classInit</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"Window classInit"</span><span class="small bold"><br></span><span class="tab" val="79"></span><span class="small">[border &larr; 2⌾2.<br></span><span class="tab" val="79"></span><span class="small">titleframe &larr; Textframe new para: nil frame: nil.<br></span><span class="tab" val="79"></span><span class="small">titleloc &larr; 3⌾(¬4-titleframe lineheight).<br></span><span class="tab" val="79"></span><span class="small">titlerun &larr; String new: 2.<br></span><span class="tab" val="79"></span><span class="small">titlerun word: 1 &larr; 0177401.<br></span><span class="tab" val="79"></span><span class="small">windowmenu &larr; Menu new string:<br>&rsquo;under<br>frame<br>close<br>print<br>printbits<br>&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">reset<br></span><span class="tab" val="79"></span><span class="small">[exitflag&larr;true. growing&larr;false] </span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Scheduling</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">eachtime<br></span><span class="tab" val="79"></span><span class="small">[frame has: user mp⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[user kbck⇒[⇑self kbd]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user anybug⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[user redbug⇒[⇑self redbug]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user yellowbug⇒[⇑self yellowbug]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user bluebug⇒[⇑self bluebug]]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user anykeys⇒[⇑self keyset]]<br></span><span class="tab" val="79"></span><span class="small">self outside⇒[]<br></span><span class="tab" val="79"></span><span class="small">user anybug⇒[frame has: user mp⇒[] ⇑false]<br></span><span class="tab" val="79"></span><span class="small">user kbck⇒[user kbd. frame flash] </span><span class="small italic">"flush typing outside"</span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">firsttime<br></span><span class="tab" val="79"></span><span class="small">[frame has: user mp⇒ [self reset.  ⇑self enter] ⇑false]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">lasttime<br></span><span class="tab" val="79"></span><span class="small">[self leave. ⇑exitflag]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">schedule </span><span class="small">[user restartup: self]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Framing</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">clearTitle: color<br></span><span class="tab" val="79"></span><span class="small">[(titleframe window inset: ¬2⌾¬2) clear: color]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">editTitle </span><span class="small">| pared w<br></span><span class="tab" val="79"></span><span class="small">[pared&larr; ParagraphEditor new para: titlepara frame: nil.<br></span><span class="tab" val="79"></span><span class="small">pared formerly: false; fixframe: titleframe window+(1⌾2).<br></span><span class="tab" val="79"></span><span class="small">pared enter.  w&larr; titleframe window.<br></span><span class="tab" val="79"></span><span class="small">until⦂ (user anybug and⦂ (w has: user mp)≡false) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[user kbck⇒[pared typing]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user redbug⇒[w has: user mp⇒[pared selecting]]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user yellowbug⇒[w has: user mp⇒[w flash]]].<br></span><span class="tab" val="79"></span><span class="small">titlepara&larr; pared contents.<br></span><span class="tab" val="79"></span><span class="small">self showtitle]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">erase<br></span><span class="tab" val="79"></span><span class="small">[(frame inset: ¬2⌾¬2) clear.<br></span><span class="tab" val="79"></span><span class="small">self clearTitle: background]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">fixedwidthfromuser: width </span><span class="small">| a b oldframe [<br></span><span class="tab" val="79"></span><span class="small">user waitnobug.<br></span><span class="tab" val="79"></span><span class="small">[frame≡nil⇒[] self aboutToFrame; erase].<br></span><span class="tab" val="79"></span><span class="small">a &larr; OriginCursor showwhile⦂ user waitbug.<br></span><span class="tab" val="79"></span><span class="small">growing &larr; true.<br></span><span class="tab" val="79"></span><span class="small">self frame: (frame &larr; self fixframe: (a rect: a+(width⌾32))); show.<br></span><span class="tab" val="79"></span><span class="small">CornerCursor showwhile⦂ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">while⦂ (a &larr; user mpnext)  do⦂ [ a x &larr; frame corner x.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[oldframe≡nil⇒ [user cursorloc &larr; a max: frame corner]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">oldframe &larr; frame copy.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">self frame: (frame &larr; self fixframe: (frame growto: a));<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">moveFrom: oldframe]].<br></span><span class="tab" val="79"></span><span class="small">growing &larr; false.<br></span><span class="tab" val="79"></span><span class="small">self takeCursor]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">fixframe: f </span><span class="small">[⇑Rectangle new origin: f origin extent: (f extent max: 32⌾32)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">frame <br></span><span class="tab" val="79"></span><span class="small">[ ⇑ frame ]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">frame: f<br></span><span class="tab" val="79"></span><span class="small">[frame &larr; self fixframe: f]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">moveFrom: oldframe<br></span><span class="tab" val="79"></span><span class="small">[(oldframe inset: ¬2) clear. self show]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">newframe<br></span><span class="tab" val="79"></span><span class="small">| a oldframe<br></span><span class="tab" val="79"></span><span class="small">[user waitnobug; restoredisplay.<br></span><span class="tab" val="79"></span><span class="small">[frame≡nil<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">⇒[]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">self aboutToFrame; erase].<br></span><span class="tab" val="79"></span><span class="small">a &larr; OriginCursor showwhile⦂ user waitbug.<br></span><span class="tab" val="79"></span><span class="small">growing &larr; true.<br></span><span class="tab" val="79"></span><span class="small">frame &larr; self fixframe: (a rect: a+32).<br></span><span class="tab" val="79"></span><span class="small">frame outline.<br></span><span class="tab" val="79"></span><span class="small">CornerCursor showwhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[while⦂ (a &larr; user mpnext) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[[oldframe≡nil<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">⇒ [user cursorloc &larr; a max: frame corner]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">oldframe &larr; frame copy.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">frame &larr; self fixframe: (frame growto: a).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(oldframe inset: ¬2) clear.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">frame outline]].<br></span><span class="tab" val="79"></span><span class="small">self frame: frame.<br></span><span class="tab" val="79"></span><span class="small">growing &larr; false.<br></span><span class="tab" val="79"></span><span class="small">self takeCursor]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">outline<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Clear and outline me."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">frame outline]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">show </span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">self outline.<br></span><span class="tab" val="79"></span><span class="small">growing⇒[]<br></span><span class="tab" val="79"></span><span class="small">self showtitle]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">showtitle<br></span><span class="tab" val="79"></span><span class="small">[[titlepara≡nil⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[titlepara&larr; Paragraph new text: self title runs: titlerun alignment: 0]].<br></span><span class="tab" val="79"></span><span class="small">titleframe put: titlepara at: frame origin+titleloc; outline]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">takeCursor<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Move the cursor to my center."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">user cursorloc &larr; frame center]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">title </span><span class="small">[⇑&rsquo;Untitled&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Default Event responses</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">aboutToFrame<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"My frame is about to change.  I dont care."</span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">bluebug<br></span><span class="tab" val="79"></span><span class="small">[windowmenu bug<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=1⇒[⇑exitflag &larr; false];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=2⇒[self newframe. self enter];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=3⇒[self close. self erase.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user unschedule: self. ⇑false];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=4⇒[self hardcopy];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=5⇒[self print]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">close </span><span class="small">[]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">enter </span><span class="small">[self show]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">hardcopy </span><span class="small">[frame flash]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">kbd </span><span class="small">[user kbd. frame flash]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">keyset </span><span class="small">[frame flash]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">leave </span><span class="small">[]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">outside </span><span class="small">[titleframe window has: user mp⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[user anybug⇒[self editTitle] ⇑false]<br></span><span class="tab" val="79"></span><span class="small">⇑false]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">print<br></span><span class="tab" val="79"></span><span class="small">[(dp0 pressfile: (self title + &rsquo;.press.&rsquo;) asFileName)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">screenout: frame scale: PressScale; toPrinter]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">redbug<br></span><span class="tab" val="79"></span><span class="small">[frame flash]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">yellowbug<br></span><span class="tab" val="79"></span><span class="small">[frame flash]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">SystemOrganization classify: ↪Window under: &rsquo;Windows&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">Window classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>"PanedWindow"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold">Class new title: &rsquo;PanedWindow&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">subclassof: Window<br></span><span class="tab" val="79"></span><span class="medium bold">fields: &rsquo;panes templates title&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">declare: &rsquo;&rsquo;;<br></span><span class="tab" val="79"></span><span class="medium bold">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small italic"><br>A paned window is a Window that has subwindows (panes) that are awakened and resized in unison. The instance variable templates is a set of Rectangles for the frames of the panes normalized such that the whole PanedWindow is a frame of 0⌾0 rect: 36⌾36.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">title: title with: panes at: templates </span><span class="small">| pane<br>"The instance variable templates is a set of Rectangles for the frames of the panes normalized such that the whole PanedWindow is a frame of 0⌾0 rect: 36⌾36."<br></span><span class="tab" val="79"></span><span class="small">[self reset.<br></span><span class="tab" val="79"></span><span class="small">for⦂ pane from: panes do⦂ [pane init]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Window protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">close </span><span class="small">| pane<br></span><span class="tab" val="79"></span><span class="small">[for⦂ pane from: panes do⦂ [pane close]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">eachtime </span><span class="small">| pane<br></span><span class="tab" val="79"></span><span class="small">[frame has: user mp⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[user bluebug⇒[⇑self bluebug]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">for⦂ pane from: panes do⦂ [pane startup]]<br></span><span class="tab" val="79"></span><span class="small">self outside⇒[]<br></span><span class="tab" val="79"></span><span class="small">user anybug⇒[frame has: user mp⇒[] ⇑false]<br></span><span class="tab" val="79"></span><span class="small">user kbck⇒[user kbd. frame flash] </span><span class="small italic">"flush typing outside"</span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">enter </span><span class="small">| pane<br></span><span class="tab" val="79"></span><span class="small">[super show.<br></span><span class="tab" val="79"></span><span class="small">for⦂ pane from: panes do⦂ [pane windowenter]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">erase<br></span><span class="tab" val="79"></span><span class="small">[self titlerect clear. super erase]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">fixframe: f<br></span><span class="tab" val="79"></span><span class="small">[⇑Rectangle new origin: f origin extent: (f extent max: 160⌾80)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">frame: frame </span><span class="small italic">"(Re)initialize my frame, and tell my panes their locations."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">| templateStream template pane orig ext<br></span><span class="tab" val="79"></span><span class="small">[templateStream &larr; templates asStream.<br></span><span class="tab" val="79"></span><span class="small">orig&larr; frame origin-1. ext&larr; frame extent+2.<br></span><span class="tab" val="79"></span><span class="small">for⦂ pane from: panes do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"It would be nice to have parallel fors as in MLISP."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">template &larr; templateStream next.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">pane frame &larr; (template*ext /36 + orig) inset: 1]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">hardcopy </span><span class="small">| p<br></span><span class="tab" val="79"></span><span class="small">[user displayoffwhile⦂ [<br></span><span class="tab" val="79"></span><span class="small">p &larr; dp0 pressfile: (self title+&rsquo;.press&rsquo;) asFileName.<br></span><span class="tab" val="79"></span><span class="small">self hardcopy: p.<br></span><span class="tab" val="79"></span><span class="small">p close; toPrinter]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">hardcopy: pf </span><span class="small">| pane [<br></span><span class="tab" val="79"></span><span class="small">self hardcopyTitle: pf.<br><br></span><span class="tab" val="79"></span><span class="small">"print frame rectangle"<br></span><span class="tab" val="79"></span><span class="small">frame hardcopy: pf.<br><br></span><span class="tab" val="79"></span><span class="small">"print all panes"<br></span><span class="tab" val="79"></span><span class="small">for⦂ pane from: panes do⦂ [pane hardcopy: pf].<br><br></span><span class="tab" val="79"></span><span class="small">"print cursor if it&rsquo;s inside"<br></span><span class="tab" val="79"></span><span class="small">frame has: user mp⇒ [user currentCursor hardcopy: pf]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">hardcopyTitle: pf </span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">"refresh title (since it&rsquo;s a class var)"<br></span><span class="tab" val="79"></span><span class="small">self showtitle.<br><br></span><span class="tab" val="79"></span><span class="small">"draw title rectangle"<br></span><span class="tab" val="79"></span><span class="small">titleframe window hardcopy: pf.<br><br></span><span class="tab" val="79"></span><span class="small">"print title text (make frame larger)"<br></span><span class="tab" val="79"></span><span class="small">titleframe para presson: pf in: (pf transrect: (<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">titleframe frame origin rect: titleframe frame corner + (999 ⌾ 2)))<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">style: titleframe style]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">kbd </span><span class="small">| pane<br></span><span class="tab" val="79"></span><span class="small">[(pane &larr; self pickedpane)⇒ [⇑pane kbd]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">keyset </span><span class="small">| pane<br></span><span class="tab" val="79"></span><span class="small">[(pane &larr; self pickedpane)⇒ [⇑pane keyset]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">leave </span><span class="small">| pane<br></span><span class="tab" val="79"></span><span class="small">[for⦂ pane from: panes do⦂ [pane windowleave]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">pickedpane </span><span class="small">| pane<br></span><span class="tab" val="79"></span><span class="small">[for⦂ pane from: panes do⦂ [pane picked⇒ [⇑pane]]<br></span><span class="tab" val="79"></span><span class="small">frame flash. ⇑false]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">redbug </span><span class="small">| pane<br></span><span class="tab" val="79"></span><span class="small">[(pane &larr; self pickedpane)⇒ [⇑pane redbug]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">show </span><span class="small">| pane<br></span><span class="tab" val="79"></span><span class="small">[super show.<br></span><span class="tab" val="79"></span><span class="small">for⦂ pane from: panes do⦂ [pane outline]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">takeCursor<br></span><span class="tab" val="79"></span><span class="small">[(panes◦1) takeCursor]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">title<br></span><span class="tab" val="79"></span><span class="small">[⇑title]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">yellowbug </span><span class="small">| pane<br></span><span class="tab" val="79"></span><span class="small">[(pane &larr; self pickedpane)⇒ [⇑pane yellowbug]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Pane services</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">vanish<br></span><span class="tab" val="79"></span><span class="small">[self close; erase. user unschedule: self.]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Private</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">titlerect<br></span><span class="tab" val="79"></span><span class="small">[⇑frame origin - (2 ⌾ (DefaultTextStyle lineheight + 4)) rect: (frame corner x⌾frame origin y) + (2⌾0)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">SystemOrganization classify: ↪PanedWindow under: &rsquo;Windows&rsquo;.</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>"BrowseWindow"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold">Class new title: &rsquo;BrowseWindow&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">subclassof: PanedWindow<br></span><span class="tab" val="79"></span><span class="medium bold">fields: &rsquo;&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">declare: &rsquo;stdTemplates &rsquo;;<br></span><span class="tab" val="79"></span><span class="medium bold">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small italic"><br>I am a five-paned window to browse through classes.  My panes are...<br></span><span class="tab" val="79"></span><span class="small italic">system pane: categories of classes in the system<br></span><span class="tab" val="79"></span><span class="small italic">class pane: classes in the selected category<br></span><span class="tab" val="79"></span><span class="small italic">organization pane: categories of methods in the selected class<br></span><span class="tab" val="79"></span><span class="small italic">selector pane: method selectors in the selected category<br></span><span class="tab" val="79"></span><span class="small italic">code pane: source code of the selected method, if any, else other useful info</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">classInit<br></span><span class="tab" val="79"></span><span class="small">[stdTemplates &larr; (0⌾0 rect: 10⌾14), (10⌾0 rect: 18⌾14), (18⌾0 rect: 28⌾14), (28⌾0 rect: 36⌾14), (0⌾14 rect: 36⌾36)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">default </span><span class="tab" val="79"></span><span class="small italic">"Let the user draw a five-paned window to browse through classes."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">| systemPane classPane orgPane selectorPane codePane<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Create the panes."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">systemPane &larr; SystemPane new. classPane &larr; ClassPane new.<br></span><span class="tab" val="79"></span><span class="small">orgPane &larr; OrganizationPane new. selectorPane &larr; SelectorPane new.<br></span><span class="tab" val="79"></span><span class="small">codePane &larr; CodePane new.<br></span><span class="tab" val="79"></span><span class="small italic">"Acquire them."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">self title: &rsquo;Classes&rsquo;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">with: (systemPane, classPane, orgPane, selectorPane, codePane)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">at: stdTemplates.<br></span><span class="tab" val="79"></span><span class="small">self newframe; show.<br></span><span class="tab" val="79"></span><span class="small italic">"Interconnect them."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">systemPane to: classPane. classPane from: systemPane to: orgPane.<br></span><span class="tab" val="79"></span><span class="small">orgPane from: classPane to: selectorPane. selectorPane from: orgPane to: codePane.<br></span><span class="tab" val="79"></span><span class="small">codePane from: selectorPane.</span><span class="tab" val="79"></span><span class="small"><br></span><span class="tab" val="79"></span><span class="small italic">"Display them."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">systemPane update]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">SystemOrganization classify: ↪BrowseWindow under: &rsquo;Windows&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">BrowseWindow classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>"CodeWindow"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold">Class new title: &rsquo;CodeWindow&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">subclassof: PanedWindow<br></span><span class="tab" val="79"></span><span class="medium bold">fields: &rsquo;&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">declare: &rsquo;stdTemplates &rsquo;;<br></span><span class="tab" val="79"></span><span class="medium bold">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small italic"><br>I am a paned window with a code pane to edit a method or a file.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">class: class selector: selector para: para formerly: oldpara </span><span class="small">| codePane<br></span><span class="tab" val="79"></span><span class="small">[codePane &larr; CodePane new class: class selector: selector para: nil.<br></span><span class="tab" val="79"></span><span class="small">self title: class title+ &rsquo; &rsquo; + selector with: codePane inVector at: stdTemplates.<br></span><span class="tab" val="79"></span><span class="small">self newframe; show.<br></span><span class="tab" val="79"></span><span class="small">codePane showing: para; formerly: oldpara; from: codePane]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">classInit<br></span><span class="tab" val="79"></span><span class="small">[stdTemplates &larr; (0⌾0 rect: 36⌾36) inVector]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">editTitle </span><span class="small">[titleframe window flash]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">file: file </span><span class="small">| filePane<br></span><span class="tab" val="79"></span><span class="small">[filePane &larr; FilePane new file: file.<br></span><span class="tab" val="79"></span><span class="small">self title: file name with: filePane inVector at: stdTemplates.<br></span><span class="tab" val="79"></span><span class="small">self newframe; show.<br></span><span class="tab" val="79"></span><span class="small">filePane showing: file contents asParagraph; from: filePane]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">hardcopy: p </span><span class="small">| pane [for⦂ pane from: panes do⦂ [pane hardcopy: p]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">SystemOrganization classify: ↪CodeWindow under: &rsquo;Windows&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">CodeWindow classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>"InspectWindow"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold">Class new title: &rsquo;InspectWindow&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">subclassof: PanedWindow<br></span><span class="tab" val="79"></span><span class="medium bold">fields: &rsquo;variables&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">declare: &rsquo;stdTemplates &rsquo;;<br></span><span class="tab" val="79"></span><span class="medium bold">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small italic"><br>I am a paned window with a variable pane that displays the fields of an object and a code pane to display their values and to evaluate in their context.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">classInit<br></span><span class="tab" val="79"></span><span class="small">[stdTemplates &larr; (0⌾0 rect: 12⌾36), (12⌾0 rect: 36⌾36)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">of: object </span><span class="small">| instanceVarPane instanceValuePane safeVec n<br></span><span class="tab" val="79"></span><span class="small">[instanceVarPane &larr; VariablePane new. instanceValuePane &larr; CodePane new.<br></span><span class="tab" val="79"></span><span class="small">self title: object class title<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">with: (instanceVarPane, instanceValuePane) at: stdTemplates.<br></span><span class="tab" val="79"></span><span class="small">self newframe; show.<br></span><span class="tab" val="79"></span><span class="small">instanceVarPane to: instanceValuePane.<br></span><span class="tab" val="79"></span><span class="small">instanceValuePane from: instanceVarPane.<br></span><span class="tab" val="79"></span><span class="small">variables &larr; (Vector new: 16) asStream.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[object class is: VariableLengthClass⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[for⦂ n from: object fields do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[self identifier: n]]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">object class fieldNamesInto: self].<br></span><span class="tab" val="79"></span><span class="small">safeVec &larr; Vector new: 2. safeVec all &larr; object.<br></span><span class="tab" val="79"></span><span class="small">instanceVarPane names: (↪(self) concat: variables contents) values: safeVec wrt: false]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">show: object </span><span class="small">| fixedframe instanceVarPane instanceValuePane safeVec n<br></span><span class="tab" val="79"></span><span class="small">[instanceVarPane &larr; VariablePane new. instanceValuePane &larr; CodePane new.<br></span><span class="tab" val="79"></span><span class="small">fixedframe &larr; 400⌾450 rect: 600⌾565.<br></span><span class="tab" val="79"></span><span class="small">self title: object class title<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">with: (instanceVarPane, instanceValuePane) at: stdTemplates.<br></span><span class="tab" val="79"></span><span class="small">self frame: (self fixframe: fixedframe); show.<br></span><span class="tab" val="79"></span><span class="small">instanceVarPane to: instanceValuePane.<br></span><span class="tab" val="79"></span><span class="small">instanceValuePane from: instanceVarPane.<br></span><span class="tab" val="79"></span><span class="small">variables &larr; (Vector new: 16) asStream.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[object class is: VariableLengthClass⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[for⦂ n from: object fields do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[self identifier: n]]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">object class fieldNamesInto: self].<br></span><span class="tab" val="79"></span><span class="small">safeVec &larr; Vector new: 2. safeVec all &larr; object.<br></span><span class="tab" val="79"></span><span class="small">instanceVarPane names: (↪(self) concat: variables contents) values: safeVec wrt: false]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Private</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">comment: s</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"</span><span class="small italic">called by of: via Class fieldNamesInto</span><span class="small">"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">contents</span><span class="tab" val="79"></span><span class="small">"</span><span class="small italic">called by of: via Class fieldNamesInto</span><span class="small">"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">identifier: s</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"</span><span class="small italic">called by of: via Class fieldNamesInto</span><span class="small">"<br></span><span class="tab" val="79"></span><span class="small">[variables next &larr; s]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">separator: c</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"</span><span class="small italic">called by of: via Class fieldNamesInto</span><span class="small">"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">trailer: s</span><span class="tab" val="79"></span><span class="small">"</span><span class="small italic">called by of: via Class fieldNamesInto</span><span class="small">"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">SystemOrganization classify: ↪InspectWindow under: &rsquo;Windows&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">InspectWindow classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>"NotifyWindow"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold">Class new title: &rsquo;NotifyWindow&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">subclassof: PanedWindow<br></span><span class="tab" val="79"></span><span class="medium bold">fields: &rsquo;enoughpanes&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">declare: &rsquo;bigTemplates smallFrame smallTemplates &rsquo;;<br></span><span class="tab" val="79"></span><span class="medium bold">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small italic"><br>I am a paned window with one or six panes that display the context of an error or breakpoint.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">classInit<br></span><span class="tab" val="79"></span><span class="small">[smallTemplates &larr; (0⌾0 rect: 36⌾36) inVector.<br></span><span class="tab" val="79"></span><span class="small">bigTemplates &larr; (0⌾0 rect: 12⌾18), (12⌾0 rect: 36⌾18), (0⌾18 rect: 12⌾27), (12⌾18 rect: 36⌾27), (0⌾27 rect: 12⌾36), (12⌾27 rect: 36⌾36).<br></span><span class="tab" val="79"></span><span class="small">smallFrame &larr; 204⌾366 rect: 404⌾402]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">of: titleString level: level interrupt: flag </span><span class="small">| stackPane<br></span><span class="tab" val="79"></span><span class="small">[NotifyFlag &larr; false.<br></span><span class="tab" val="79"></span><span class="small">stackPane &larr; StackPane new.<br></span><span class="tab" val="79"></span><span class="small">self title: titleString with: stackPane inVector at: smallTemplates.<br></span><span class="tab" val="79"></span><span class="small">smallFrame moveto:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[level&gt;1⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[300⌾50]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(user screenrect center-(smallFrame extent/2))].<br></span><span class="tab" val="79"></span><span class="small">self frame: (self fixframe: smallFrame); show.<br></span><span class="tab" val="79"></span><span class="small">stackPane context: false at: level instance: false code: false;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">interrupt: flag.<br></span><span class="tab" val="79"></span><span class="small">stackPane of: (Top◦level) inVector. NotifyFlag &larr; true]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">of: titleString stack: stack interrupt: flag </span><span class="small">| stackPane<br></span><span class="tab" val="79"></span><span class="small">[NotifyFlag &larr; false.<br></span><span class="tab" val="79"></span><span class="small">stackPane &larr; StackPane new.<br></span><span class="tab" val="79"></span><span class="small">self title: titleString with: stackPane inVector at: smallTemplates.<br></span><span class="tab" val="79"></span><span class="small">smallFrame moveto:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[Top currentPriority&gt;1⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[300⌾50]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(user screenrect center-(smallFrame extent/2))].<br></span><span class="tab" val="79"></span><span class="small">self frame: (self fixframe: smallFrame); show.<br></span><span class="tab" val="79"></span><span class="small">stackPane context: false instance: false code: false; interrupt: flag.<br></span><span class="tab" val="79"></span><span class="small">stackPane of: stack inVector. NotifyFlag &larr; true]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Window protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">aboutToFrame<br></span><span class="tab" val="79"></span><span class="small">[enoughpanes &larr; panes length = 6. super aboutToFrame]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">enter </span><span class="small">| stackPane codePane contextVarPane contextValuePane instanceVarPane instanceValuePane<br></span><span class="tab" val="79"></span><span class="small">[enoughpanes⇒ [super enter]<br></span><span class="tab" val="79"></span><span class="small">NotifyFlag &larr; false.<br></span><span class="tab" val="79"></span><span class="small italic">"Create the remaining five panes."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">stackPane &larr; panes◦1. codePane &larr; CodePane new.<br></span><span class="tab" val="79"></span><span class="small">contextVarPane &larr; VariablePane new. contextValuePane &larr; CodePane new.<br></span><span class="tab" val="79"></span><span class="small">instanceVarPane &larr; VariablePane new. instanceValuePane &larr; CodePane new.<br></span><span class="tab" val="79"></span><span class="small italic">"Create the six-paned window."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">self title: title<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">with: (stackPane, codePane, contextVarPane, contextValuePane, instanceVarPane, instanceValuePane)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">at: bigTemplates.<br></span><span class="tab" val="79"></span><span class="small">self frame: frame; show.<br></span><span class="tab" val="79"></span><span class="small italic">"Initialize the six panes."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">stackPane context: contextVarPane instance: instanceVarPane code: codePane.<br></span><span class="tab" val="79"></span><span class="small">codePane from: stackPane.<br></span><span class="tab" val="79"></span><span class="small">contextVarPane to: contextValuePane. contextValuePane from: contextVarPane.<br></span><span class="tab" val="79"></span><span class="small">instanceVarPane to: instanceValuePane. instanceValuePane from: instanceVarPane.<br></span><span class="tab" val="79"></span><span class="small">stackPane select: 0; deselected; fill. enoughpanes &larr; NotifyFlag &larr; true]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">SystemOrganization classify: ↪NotifyWindow under: &rsquo;Windows&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">NotifyWindow classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>"ProjectWindow"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold">Class new title: &rsquo;ProjectWindow&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">subclassof: Window<br></span><span class="tab" val="79"></span><span class="medium bold">fields: &rsquo;userview parent changes&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">declare: &rsquo;actionMenu &rsquo;;<br></span><span class="tab" val="79"></span><span class="medium bold">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small italic"><br>A ProjectWindow represents its userview as a window to provide access to many UserViews, each for a different "project".  Besides the state in the userview, they also carry their own hashset for changes, so that such changes can be maintained on a per-project basis.  parent specifies another ProjectWindow to which control is given when the user leaves the current userview</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Changing views</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">install</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"</span><span class="small italic">Establish this project and its userview as the current screen view</span><span class="small">"</span><span class="small bold"><br></span><span class="tab" val="79"></span><span class="small">[Changes&larr; changes.<br></span><span class="tab" val="79"></span><span class="small">(user&larr; userview) install.<br></span><span class="tab" val="79"></span><span class="small">self putTitle.<br></span><span class="tab" val="79"></span><span class="small">user restart]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">putTitle<br></span><span class="tab" val="79"></span><span class="small">[ [titlepara≡nil⇒[titlepara&larr; &rsquo;Top View&rsquo; asParagraph allBold]].<br></span><span class="tab" val="79"></span><span class="small">titleframe put: titlepara<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">centered: user screenrect extent x/3⌾8.<br></span><span class="tab" val="79"></span><span class="small">titleframe outline]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">runParent</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"</span><span class="small italic">leave this view by installing the one above</span><span class="small">"<br></span><span class="tab" val="79"></span><span class="small">[parent install]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Window behavior</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">close</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"break circular links"<br></span><span class="tab" val="79"></span><span class="small">[userview&larr; parent&larr; nil]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">yellowbug<br></span><span class="tab" val="79"></span><span class="small">[actionMenu bug=1⇒[self install]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">classInit<br></span><span class="tab" val="79"></span><span class="small">[actionMenu &larr; Menu new string: &rsquo;enter&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">init</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"a new window"<br></span><span class="tab" val="79"></span><span class="small">[self userview: (user copyIn: self)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">changes: HashSet init<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">parent: user projectWindow.<br></span><span class="tab" val="79"></span><span class="small">self newframe; show]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">userview: userview changes: changes parent: parent</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"load state"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">SystemOrganization classify: ↪ProjectWindow under: &rsquo;Windows&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">ProjectWindow classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>"SyntaxWindow"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold">Class new title: &rsquo;SyntaxWindow&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">subclassof: PanedWindow<br></span><span class="tab" val="79"></span><span class="medium bold">fields: &rsquo;&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">declare: &rsquo;stdFrame stdTemplates &rsquo;;<br></span><span class="tab" val="79"></span><span class="medium bold">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small italic"><br>I am a paned window with a stack pane and a code pane to report errors during non-interactive compilations, e.g., filin, ⓢ, understands.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">classInit<br></span><span class="tab" val="79"></span><span class="small">[stdTemplates &larr; (0⌾0 rect: 12⌾36), (12⌾0 rect: 36⌾36).<br></span><span class="tab" val="79"></span><span class="small">stdFrame &larr; 60⌾320 rect: 570⌾500]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">of: errorString at: position in: stream for: class from: context </span><span class="small">| stackPane codePane<br></span><span class="tab" val="79"></span><span class="small">[stackPane &larr; StackPane new.<br></span><span class="tab" val="79"></span><span class="small">codePane &larr; CodePane new class: class selector: nil para: nil.<br></span><span class="tab" val="79"></span><span class="small">self title: class title with: (stackPane, codePane) at: stdTemplates.<br></span><span class="tab" val="79"></span><span class="small">stdFrame moveto: (user screenrect center-(stdFrame extent/2)).<br></span><span class="tab" val="79"></span><span class="small">self frame: (self fixframe: stdFrame); show.<br></span><span class="tab" val="79"></span><span class="small">stackPane context: false instance: false code: codePane.<br></span><span class="tab" val="79"></span><span class="small">stackPane of: context inVector.<br></span><span class="tab" val="79"></span><span class="small">codePane showing: stream asArray.<br></span><span class="tab" val="79"></span><span class="small">codePane from: stackPane; notify: errorString at: position in: stream]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">SystemOrganization classify: ↪SyntaxWindow under: &rsquo;Windows&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">SyntaxWindow classInit</span></div>
  </body>
</html>
