<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <title>Smalltalk76/Form-Path-Image.st</title>
	<link rel="stylesheet" type="text/css" href="font.css"/>
  </head>
  <body>
    <div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">&rsquo;From Smalltalk 5.5k XM November 24 on 22 November 1980 at 2:57:08 am.&rsquo;<br></span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span class="medium bold">"Form"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold">Class new title: &rsquo;Form&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">subclassof: Object<br></span><span class="tab" val="79"></span><span class="medium bold">fields: &rsquo;extent bits offset figure ground&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">declare: &rsquo;brush aurora black white aurorarunning SPARE color formmenu under reverse blankcursor over dotsetter &rsquo;;<br></span><span class="tab" val="79"></span><span class="medium bold">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small italic"><br>This class is a virtual bit map represented as a smalltalk String</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>INIT</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">classInit <br></span><span class="tab" val="79"></span><span class="small">["sets up colors and effects for BITBLT."<br></span><span class="tab" val="79"></span><span class="small">black &larr; 0-1.<br></span><span class="tab" val="79"></span><span class="small">white &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">over &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">under &larr; 1.<br></span><span class="tab" val="79"></span><span class="small">reverse &larr; 2.<br></span><span class="tab" val="79"></span><span class="small">brush &larr; Form new extent: 5⌾5. brush black.<br></span><span class="tab" val="79"></span><span class="small">color &larr; 1.<br>formmenu &larr; Menu new string:<br>&rsquo;brush<br>black<br>white<br>line<br>arc<br>erase<br>size<br>figure<br>ground<br>&rsquo;.<br></span><span class="tab" val="79"></span><span class="small">dotsetter &larr; BitBlt new init." a BitBlt for pattern access."<br></span><span class="tab" val="79"></span><span class="small">dotsetter width &larr; 1.<br></span><span class="tab" val="79"></span><span class="small">dotsetter height &larr; 1.<br></span><span class="tab" val="79"></span><span class="small">aurorarunning &larr; false.<br></span><span class="tab" val="79"></span><span class="small">aurora &larr; "Aurora new" nil.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">close<br></span><span class="tab" val="79"></span><span class="small">[]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">extent: extent<br></span><span class="tab" val="79"></span><span class="small">["creates a virtual bit map with width = (extent x) and height = (extent y) with the bits all 1."<br></span><span class="tab" val="79"></span><span class="small">self extent: extent figure: 0 ground: 1 offset: (0⌾0).<br></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">extent: extent figure: figure ground: ground offset: offset<br></span><span class="tab" val="79"></span><span class="small">["creates a virtual bit map with width = (extent x) and height = (extent y) with the bits all 1."<br></span><span class="tab" val="79"></span><span class="small">bits&larr; String new: 2*(extent y)*( ((extent x) +15) /16).<br></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">fromImage: image <br></span><span class="tab" val="79"></span><span class="small">["creates a virtual bit map with width = (image width) and height = (image height) with the bits in image."<br></span><span class="tab" val="79"></span><span class="small">self extent: image extent.<br></span><span class="tab" val="79"></span><span class="small">bits&larr; (image rectangle) bitsIntoString<br></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">fromrectangle: r <br></span><span class="tab" val="79"></span><span class="small">["creates a virtual bit map with width = (r width) and height = (r height) with the bits in r."<br></span><span class="tab" val="79"></span><span class="small">self extent: r extent.<br></span><span class="tab" val="79"></span><span class="small">bits&larr; r bitsIntoString<br></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="tab" val="79"></span><span class="small bold">fromuser  | r<br></span><span class="tab" val="79"></span><span class="small">["create a new Form whose rectangle is specified by the user. "<br></span><span class="tab" val="79"></span><span class="small">r &larr; Rectangle new fromuser.<br></span><span class="tab" val="79"></span><span class="small">self extent: r extent.<br></span><span class="tab" val="79"></span><span class="small">bits&larr; r bitsIntoString<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">fromuserevenword  | r<br></span><span class="tab" val="79"></span><span class="small">["create a new Form whose rectangle is specified by the user,<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">truncated to nearest multiple of 16 (for Spruce printing). "<br></span><span class="tab" val="79"></span><span class="small">r &larr; Rectangle new fromuserevenword.<br></span><span class="tab" val="79"></span><span class="small">self extent: r extent.<br></span><span class="tab" val="79"></span><span class="small">bits&larr; r bitsIntoString<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>PATTERN ACCESS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">bits <br></span><span class="tab" val="79"></span><span class="small">["return the string containing the bits)"<br></span><span class="tab" val="79"></span><span class="small">⇑ bits<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">bits: bits <br></span><span class="tab" val="79"></span><span class="small">["reset the string containing the bits)"<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">black </span><span class="small">| i<br></span><span class="tab" val="79"></span><span class="small">["sets all bits in the form to black ( to ones)"<br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: bits length do⦂ [ bits◦i &larr; 0-1]<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">black: pt <br></span><span class="tab" val="79"></span><span class="small">["sets the bit at pt in the  form to black ( to one)"<br></span><span class="tab" val="79"></span><span class="small">(((0⌾0) ≤ pt) and⦂ (pt ≤ extent)) ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">dotsetter destbase &larr; bits.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">dotsetter destraster &larr; (extent x +15)/16.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">dotsetter destx &larr; pt x.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">dotsetter desty &larr; pt y.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">dotsetter fill: storing color: black<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">gray </span><span class="small">| i<br></span><span class="tab" val="79"></span><span class="small">["sets all bits in the form to gray ( to gray)"<br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: bits length do⦂ [ bits◦i &larr; 025252]<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">white </span><span class="small">| i<br></span><span class="tab" val="79"></span><span class="small">["sets all bits in the form to white ( to zeros)"<br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: bits length do⦂ [ bits◦i &larr; 0]<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>MODULE ACCESS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">extent<br></span><span class="tab" val="79"></span><span class="small">["return the extent (width⌾height) of the Form"<br></span><span class="tab" val="79"></span><span class="small">⇑ extent<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">figure<br></span><span class="tab" val="79"></span><span class="small">["return the figure( color assiciated with black) for the form "<br></span><span class="tab" val="79"></span><span class="small">⇑ figure<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">figure: figure <br></span><span class="tab" val="79"></span><span class="small">["set the figure ( color assiciated with black) for the form "<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">ground <br></span><span class="tab" val="79"></span><span class="small">["return the ground ( color assiciated with white) for the form "<br></span><span class="tab" val="79"></span><span class="small">⇑ ground<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">ground: ground <br></span><span class="tab" val="79"></span><span class="small">["set the ground ( color assiciated with white) for the form "<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">height <br></span><span class="tab" val="79"></span><span class="small">["return the height of the Form"<br></span><span class="tab" val="79"></span><span class="small">⇑ extent y<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">length </span><span class="small">[ ⇑ bits length]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">offset <br></span><span class="tab" val="79"></span><span class="small">["return the offset of the Form"<br></span><span class="tab" val="79"></span><span class="small">⇑ offset<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">offset: offset <br></span><span class="tab" val="79"></span><span class="small">["set the offset of the form "<br></span><span class="tab" val="79"></span><span class="small">⇑ self<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">width <br></span><span class="tab" val="79"></span><span class="small">["return the width of the Form"<br></span><span class="tab" val="79"></span><span class="small">⇑ extent x<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>FILING</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">read: filename </span><span class="small">| f strip w h form stripheight leftoverlines i<br></span><span class="tab" val="79"></span><span class="small">["Reads the Form from the disk in the format width,height,bits."<br></span><span class="tab" val="79"></span><span class="small">f&larr; (dp0 oldFile: filename).<br></span><span class="tab" val="79"></span><span class="small">f readonly.<br></span><span class="tab" val="79"></span><span class="small">w &larr; (f nextword).<br></span><span class="tab" val="79"></span><span class="small">h &larr;(f nextword).<br></span><span class="tab" val="79"></span><span class="small">extent &larr; w⌾h.<br></span><span class="tab" val="79"></span><span class="small">w*h &lt; 64000⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[bits &larr; (Form new extent: extent) bits.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">f into: bits.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">f close.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">f close.<br></span><span class="tab" val="79"></span><span class="small">user notify: &rsquo;too many bits to be a Form&rsquo;.<br></span><span class="tab" val="79"></span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">write: filename<br></span><span class="tab" val="79"></span><span class="small">["</span><span class="small italic">Saves the Form in the format width,height,bits.</span><span class="small">"<br></span><span class="tab" val="79"></span><span class="small">(dp0 file: filename)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">nextword&larr; (self width);<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">nextword&larr; (self height);<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">append: bits;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">close.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>DISPLAY</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">displayat:  path effect: effect clippedBy: cliprect</span><span class="small">| r i clippedrect<br></span><span class="tab" val="79"></span><span class="small">["basic form display primitive"<br></span><span class="tab" val="79"></span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">path is: Point ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[ r &larr; Rectangle new origin:  path extent: (self extent).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">r bitsFromString: bits mode: effect clippedBy: cliprect.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">aurorarunning⇒ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[user displayoffwhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">clippedrect &larr; r intersect: (user screenrect).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">aurora destination: clippedrect ; source: clippedrect ;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">figure: figure ; ground: ground ;  function: 002117 "AoverB" ;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small"> doit; function: 0 ; doit.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">] </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small"><br> </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">path is: Path ⇒ [for⦂ i to: path length do⦂ [ self displayat: path◦i<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">effect: effect clippedBy: cliprect] ]<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>SYSTEM</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">asInstance </span><span class="small">| s<br></span><span class="tab" val="79"></span><span class="small">[s &larr; Stream new default.<br></span><span class="tab" val="79"></span><span class="small">s nextPoint&larr; extent.<br></span><span class="tab" val="79"></span><span class="small">s nextPoint&larr; offset.<br></span><span class="tab" val="79"></span><span class="small">s nextword &larr; figure.<br></span><span class="tab" val="79"></span><span class="small">s nextword &larr; ground.<br></span><span class="tab" val="79"></span><span class="small">s nextString &larr; bits.<br></span><span class="tab" val="79"></span><span class="small">⇑ s contents <br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">copy </span><span class="small">| t<br></span><span class="tab" val="79"></span><span class="small">["return a copy of myself"<br></span><span class="tab" val="79"></span><span class="small">t &larr; Form new extent: extent.<br></span><span class="tab" val="79"></span><span class="small">t bits: bits copy.<br></span><span class="tab" val="79"></span><span class="small">⇑ t<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">fromInstance: file <br></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">extent &larr;  file nextPoint.<br></span><span class="tab" val="79"></span><span class="small">offset &larr;  file nextPoint.<br></span><span class="tab" val="79"></span><span class="small">figure &larr; file nextword.<br></span><span class="tab" val="79"></span><span class="small">ground &larr; file nextword.<br></span><span class="tab" val="79"></span><span class="small">bits &larr; file nextString.<br></span><span class="tab" val="79"></span><span class="small">⇑ self <br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">fromPress: press value: s </span><span class="small">| nbytes [<br></span><span class="tab" val="79"></span><span class="small">extent&larr; s nextPoint.<br></span><span class="tab" val="79"></span><span class="small">offset&larr; s nextPoint.<br></span><span class="tab" val="79"></span><span class="small">figure &larr; s nextword.<br></span><span class="tab" val="79"></span><span class="small">ground &larr; s nextword.<br></span><span class="tab" val="79"></span><span class="small">nbytes &larr; 2*(extent y)*((extent x + 15)/16).<br></span><span class="tab" val="79"></span><span class="small">(press data) skip: 0-nbytes.<br></span><span class="tab" val="79"></span><span class="small">bits &larr; (press data) next: nbytes]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">hideData: complete </span><span class="small">| s<br></span><span class="tab" val="79"></span><span class="small">["</span><span class="small italic">a Form does not split across page boundaries</span><span class="small">"<br></span><span class="tab" val="79"></span><span class="small">Stream new of: (s &larr; String new: 12);<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">nextPoint&larr; extent;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">nextPoint&larr; offset;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">nextword &larr; figure;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">nextword &larr; ground.<br></span><span class="tab" val="79"></span><span class="small">⇑ s]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">hidePress: press complete: c </span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">press skipcode: self pressCode data: (self hideData: c)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">pressCode </span><span class="small">[⇑5]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">presson: press in: r </span><span class="small">| hs y [<br></span><span class="tab" val="79"></span><span class="small">(hs  &larr; press scale*self height) &gt; r height⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"not enough room left on current page.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">assume for now that it will at least fit on an entire page"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">⇑self]<br><br></span><span class="tab" val="79"></span><span class="small">press setp: (r origin x)⌾(y &larr; r corner y - hs);<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">bitmap: self bits: bits.<br></span><span class="tab" val="79"></span><span class="small">⇑y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>EDITING</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">arc: parentimage </span><span class="small">| pt1 pt2 pt3 path pt<br></span><span class="tab" val="79"></span><span class="small">["arc tool for forms."<br></span><span class="tab" val="79"></span><span class="small">BlankCursor topage1.<br></span><span class="tab" val="79"></span><span class="small">until⦂ user redbug do⦂</span><span class="tab" val="79"></span><span class="small">[ pt1 &larr; self blinkbrush: parentimage].<br></span><span class="tab" val="79"></span><span class="small">brush displayat: pt1 effect: color clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="small">until⦂ user nobug do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[ pt2 &larr; self blinkbrush: parentimage].<br></span><span class="tab" val="79"></span><span class="small">brush displayat: pt2 effect: color clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="small">until⦂ user redbug do⦂</span><span class="tab" val="79"></span><span class="small">[ pt3 &larr; self blinkbrush: parentimage].<br></span><span class="tab" val="79"></span><span class="small">brush displayat: pt3 effect: color clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="small">path &larr; Path new init.<br></span><span class="tab" val="79"></span><span class="small">path addarcfrom: pt1 via: pt2 to: pt3.<br></span><span class="tab" val="79"></span><span class="small">for⦂ pt from: path do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[ brush displayat: pt effect: color clippedBy: user screenrect].<br></span><span class="tab" val="79"></span><span class="small">NormalCursor topage1<br></span><span class="tab" val="79"></span><span class="small">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">blinkbrush: parentimage </span><span class="small">| pt <br></span><span class="tab" val="79"></span><span class="small">["to show current position of brush in the form."<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">pt &larr; parentimage mp.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">brush displayat: (parentimage rectangle origin)+ pt<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">effect: 2 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">brush displayat: (parentimage rectangle origin)+ pt<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">effect: 2 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="small">⇑ (parentimage rectangle origin)+ pt<br></span><span class="tab" val="79"></span><span class="small">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">edit: parentimage </span><span class="small">| pt f c file<br></span><span class="tab" val="79"></span><span class="small">["Simple Form editor for now."<br></span><span class="tab" val="79"></span><span class="small">until⦂ false do⦂ "forever for now"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[pt &larr; parentimage mp." blink the current brush"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">BlankCursor topage1.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">self blinkbrush: parentimage.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user redbug ⇒ </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[ parentimage contains:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(pt &larr; self blinkbrush: parentimage)⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[brush displayat: pt effect: color<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">clippedBy: parentimage rectangle.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">while⦂ user redbug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[brush displayat:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(self blinkbrush: parentimage) effect: color<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">clippedBy: parentimage rectangle.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">] <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">NormalCursor topage1. <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">bits&larr; (parentimage rectangle) bitsIntoString.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">⇑ self.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">] <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user kbck⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">c &larr; user kbd. <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">c = 120⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[ user clearshow: &rsquo;x gridding is &rsquo;. parentimage xgrid print.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user cr.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">parentimage xgrid:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(user request: &rsquo;x gridding . . . &rsquo;) asInteger.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">] <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">c = 121⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[ user clearshow: &rsquo;y gridding is &rsquo;. parentimage ygrid print.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user cr.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">parentimage ygrid:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(user request: &rsquo;y gridding . . . &rsquo;) asInteger.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">] <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">c = 114⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">file &larr;(user request: &rsquo;filename of Form . . .&rsquo;) .<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">brush &larr;Form new read: file. brush figure: 1  ; ground: 0.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">] <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small"> ]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user yellowbug ⇒</span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">NormalCursor topage1.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">formmenu bug<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=1⇒</span><span class="tab" val="79"></span><span class="small">[self newbrush: parentimage ]; "get a new brush"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=2⇒</span><span class="tab" val="79"></span><span class="small">[color &larr; 1.]; "set the color of the brush to black"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=3⇒</span><span class="tab" val="79"></span><span class="small">[color &larr; 3.]; "set the color of the brush to white"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=4⇒</span><span class="tab" val="79"></span><span class="small">[self line: parentimage];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=5⇒</span><span class="tab" val="79"></span><span class="small">[self arc: parentimage];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=6⇒</span><span class="tab" val="79"></span><span class="small">[self white. parentimage display];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"erase the whole form"<br> </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=7⇒</span><span class="tab" val="79"></span><span class="small">[self resize: parentimage<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]; "change size"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=8⇒</span><span class="tab" val="79"></span><span class="small">[self setfigure: parentimage];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=9⇒</span><span class="tab" val="79"></span><span class="small">[self setground: parentimage]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user bluebug ⇒ </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[bits&larr; (parentimage rectangle) bitsIntoString.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">NormalCursor topage1. ⇑ self.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">] "exit back to the parentimage"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">line: parentimage </span><span class="small">| pt1 pt2 path pt<br></span><span class="tab" val="79"></span><span class="small">["line tool for forms."<br></span><span class="tab" val="79"></span><span class="small">BlankCursor topage1.<br></span><span class="tab" val="79"></span><span class="small">until⦂ user redbug do⦂</span><span class="tab" val="79"></span><span class="small">[ pt1 &larr; self blinkbrush: parentimage].<br></span><span class="tab" val="79"></span><span class="small">brush displayat: pt1 effect: color clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="small">until⦂ user nobug do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[ pt2 &larr; self blinkbrush: parentimage].<br></span><span class="tab" val="79"></span><span class="small">brush displayat: pt2 effect: color clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="small">path &larr; Path new init.<br></span><span class="tab" val="79"></span><span class="small">path addlinefrom: pt1 to: pt2.<br></span><span class="tab" val="79"></span><span class="small">for⦂ pt from: path do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[ brush displayat: pt effect: color clippedBy: user screenrect].<br></span><span class="tab" val="79"></span><span class="small">NormalCursor topage1<br></span><span class="tab" val="79"></span><span class="small">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">newbrush: superimage </span><span class="small">|  pt rect<br></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">OriginCursor topage1.<br></span><span class="tab" val="79"></span><span class="small">user waitbug.<br></span><span class="tab" val="79"></span><span class="small">pt &larr; ( superimage mp)+ superimage rectangle origin.<br></span><span class="tab" val="79"></span><span class="small">rect &larr; pt rect: pt.</span><span class="tab" val="79"></span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">CornerCursor topage1.<br></span><span class="tab" val="79"></span><span class="small">until⦂ user nobug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[rect reverse.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">rect reverse.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">pt &larr; <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">( superimage mp)+ superimage rectangle origin.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">rect corner &larr; (rect origin) max: pt.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br> </span><span class="tab" val="79"></span><span class="small">brush &larr; Form new fromrectangle: rect.<br></span><span class="tab" val="79"></span><span class="small">NormalCursor topage1.<br></span><span class="tab" val="79"></span><span class="small">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">resize: superimage </span><span class="small">|  pt f<br></span><span class="tab" val="79"></span><span class="small">[superimage boxcomp.<br></span><span class="tab" val="79"></span><span class="small">CornerCursor topage1.<br></span><span class="tab" val="79"></span><span class="small">user waitbug. <br></span><span class="tab" val="79"></span><span class="small">until⦂ user nobug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[superimage reverse.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">superimage reverse.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">( pt &larr; <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">((superimage superimage) mp)+<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">((superimage superimage) rectangle origin)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">superimage corner&larr; pt max: ((superimage origin) + (16⌾16)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br> </span><span class="tab" val="79"></span><span class="small">f&larr;Form new fromrectangle: superimage rectangle.<br></span><span class="tab" val="79"></span><span class="small">bits &larr; f bits.<br> </span><span class="tab" val="79"></span><span class="small">extent&larr; f extent .<br> </span><span class="tab" val="79"></span><span class="small">offset &larr; 0⌾0.<br> </span><span class="tab" val="79"></span><span class="small">superimage white ;<br> </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">resize ; display ; boxcomp.<br></span><span class="tab" val="79"></span><span class="small">NormalCursor topage1.<br></span><span class="tab" val="79"></span><span class="small">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">setfigure: parentimage </span><span class="small">| <br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"for now just increment the figure color by 1 \ 14"<br></span><span class="tab" val="79"></span><span class="small">figure &larr; (figure +1 ) \ 14.<br></span><span class="tab" val="79"></span><span class="small">self displayat: (parentimage origin) effect: 0 clippedBy: user screenrect.<br>]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">setground: parentimage </span><span class="small">| <br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"for now just increment the ground color by 1 \ 14"<br></span><span class="tab" val="79"></span><span class="small">ground &larr; (ground +1 ) \ 14.<br></span><span class="tab" val="79"></span><span class="small">self displayat: (parentimage origin) effect: 0 clippedBy: user screenrect.<br>]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">SystemOrganization classify: ↪Form under: &rsquo;Form Path Image&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">Form classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>"FormSet"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold">Class new title: &rsquo;FormSet&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">subclassof: Object<br></span><span class="tab" val="79"></span><span class="medium bold">fields: &rsquo;space spaceorigin image strike style styleindex formindex offsettable&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">declare: &rsquo;imageindex bitmover &rsquo;;<br></span><span class="tab" val="79"></span><span class="medium bold">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small italic"><br>An object for holding sets of forms.  The most conventional use will be as a repository of a set of forms typically identified as characters when seen on the display or on paper.  The forms will be ascessible by passing a one-character<br>string or a number.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>ACCESS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">asForm: formindex</span><span class="tab" val="79"></span><span class="small bold">  </span><span class="small">| f<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"returns the form indexed by formindex ."<br></span><span class="tab" val="79"></span><span class="small">self checkindex.<br></span><span class="tab" val="79"></span><span class="small">f &larr; Form new extent: (self width) ⌾ (self height) . <br></span><span class="tab" val="79"></span><span class="small">bitmover destraster &larr; (f width + 15 / 16).<br></span><span class="tab" val="79"></span><span class="small">bitmover destx &larr; 0. bitmover desty &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">bitmover sourcex &larr; (self originx). bitmover sourcey &larr;  0.<br></span><span class="tab" val="79"></span><span class="small">bitmover width &larr; (self width).<br></span><span class="tab" val="79"></span><span class="small">bitmover height &larr; (self ascent) + (self descent).<br></span><span class="tab" val="79"></span><span class="small">bitmover sourceraster &larr; (self wordwidth).<br></span><span class="tab" val="79"></span><span class="small">bitmover destbase &larr; (f bits).<br></span><span class="tab" val="79"></span><span class="small">bitmover sourcebase &larr; strike.<br></span><span class="tab" val="79"></span><span class="small">bitmover dstrike &larr; false.<br></span><span class="tab" val="79"></span><span class="small">bitmover sstrike &larr; true.<br></span><span class="tab" val="79"></span><span class="small">bitmover copy: storing.<br></span><span class="tab" val="79"></span><span class="small">⇑ f<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">changeascentto: newascent</span><span class="tab" val="79"></span><span class="small bold"><br></span><span class="tab" val="79"></span><span class="small">[</span><span class="tab" val="79"></span><span class="small italic">"new ascent for FormSet"<br></span><span class="tab" val="79"></span><span class="small">self deltaascent: (newascent - (self ascent))<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">changedescentto: newdescent</span><span class="tab" val="79"></span><span class="small bold"><br></span><span class="tab" val="79"></span><span class="small">[</span><span class="tab" val="79"></span><span class="small italic">"new ascent for FormSet"<br></span><span class="tab" val="79"></span><span class="small">self deltadescent: (newdescent - (self descent))<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">changewidthof: formindex to: width</span><span class="tab" val="79"></span><span class="small bold"><br></span><span class="tab" val="79"></span><span class="small">[</span><span class="tab" val="79"></span><span class="small italic">"new width for form at index"<br></span><span class="tab" val="79"></span><span class="small">self checkindex. self deltawidthof: formindex by: (width - (self width))<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">classInit<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Just initialize the bitmover for now."<br></span><span class="tab" val="79"></span><span class="small">bitmover &larr; BitBlt init</span><span class="small italic"><br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">copy: formindex</span><span class="tab" val="79"></span><span class="small bold"> to: pt </span><span class="small">| f<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"copies the form indexed by formindex to pt."<br></span><span class="tab" val="79"></span><span class="small">self checkindex.<br></span><span class="tab" val="79"></span><span class="small">"f &larr; Image new size: (self width) ⌾ (self height) at: pt."<br></span><span class="tab" val="79"></span><span class="small">bitmover destraster &larr; ((user screenrect) width + 15 / 16).<br></span><span class="tab" val="79"></span><span class="small">bitmover destx &larr; pt x. bitmover desty &larr; pt y.<br></span><span class="tab" val="79"></span><span class="small">bitmover sourcex &larr; (self originx). bitmover sourcey &larr;  0.<br></span><span class="tab" val="79"></span><span class="small">bitmover width &larr; (self width).<br></span><span class="tab" val="79"></span><span class="small">bitmover height &larr; (self ascent) + (self descent).<br></span><span class="tab" val="79"></span><span class="small">bitmover sourceraster &larr; (self wordwidth).<br></span><span class="tab" val="79"></span><span class="small">bitmover destbase &larr; (mem◦ 066).<br></span><span class="tab" val="79"></span><span class="small">bitmover sourcebase &larr; strike.<br></span><span class="tab" val="79"></span><span class="small">bitmover strike &larr; true.<br></span><span class="tab" val="79"></span><span class="small">bitmover copy: oring.<br></span><span class="tab" val="79"></span><span class="small">⇑ self widthof: formindex<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">copy: formindex</span><span class="tab" val="79"></span><span class="small bold"> to: pt effect: effect </span><span class="small">| f<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"copies the form indexed by formindex to pt."<br></span><span class="tab" val="79"></span><span class="small">self checkindex.<br></span><span class="tab" val="79"></span><span class="small">"f &larr; Image new size: (self width) ⌾ (self height) at: pt."<br></span><span class="tab" val="79"></span><span class="small">bitmover destraster &larr; ((user screenrect) width + 15 / 16).<br></span><span class="tab" val="79"></span><span class="small">bitmover destx &larr; pt x. bitmover desty &larr; pt y.<br></span><span class="tab" val="79"></span><span class="small">bitmover sourcex &larr; (self originx). bitmover sourcey &larr;  0.<br></span><span class="tab" val="79"></span><span class="small">bitmover width &larr; (self width).<br></span><span class="tab" val="79"></span><span class="small">bitmover height &larr; (self ascent) + (self descent).<br></span><span class="tab" val="79"></span><span class="small">bitmover sourceraster &larr; (self wordwidth).<br></span><span class="tab" val="79"></span><span class="small">bitmover destbase &larr; (mem◦ 066).<br></span><span class="tab" val="79"></span><span class="small">bitmover sourcebase &larr; strike.<br></span><span class="tab" val="79"></span><span class="small">bitmover strike &larr; true.<br></span><span class="tab" val="79"></span><span class="small">bitmover copy: effect.<br></span><span class="tab" val="79"></span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">copyrange: start to: stop from: sourceset startingat: deststart<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">| savebackground savebits i f<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"copy a range of forms from one set to another"<br></span><span class="tab" val="79"></span><span class="small">user displayoffwhile⦂<br></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">[sourceset is: FormSet ⇒ []<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">sourceset is: String ⇒ [sourceset &larr; FormSet new from: sourceset]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user notify: &rsquo;Illegal sourceset -- not String or Formset.&rsquo;<br></span><span class="tab" val="79"></span><span class="small">].<br></span><span class="tab" val="79"></span><span class="small">savebackground &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">Form new size: (sourceset maxwidth) by: (sourceset height).<br></span><span class="tab" val="79"></span><span class="small">savebackground translate: 0⌾0; scale: 1.<br></span><span class="tab" val="79"></span><span class="small">savebits &larr; savebackground bitsIntoString.<br><br></span><span class="tab" val="79"></span><span class="small">for⦂ i from: start to: stop do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[f &larr; sourceset copy: i to: 0⌾0. self include: deststart with: f.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">deststart &larr; deststart + 1].<br><br></span><span class="tab" val="79"></span><span class="small">savebackground bitsFromString: savebits.<br></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">currentformindex<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"return index of form last touched"<br></span><span class="tab" val="79"></span><span class="small">⇑ formindex<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">currentformorigin |</span><span class="small"> imageindex</span><span class="small bold"><br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"return index in image of form last touched"<br></span><span class="tab" val="79"></span><span class="small"> imageindex &larr; image find: formindex.<br></span><span class="tab" val="79"></span><span class="small">⇑ space ptofchar: imageindex.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">from: strike<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Make a formset out of string in strike format"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">self classInit. self install: strike<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">from: first to: last ascent: ascent descent: descent<br></span><span class="tab" val="79"></span><span class="small bold">style: style styleindex: styleindex name: name<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Make an empty formset."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">self classInit.<br></span><span class="tab" val="79"></span><span class="small">offsettable &larr; String new: (last - first + 3) * 2.<br></span><span class="tab" val="79"></span><span class="small">offsettable all &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">offsettable word: (last - first + 3) &larr; 4.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"width of illegal form"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">strike &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">String new: (9 </span><span class="small italic">"header"</span><span class="small"> + ascent + descent </span><span class="small italic">"space for illegal form"</span><span class="small">) * 2.<br></span><span class="tab" val="79"></span><span class="small">strike all &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">self type: 0100000.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"for the outside world"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">self first: first.<br></span><span class="tab" val="79"></span><span class="small">self last: last.<br></span><span class="tab" val="79"></span><span class="small">self wordwidth: 1.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"only illegal form"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">self ascent: ascent.<br></span><span class="tab" val="79"></span><span class="small">self descent: descent.<br></span><span class="tab" val="79"></span><span class="small">self maxwidth: 4.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"width of illegal form"</span><span class="small"><br><br></span><span class="tab" val="79"></span><span class="small">strike &larr; strike concat: offsettable ◦ (1 to: offsettable length).<br><br></span><span class="tab" val="79"></span><span class="small italic">"mash in bits of illegal form"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small italic">"leftside"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">bitmover destraster &larr; (self wordwidth).<br></span><span class="tab" val="79"></span><span class="small">bitmover destx &larr; 0. bitmover desty &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">bitmover width &larr; 1. bitmover height &larr; (self ascent) + (self descent).<br></span><span class="tab" val="79"></span><span class="small">bitmover destbase &larr; strike.<br></span><span class="tab" val="79"></span><span class="small">bitmover dstrike &larr; true.<br></span><span class="tab" val="79"></span><span class="small">bitmover fill: storing color: black.<br></span><span class="tab" val="79"></span><span class="small italic">"rightside"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">bitmover destx &larr; 3.<br></span><span class="tab" val="79"></span><span class="small">bitmover dstrike &larr; true.<br></span><span class="tab" val="79"></span><span class="small">bitmover fill: storing color: black.<br></span><span class="tab" val="79"></span><span class="small italic">"top"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">bitmover width &larr; 4. bitmover height &larr; 1. bitmover destx &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">bitmover dstrike &larr; true.<br></span><span class="tab" val="79"></span><span class="small">bitmover fill: storing color: black.<br></span><span class="tab" val="79"></span><span class="small italic">"bottom"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">bitmover desty &larr; (self ascent) + (self descent) - 1.<br></span><span class="tab" val="79"></span><span class="small">bitmover dstrike &larr; true.<br></span><span class="tab" val="79"></span><span class="small">bitmover fill: storing color: black.<br><br></span><span class="tab" val="79"></span><span class="small">self install: strike.<br></span><span class="tab" val="79"></span><span class="small">self updateseglength.<br></span><span class="tab" val="79"></span><span class="small">[style ≡ nil ⇒ []<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">style setfont: styleindex name: name fromstring: strike]<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">fromspace: pt to: dest<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"get form selected from space"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">formindex &larr; image ◦ ((space charofpt: pt) min: 256).<br></span><span class="tab" val="79"></span><span class="small">⇑ (self copy: formindex to: dest).<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">fromstyle: style styleindex: styleindex<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Make a formset out of string in strike format"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">self classInit. self install: style fonts◦(styleindex+1)<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">height<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"return height of fromset"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">⇑self ascent + self descent<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">include: formindex with: form </span><span class="small">| newoffsettable newstrike i j<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Put a form into the formset"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">(formindex &gt; (self first)) and:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(formindex &lt; (self last)) ⇒ [ self replace: formindex with: form]<br><br></span><span class="tab" val="79"></span><span class="small">formindex &lt; 0 ⇒ [user notify: &rsquo;Formindex &lt; 0 illegal for formset.&rsquo;]<br></span><span class="tab" val="79"></span><span class="small">formindex &gt; 255 ⇒ [user notify: &rsquo;Formindex &gt; 255 illegal for formset.&rsquo;]<br><br></span><span class="tab" val="79"></span><span class="small">[formindex &lt; (self first) ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[newoffsettable &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">String new: ((self first) - formindex + (self abslength)) * 2.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">newoffsettable all &larr; 0.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">j &larr; (self first) - formindex + 1.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">for⦂ i  from: j to: ((newoffsettable length) / 2) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[newoffsettable word: i &larr; strike word: offsettable + (i-j)].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">newoffsettable &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">String new: ((self abslength) + formindex - (self last)) * 2.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">newoffsettable all &larr; 0.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">for⦂ i from: 0 to: ((self length) - 1) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[newoffsettable word: (i+1) &larr; strike word: offsettable + i].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">for⦂ i from: (self length) to: ((newoffsettable length) / 2) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[newoffsettable word: i &larr; strike word: offsettable + self length].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">newoffsettable word: ((newoffsettable length) / 2) &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">strike word: (offsettable + self length + 1).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">].<br></span><span class="tab" val="79"></span><span class="small">newstrike &larr; String new: (9 </span><span class="small italic">"header"</span><span class="small"> + ((self wordwidth) *<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">((self ascent + self descent)) </span><span class="small italic">"bits"</span><span class="small">)) * 2.</span><span class="tab" val="79"></span><span class="small italic">"new space for bits"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: 9 do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[newstrike word: i &larr; strike word: i].</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"fill in header of new font"</span><span class="small"><br><br></span><span class="tab" val="79"></span><span class="small">bitmover destraster &larr; (self wordwidth).<br></span><span class="tab" val="79"></span><span class="small">bitmover destx &larr; 0. bitmover desty &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">bitmover sourcex &larr; 0. bitmover sourcey &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">bitmover width &larr; (self strikerightx).<br></span><span class="tab" val="79"></span><span class="small">bitmover height &larr; (self ascent) + (self descent).<br></span><span class="tab" val="79"></span><span class="small">bitmover sourceraster &larr; (self wordwidth).<br></span><span class="tab" val="79"></span><span class="small">bitmover destbase &larr; newstrike.<br></span><span class="tab" val="79"></span><span class="small">bitmover sourcebase &larr; strike.<br></span><span class="tab" val="79"></span><span class="small">bitmover strike &larr; true.<br></span><span class="tab" val="79"></span><span class="small">bitmover copy: storing.<br><br></span><span class="tab" val="79"></span><span class="small italic">"copy the xtable"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">newstrike &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">newstrike concat:  newoffsettable ◦(1 to: newoffsettable length).<br></span><span class="tab" val="79"></span><span class="small">self install: newstrike.<br></span><span class="tab" val="79"></span><span class="small">[formindex &lt; (self first)  ⇒ [self first: formindex] self last: formindex].<br></span><span class="tab" val="79"></span><span class="small">self replace: formindex with: form.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">initspaceat: spaceorigin </span><span class="small">| i run para<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"make a space for formset viewing"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">image &larr; String new: 256.<br></span><span class="tab" val="79"></span><span class="small">image all &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">for⦂ i from: ((self first) to: (self last)+1)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">do⦂ [image◦(i+1) &larr; i].<br></span><span class="tab" val="79"></span><span class="small">run &larr; String new: 2.<br></span><span class="tab" val="79"></span><span class="small">run word: 1 &larr;  16 * (styleindex) + 0177400.<br></span><span class="tab" val="79"></span><span class="small">para &larr;<br></span><span class="tab" val="79"></span><span class="small">Paragraph new text: image runs: run alignment: 0.<br></span><span class="tab" val="79"></span><span class="small">[space ≡ nil ⇒ [] space erase].<br></span><span class="tab" val="79"></span><span class="small">space&larr; Textframe new para: para<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">frame: (Rectangle new origin: spaceorigin extent:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">((self last) - (self first) * (self maxwidth) / 8)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">⌾<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">((self ascent) + (self descent) * 6))<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">style: style.<br></span><span class="tab" val="79"></span><span class="small">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">makecu: name scale: scale<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">| f i iform bits drast srast<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Put out strike in Carnegie-Mellon format.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">A typical call might look like:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">yourset &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">FormSet new style: DefaultTextStyle styleindex: 0.<br><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">yourset makecu: &rsquo;cream12&rsquo; scale: 1.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"<br><br></span><span class="tab" val="79"></span><span class="small">user  displayoffwhile⦂<br></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">f &larr; (dp0 file: name + &rsquo;.cu.&rsquo;).<br></span><span class="tab" val="79"></span><span class="small">f nextword &larr; self height * scale.<br></span><span class="tab" val="79"></span><span class="small">f nextword &larr; self maxwidth * scale + 15 / 16.<br></span><span class="tab" val="79"></span><span class="small">bits &larr; String new:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">((self height * scale) * ((self maxwidth * scale + 15)/16))<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">* 2.<br></span><span class="tab" val="79"></span><span class="small">drast &larr; self maxwidth * scale + 15 / 16.<br></span><span class="tab" val="79"></span><span class="small">srast &larr; (user screenrect width) + 15/16.<br></span><span class="tab" val="79"></span><span class="small">for⦂ i from: ((self first) to: (self last) by: 1) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[iform &larr; "self copy: i to: 0⌾0" self asForm: i. <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">iform displayat: (0⌾0) effect: 0 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[scale &gt; 1 ⇒ [iform blowup: 0⌾0 by: scale]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">f nextword &larr; i. f nextword &larr; self width*scale.<br><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">bitmover destbase &larr; bits.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">bitmover destraster &larr; drast.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">bitmover destx &larr; 0. bitmover desty &larr; 0.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">bitmover sourcebase &larr; mem◦066.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">bitmover sourceraster &larr; srast.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">bitmover sourcex &larr; 0. bitmover sourcey &larr; 0.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">bitmover dstrike &larr; false.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">bitmover sstrike &larr; true.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">bitmover width &larr; (iform width) * scale.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">bitmover height &larr; (iform height) * scale.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">bits all &larr; 0.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">bitmover copy: storing.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">f append: bits].<br></span><span class="tab" val="79"></span><span class="small">f close.<br></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">newspace<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"let user reshape/position space"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">space frame &larr; Rectangle new fromuser. self show.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">replace: formindex with: form<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Replace form in set.  Check incoming form for compatibility with formset,<br></span><span class="tab" val="79"></span><span class="small italic">and insert form into formset."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">self checkindex.<br></span><span class="tab" val="79"></span><span class="small">[form width ≠ self width ⇒ [self changewidthof: formindex to: form width]].<br></span><span class="tab" val="79"></span><span class="small">form displayat: (0⌾0) effect: 0 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="small italic">"copy bits of form into formset"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">bitmover destraster &larr; (self wordwidth).<br></span><span class="tab" val="79"></span><span class="small">bitmover destx &larr; (self originx). bitmover desty &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">bitmover sourcex &larr; 0. bitmover sourcey &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">bitmover width &larr; (self width).<br></span><span class="tab" val="79"></span><span class="small">bitmover height &larr; (self ascent) + (self descent).<br></span><span class="tab" val="79"></span><span class="small">bitmover sourceraster &larr; ((user screenrect) width + 15 / 16).<br></span><span class="tab" val="79"></span><span class="small">bitmover destbase &larr; strike.<br></span><span class="tab" val="79"></span><span class="small">bitmover sourcebase &larr; (mem ◦ 066).<br></span><span class="tab" val="79"></span><span class="small">bitmover dstrike &larr; true.<br></span><span class="tab" val="79"></span><span class="small">bitmover copy: storing.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">show<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"show all the forms in the set"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">space outline. space show<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">space<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"return textframe that is space of formset"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">⇑ space <br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">spaceframe<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"return frame of space"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">⇑(space frame)<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">spaceorigin: spaceorigin<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"reposition the space"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">space erase. (space frame) origin &larr; spaceorigin. self show.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">widthof: formindex<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"return width of from at formindex"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">⇑self width<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>INTERNAL</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">abslength<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Return absolute length of formset, i.e. number of forms in set<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">plus space for illegal character and its rightx"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">⇑ ((self last) - (self first) + 3)<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">checkindex<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"check formindex for legality and make into number if necessary"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[formindex is: String ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[formindex length &gt; 1 ⇒ [user notify: &rsquo;formindex out of range for FormSet.&rsquo;]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">formindex &larr; formindex◦1]<br></span><span class="tab" val="79"></span><span class="small">].<br></span><span class="tab" val="79"></span><span class="small">(formindex &lt; (self first)) or: (formindex &gt; (self last+1)) ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[user notify: &rsquo;formindex out of range for this FormSet.&rsquo;]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">deltaascent: delta </span><span class="small">| newstrike<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"ascent delta"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[(self ascent) + delta &lt; 0 ⇒[delta &larr; 0 - (self ascent)]].<br></span><span class="tab" val="79"></span><span class="small">[delta &gt; 0 ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"grow"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">newstrike &larr; String new: (2 * (self wordwidth) * delta).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">newstrike all &larr;  0.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"fill with white"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">newstrike &larr;</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"add oldfont header and new space together"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(strike◦(1 to: 18) concat: newstrike◦(1 to: newstrike length)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">newstrike &larr;</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"now add on rest of old font"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(newstrike concat: strike◦(19 to: strike length)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small italic">"shrink"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">newstrike &larr; (strike◦(1 to: 18) concat:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">strike◦((19 + (0 - (2 * (self wordwidth) * delta)))<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">to: strike length)).<br></span><span class="tab" val="79"></span><span class="small">].<br></span><span class="tab" val="79"></span><span class="small">newstrike word: 6 &larr; ((self ascent) + delta).</span><span class="tab" val="79"></span><span class="small italic">"reset ascent word in font"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">self install: newstrike.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"newstrike now font of interest"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">self updateseglength.<br></span><span class="tab" val="79"></span><span class="small">[style ≡ nil ⇒ [ ]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(style maxascent) &lt; (self ascent) ⇒ [style maxascent: (self ascent)]].<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">deltadescent: delta </span><span class="small">| newstrike somespace<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"descent delta"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[(self descent) + delta &lt; 0 ⇒ [ delta &larr; 0 - (self descent)]].<br></span><span class="tab" val="79"></span><span class="small">[delta &gt; 0 ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[somespace &larr; String new: 2 * (self wordwidth) * delta.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">somespace all &larr; 0.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">newstrike &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(strike ◦ (1 to: offsettable - 1 * 2) concat: somespace).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">newstrike &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(strike ◦ (1 to: ((offsettable - 1 * 2)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">+ ((self wordwidth) * delta * 2)))).<br></span><span class="tab" val="79"></span><span class="small">].<br></span><span class="tab" val="79"></span><span class="small italic">"copy the xtable"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">newstrike &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">newstrike concat: strike ◦ ((offsettable * 2 - 1) to: strike length).<br></span><span class="tab" val="79"></span><span class="small">newstrike word: 7 &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">((self descent) + delta).</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"reset descent word in font"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">self install: newstrike.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"updatedfont now font of interest"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">self updatemaxwidth.<br></span><span class="tab" val="79"></span><span class="small">self updateseglength.<br></span><span class="tab" val="79"></span><span class="small">[style ≡ nil ⇒ [ ]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(style maxdescent) &lt; (self descent) ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[style maxdescent: (self descent)]]<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">deltawidthof: index by: delta<br></span><span class="tab" val="79"></span><span class="small">| newwordwidth newoffsettable newstrike normalizedindex normalizedlast i<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"change width of form at index"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[delta &lt; 0 ⇒ [(delta abs) &gt; (self width) ⇒ [delta &larr; 0-(self width)]]].<br></span><span class="tab" val="79"></span><span class="small">newwordwidth &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[((self strikerightx) + 15 / 16) ≠<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(i &larr; ((self strikerightx) + delta + 15 / 16)) ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[ i ]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(self wordwidth)].<br></span><span class="tab" val="79"></span><span class="small">newoffsettable &larr; newwordwidth *<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">((self ascent + self descent)) </span><span class="small italic">"height"</span><span class="small"> + 9 </span><span class="small italic">"header"</span><span class="small"> + 1 </span><span class="small italic">"for 0 addressing"</span><span class="small">.<br></span><span class="tab" val="79"></span><span class="small">XeqCursor showwhile⦂ <br></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">newstrike &larr; String new: (9 </span><span class="small italic">"header"</span><span class="small"> + (newwordwidth *<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">((self ascent + self descent)) </span><span class="small italic">"bits"</span><span class="small">)) * 2.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"grow/shrink the bits"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">newstrike all &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: 8 do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[newstrike word: i &larr; strike word: i].</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"fill in header of new font"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">newstrike word: 9 &larr; newwordwidth.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"set raster in new font"</span><span class="small"><br><br></span><span class="tab" val="79"></span><span class="small italic">"copy the xtable"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">newstrike &larr; newstrike concat: strike◦((offsettable * 2 - 1) to: strike length).<br><br></span><span class="tab" val="79"></span><span class="small italic">"set up to copy up to old bits of form in formset"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">bitmover destraster &larr; newwordwidth.<br></span><span class="tab" val="79"></span><span class="small">bitmover destx &larr; 0. bitmover desty &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">bitmover sourcex &larr; 0. bitmover sourcey &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">bitmover width &larr; (self originx) + (self width).<br></span><span class="tab" val="79"></span><span class="small">bitmover height &larr; (self ascent) + (self descent).<br></span><span class="tab" val="79"></span><span class="small">bitmover sourceraster &larr; (self wordwidth).<br></span><span class="tab" val="79"></span><span class="small">bitmover destbase &larr; newstrike.<br></span><span class="tab" val="79"></span><span class="small">bitmover sourcebase &larr; strike.<br></span><span class="tab" val="79"></span><span class="small">bitmover sstrike &larr; true.<br></span><span class="tab" val="79"></span><span class="small">bitmover dstrike &larr; true.<br></span><span class="tab" val="79"></span><span class="small">bitmover copy: storing.<br><br></span><span class="tab" val="79"></span><span class="small italic">"now copy remainder of font"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">bitmover destx &larr; (self originx) + (self width) + delta.<br></span><span class="tab" val="79"></span><span class="small">bitmover width &larr; (self strikerightx) - (self originx) - (self width).<br></span><span class="tab" val="79"></span><span class="small">bitmover sourcex &larr; (self originx) + (self width).<br></span><span class="tab" val="79"></span><span class="small">bitmover copy: storing.<br><br></span><span class="tab" val="79"></span><span class="small italic">"shift x-vals"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">normalizedindex &larr; formindex - (self first).<br></span><span class="tab" val="79"></span><span class="small">normalizedlast &larr; (self last) - (self first).<br></span><span class="tab" val="79"></span><span class="small">for⦂ i from: ((normalizedindex + 1) to: (normalizedlast + 2 </span><span class="small italic">"max"</span><span class="small">)) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[newstrike word: (newoffsettable+i) &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">delta + (newstrike word: (newoffsettable+i))].<br></span><span class="tab" val="79"></span><span class="small">self install: newstrike.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"set up the updated copy of the formset"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">self updatemaxwidth.<br></span><span class="tab" val="79"></span><span class="small">self updateseglength. <br></span><span class="tab" val="79"></span><span class="small">].<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">install: strike<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"set up a new or refreshed strike"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[style ≡ nil ⇒ [] style fonts ◦ (styleindex + 1) &larr; strike].<br></span><span class="tab" val="79"></span><span class="small">offsettable &larr; (self wordwidth) *<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">((self ascent) + (self descent)) + 9 </span><span class="small italic">"header"</span><span class="small"> + 1 </span><span class="small italic">"for 0 addressing"</span><span class="small">.<br></span><span class="tab" val="79"></span><span class="small">⇑ strike]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">length<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Return length of formset, i.e. number of forms in set"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">⇑ ((self last) - (self first) + 1)<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">originx<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Return origin x  of form at formindex"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">⇑ (strike word: (offsettable + formindex - (self first)))]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">updatemaxwidth </span><span class="small">| newmaxwidth i<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"update max width"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">newmaxwidth &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">for⦂ i from:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(offsettable to: offsettable + ((self last) - (self first) + 1))<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[newmaxwidth &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(newmaxwidth<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">max: ((strike word: i+1) - (strike word: i)))].<br></span><span class="tab" val="79"></span><span class="small">self maxwidth: newmaxwidth.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">updateseglength<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"compute new segment length for formset"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">strike word: 5 &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(5</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"length, ascent, descent, kern, and raster"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">+ ((self wordwidth) * ((self ascent) + (self descent)))</span><span class="tab" val="79"></span><span class="small italic">"bits"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">+ ((self last "max") - (self first</span><span class="tab" val="79"></span><span class="small">"min") + 2)</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"xtabl"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">).<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">width<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Return width of form at formindex"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">⇑ (strike word: (offsettable + (formindex - (self first)) + 1)) -<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(strike word: (offsettable + (formindex - (self first)))) ]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>PARTS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">ascent<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"When form set treated as characters, describes distance from top of form<br></span><span class="tab" val="79"></span><span class="small italic">to baseline."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">⇑(strike word: 6)<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">ascent: ascent<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"When form set treated as characters, describes distance from top of form<br></span><span class="tab" val="79"></span><span class="small italic">to baseline."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">strike word: 6 &larr; ascent.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">descent<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"When form set treated as characters, describes distance from bottom of<br></span><span class="tab" val="79"></span><span class="small italic">form to baseline."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">⇑(strike word: 7)<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">descent: descent<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"When form set treated as characters, describes distance from bottom of<br></span><span class="tab" val="79"></span><span class="small italic">form to baseline."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">strike word: 7 &larr; descent.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">first<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Heritage from the world of fonts"<br></span><span class="tab" val="79"></span><span class="small">⇑(strike word: 2)</span><span class="tab" val="79"></span><span class="small italic">"minimum formindex (ascii) in the strike"</span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">first: first<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Heritage from the world of fonts"<br></span><span class="tab" val="79"></span><span class="small">strike word: 2 &larr; first.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"minimum formindex (ascii) in the strike"<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">kern<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"When form set treated as characters, describes distance this form is<br></span><span class="tab" val="79"></span><span class="small italic">to intrude into space of preceding character."<br></span><span class="tab" val="79"></span><span class="small">⇑(strike word: 8)<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">last<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Heritage from the world of fonts"<br></span><span class="tab" val="79"></span><span class="small">⇑(strike word: 3)</span><span class="tab" val="79"></span><span class="small italic">"maximum formindex (ascii) in the strike"<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">last: last<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Heritage from the world of fonts"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">strike word: 3 &larr; last.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"maximum formindex (ascii) in the strike"<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">maxwidth<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"All forms in this set ≤ to this value"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">⇑(strike word: 4)<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">maxwidth: maxwidth<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"All forms in this set ≤ to this value"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">strike word: 4 &larr; maxwidth.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">segmentlength<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Amount of space allocated for form set - 4"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">⇑(strike word: 5)<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">strikerightx<br></span><span class="tab" val="79"></span><span class="small">["Corner x of last form in form set"<br></span><span class="tab" val="79"></span><span class="small">⇑(strike word: (offsettable + ((self last) - (self first)) + 2)).<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">type<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"**BEWARE -- outside world has ideas about this value."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">⇑(strike word: 1)<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">type: type<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"**BEWARE -- outside world has ideas about this value."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">strike word: 1 &larr; type.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">wordwidth<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Also know as the raster of the formset.<br></span><span class="tab" val="79"></span><span class="small italic">The width in alto words of the bits of the formset.  When the display of a <br></span><span class="tab" val="79"></span><span class="small italic">form is desired, the word and bit address of the bits of the form must<br></span><span class="tab" val="79"></span><span class="small italic">be discovered.  Adding the wordwidth to the word portion of that value,<br></span><span class="tab" val="79"></span><span class="small italic">produces the word address of the second line of the bits of the form, and<br></span><span class="tab" val="79"></span><span class="small italic">so on until the height of the form is spanned."</span><span class="small"><br><br></span><span class="tab" val="79"></span><span class="small">⇑(strike word: 9)<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">wordwidth: wordwidth<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Also know as the raster of the formset.<br></span><span class="tab" val="79"></span><span class="small italic">The width in alto words of the bits of the formset.  When the display of a <br></span><span class="tab" val="79"></span><span class="small italic">form is desired, the word and bit address of the bits of the form must<br></span><span class="tab" val="79"></span><span class="small italic">be discovered.  Adding the wordwidth to the word portion of that value,<br></span><span class="tab" val="79"></span><span class="small italic">produces the word address of the second line of the bits of the form, and<br></span><span class="tab" val="79"></span><span class="small italic">so on until the height of the form is spanned."</span><span class="small"><br><br></span><span class="tab" val="79"></span><span class="small">strike word: 9 &larr; wordwidth.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">SystemOrganization classify: ↪FormSet under: &rsquo;Form Path Image&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">FormSet classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>"Image"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold">Class new title: &rsquo;Image&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">subclassof: Set<br></span><span class="tab" val="79"></span><span class="medium bold">fields: &rsquo; origin rectangle path form superimage xgrid ygrid figure ground&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">declare: &rsquo;aurora under black screen reverse white over aurorarunning &rsquo;;<br></span><span class="tab" val="79"></span><span class="medium bold">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small italic"><br>This class has not yet been commented</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>INIT</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">blink: form </span><span class="small">| pt <br></span><span class="tab" val="79"></span><span class="small">["to show current gridded position of the form... returns abs position."<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">pt &larr; self mp.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">form displayat: ( rectangle origin)+ pt<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">effect: 2 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">form displayat: ( rectangle origin)+ pt<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">effect: 2 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="small">⇑ (self rectangle origin)+ pt<br></span><span class="tab" val="79"></span><span class="small">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">classInit<br></span><span class="tab" val="79"></span><span class="small">["sets up black and white as colors and over ,under and reverse as modes<br></span><span class="tab" val="79"></span><span class="small">also initializes the name screen as an image the size of the display"<br></span><span class="tab" val="79"></span><span class="small">black &larr; 0-1.<br></span><span class="tab" val="79"></span><span class="small">white &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">over &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">under &larr; 1.<br></span><span class="tab" val="79"></span><span class="small">reverse &larr; 2.<br></span><span class="tab" val="79"></span><span class="small">screen &larr; Image new origin: user screenrect origin extent: user screenrect extent.<br></span><span class="tab" val="79"></span><span class="small">aurora &larr; "Aurora new" nil.<br></span><span class="tab" val="79"></span><span class="small">aurorarunning &larr; false.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">fromuser<br></span><span class="tab" val="79"></span><span class="small">["create a new Image whose rectangle is specified by the user. "<br></span><span class="tab" val="79"></span><span class="small">rectangle &larr; Rectangle new fromuser.<br></span><span class="tab" val="79"></span><span class="small">self origin: (rectangle origin) rectangle: rectangle<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">path: (rectangle origin) form: (Form new fromrectangle: rectangle)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">figure: 1 ground: 0 xgrid: 1 ygrid: 1.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">origin: origin extent: extent <br></span><span class="tab" val="79"></span><span class="small">["create a new Image at origin with extent (width⌾height). "<br></span><span class="tab" val="79"></span><span class="small">self origin: (origin copy)  rectangle: (Rectangle new origin: origin extent: extent)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small"> path: nil form: nil figure: 1 ground: 0 xgrid: 1 ygrid: 1<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">origin: origin rectangle: rectangle path: path form: form<br></span><span class="tab" val="79"></span><span class="small">["basic message to create a new instance."<br></span><span class="tab" val="79"></span><span class="small">self origin: origin rectangle: rectangle path: path form: form<br></span><span class="tab" val="79"></span><span class="small">figure: 1 ground: 0 xgrid: 1 ygrid: 1.<br></span><span class="tab" val="79"></span><span class="small">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">origin: origin rectangle: rectangle path: path form: form figure: figure ground: ground xgrid: xgrid ygrid: ygrid<br></span><span class="tab" val="79"></span><span class="small">["basic message to create a new instance."<br></span><span class="tab" val="79"></span><span class="small">self default]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">rectanglefromuser | f pt r<br></span><span class="tab" val="79"></span><span class="small">["create a  Rectangle  specified by the user and origin and corner are gridded. "<br></span><span class="tab" val="79"></span><span class="small">r &larr; Rectangle new.<br></span><span class="tab" val="79"></span><span class="small">f &larr; Form new extent: xgrid⌾ygrid. f black.<br></span><span class="tab" val="79"></span><span class="small">user waitnobug.<br></span><span class="tab" val="79"></span><span class="small">until⦂ user anybug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">r origin &larr; self blink: f.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">].<br></span><span class="tab" val="79"></span><span class="small">until⦂ user nobug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">r corner &larr; (self mp + rectangle origin) max: (r origin + f extent).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">r reverse ; reverse.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">].<br></span><span class="tab" val="79"></span><span class="small">⇑ r.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>BUILDING IMAGES</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">add: p and: i | s<br></span><span class="tab" val="79"></span><span class="small">["add p (set or point) and i ( Image or Form ) and expand the<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small"> bounding rectangle of this image."<br></span><span class="tab" val="79"></span><span class="small">rectangle &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">rectangle include:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">((Rectangle new origin: (p origin)+ origin extent: i size)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">include: (Rectangle new origin: (p corner)+ origin extent: i size)).<br></span><span class="tab" val="79"></span><span class="small">s &larr; Set default. s add: p ; add: i .<br></span><span class="tab" val="79"></span><span class="small">self add: s<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">addform: f andpath: p | r<br></span><span class="tab" val="79"></span><span class="small">["add p (set or point) and f ( Form ) and expand the<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small"> bounding rectangle of this image."<br></span><span class="tab" val="79"></span><span class="small">self addpath: p andform: f<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">addimage: i  | r<br></span><span class="tab" val="79"></span><span class="small">["add the Image i (as a subimage) and expand the<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small"> bounding rectangle of this image."<br></span><span class="tab" val="79"></span><span class="small">rectangle &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">rectangle<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">include:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(Rectangle new origin: (i origin)+ origin extent: i extent).<br></span><span class="tab" val="79"></span><span class="small">self add: i.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">addpath: p andform: f | r<br></span><span class="tab" val="79"></span><span class="small">["add p (set or point) and f ( Form ) and expand the<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small"> bounding rectangle of this image."<br></span><span class="tab" val="79"></span><span class="small">rectangle &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">rectangle<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">include:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(r &larr; ((Rectangle new origin: (p origin)"+ origin" extent: f extent)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">include:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(Rectangle new origin: ((p corner) - (1⌾1))"+ origin" extent: f extent))).<br></span><span class="tab" val="79"></span><span class="small">self add: (Image new origin: 0⌾0 rectangle: r path: p form: f<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">figure: 1 ground: 0 xgrid: 1 ygrid: 1).<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>CHANGING IMAGES</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">appendimage: newimage after: image </span><span class="small">| i<br></span><span class="tab" val="79"></span><span class="small">["append newimage into the image after image."<br></span><span class="tab" val="79"></span><span class="small">i &larr; self findbyrect: image.<br></span><span class="tab" val="79"></span><span class="small">self insertI: (i+1) value: newimage.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">comment<br></span><span class="tab" val="79"></span><span class="small">["see class Set for operations (deletion,replacement,insertion etc.) on subimages ( elements)."]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">deleteimage: i | subimage<br></span><span class="tab" val="79"></span><span class="small">["delete the i th subimage and recompute the bounding rectangle of the Image"<br></span><span class="tab" val="79"></span><span class="small">subimage &larr; self◦i.<br></span><span class="tab" val="79"></span><span class="small">self deleteI: i.<br></span><span class="tab" val="79"></span><span class="small">( subimage rectangle) isWithin: rectangle⇒ [] self resize "recompute bounding rectangle"<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">deletesubimage: i <br></span><span class="tab" val="79"></span><span class="small">["delete the ith subimage."<br></span><span class="tab" val="79"></span><span class="small">self deleteindex: i.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">edit: superimage | </span><span class="small">blackdot pt indexofsubimage subimage</span><span class="small bold"><br></span><span class="tab" val="79"></span><span class="small">["eventually a general Image manipulator for now<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">just passes control to its subimages."<br></span><span class="tab" val="79"></span><span class="small">nil≡ form ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[user waitnobug.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">until⦂ (1 = 2) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small"> "until bug occurs outside rectangle"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">((false = (rectangle has: (user mp))) and: (user anybug))⇒[⇑ self ]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user kbck ⇒ [ self kbd ]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user redbug⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[indexofsubimage &larr; self smallestsubimageat:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">( (user mp) - self rectangle origin).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">indexofsubimage⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[ subimage &larr; self◦indexofsubimage.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">subimage translate: self origin .<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">subimage edit: self.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">subimage translate: ((0⌾0)-self origin).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user yellowbug⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">self yellowbug<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">].<br></span><span class="tab" val="79"></span><span class="small">form &larr; form edit: self.<br></span><span class="tab" val="79"></span><span class="small">[form is: Form⇒ [] "origin &larr;  (form origin) copy." rectangle &larr; (form frame) copy].<br></span><span class="tab" val="79"></span><span class="small">⇑ self <br></span><span class="tab" val="79"></span><span class="small">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">findbyrect: image </span><span class="small">| i<br></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: position do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[(array◦i) rectangle = image rectangle ⇒ [⇑i]].<br></span><span class="tab" val="79"></span><span class="small">⇑0]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">highlite  | r i<br></span><span class="tab" val="79"></span><span class="small">["reverse the ith subimage ."<br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: position do⦂ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">r &larr; Rectangle new origin: (self origin+ (self◦i) origin)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">extent: (self◦i) extent.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">r comp<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">indexofsubimageat: pt | i subimage <br></span><span class="tab" val="79"></span><span class="small">["return the index of the subimage which contains pt(relative to self origin)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">otherwise return false."<br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: self length do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[subimage &larr; (self◦i).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(subimage rectangle) has: pt⇒ [ ⇑ i]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">⇑ false<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">indexofsubimagebelow: yvalue | i subimage <br></span><span class="tab" val="79"></span><span class="small">["return the index of the first subimage below yvalue otherwise return false."<br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: self length do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[ ((self◦i) top ≥ yvalue) ⇒ [ ⇑ i]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">⇑ false<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">outlinesubimage: i  | r<br></span><span class="tab" val="79"></span><span class="small">["draw an outline(reversed boarder 2 units thick) about the ith subimage ."<br></span><span class="tab" val="79"></span><span class="small">r &larr; Rectangle new origin: (self origin+ (self◦i) origin)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">extent: (self◦i) extent.<br></span><span class="tab" val="79"></span><span class="small">r comp<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">replaceimage: image with: newimage </span><span class="small">| i<br></span><span class="tab" val="79"></span><span class="small">["replace image with newimage in self."<br></span><span class="tab" val="79"></span><span class="small">i &larr; self findbyrect: image.<br></span><span class="tab" val="79"></span><span class="small">self replaceI: i value: newimage.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">smallestsubimageat: pt | i smallest slf sml<br></span><span class="tab" val="79"></span><span class="small">["return the index of the smallest subimage which contains pt(relative to self origin)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">otherwise return false."<br></span><span class="tab" val="79"></span><span class="small">smallest &larr; false.<br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: self length do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">((self◦i) rectangle) has: pt⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">smallest⇒[ slf&larr;((self◦i) rectangle).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">sml&larr;((self◦smallest) rectangle).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(slf area &lt; sml area) ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[smallest &larr; i]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">  ]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">smallest &larr; i<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">smallest⇒[⇑ self◦smallest]<br></span><span class="tab" val="79"></span><span class="small">⇑ smallest</span><span class="small bold italic"> </span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">subimage: i | sub s<br></span><span class="tab" val="79"></span><span class="small">["return the ith subimage."<br></span><span class="tab" val="79"></span><span class="small">sub &larr; (self◦i)<br></span><span class="tab" val="79"></span><span class="small">s &larr; Image new at: (self origin) + (sub◦1) origin. s add: (0⌾0) and: sub◦2. <br></span><span class="tab" val="79"></span><span class="small">⇑ s<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">subimageat: pt | i <br></span><span class="tab" val="79"></span><span class="small">["return the  subimage which contains pt (relative to self origin)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">otherwise return false."<br></span><span class="tab" val="79"></span><span class="small">i &larr; self indexofsubimageat: pt.<br></span><span class="tab" val="79"></span><span class="small">i ⇒ [ ⇑ self◦ i]<br></span><span class="tab" val="79"></span><span class="small">⇑ false<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">subimageswithin: rect | image topleft fittedimage t<br></span><span class="tab" val="79"></span><span class="small">["return an image containing my subimages that are within rect, </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">otherwise return false."<br></span><span class="tab" val="79"></span><span class="small">image &larr; Image new origin: rect origin extent: rect extent.<br></span><span class="tab" val="79"></span><span class="small">for⦂ t from: self do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(t rectangle) isWithin: rect⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">image addimage: (t translate: (0⌾0)-(rect origin))<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">].<br></span><span class="tab" val="79"></span><span class="small">image length = 0⇒[⇑ false]<br></span><span class="tab" val="79"></span><span class="small">topleft &larr; (image◦1) rectangle origin.<br></span><span class="tab" val="79"></span><span class="small">for⦂ t from: image do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[(t rectangle origin) &lt; topleft⇒ [topleft &larr; (t rectangle origin)]].<br></span><span class="tab" val="79"></span><span class="small">fittedimage &larr; Image new origin: (topleft+rect origin) extent: (1⌾1).<br></span><span class="tab" val="79"></span><span class="small">for⦂ t from: image do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[ fittedimage addimage: (t translate: (0⌾0)-topleft)].<br></span><span class="tab" val="79"></span><span class="small">⇑ fittedimage</span><span class="small bold italic"> </span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">substitute: form1 for: form2 </span><span class="small">| i <br></span><span class="tab" val="79"></span><span class="small">["everywhere in the imagesubstitute form1 for form2"<br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: self length do⦂ [ (self◦i)◦2 ≡ form2 ⇒  [ (self◦i)◦2 &larr; form1]]  <br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>DISPLAY</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">blink <br></span><span class="tab" val="79"></span><span class="small">["blink the image" <br></span><span class="tab" val="79"></span><span class="small">self display: 2.<br></span><span class="tab" val="79"></span><span class="small">self display: 2.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">display <br></span><span class="tab" val="79"></span><span class="small">["display all of the forms in the image on the screen "<br></span><span class="tab" val="79"></span><span class="small">self displayat: 0⌾0 effect: 0 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">display: effect  <br></span><span class="tab" val="79"></span><span class="small">["display all of the forms in the image on the screen <br></span><span class="tab" val="79"></span><span class="small">effect = 0 ⇒ store<br></span><span class="tab" val="79"></span><span class="small">effect = 1 ⇒ or<br></span><span class="tab" val="79"></span><span class="small">effect = 2 ⇒ xor<br></span><span class="tab" val="79"></span><span class="small">effect = 3 ⇒ and complement<br>"<br></span><span class="tab" val="79"></span><span class="small">self displayat: 0⌾0 effect: effect clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">displayat: pt effect: effect clippedBy: cliprect </span><span class="small">| i <br></span><span class="tab" val="79"></span><span class="small">["display all of the subimages in this image "<br></span><span class="tab" val="79"></span><span class="small">[nil≡ form</span><span class="tab" val="79"></span><span class="small">⇒ []<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">form displayat: (path + pt+ origin) effect: effect clippedBy: cliprect].<br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: self length  do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[ (self◦i) displayat: (pt +  origin) effect: effect clippedBy: cliprect<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">quickDisplayAt: pt scale: scal offset: delta </span><span class="small">| i rect x1 y1 x2 y2<br></span><span class="tab" val="79"></span><span class="small">["outline me and all of the subimages in this image in given scale"<br></span><span class="tab" val="79"></span><span class="small">x1&larr; (scal*(rectangle minX + pt x) + delta x) asInteger.<br></span><span class="tab" val="79"></span><span class="small">y1&larr; (scal*(rectangle minY + pt y) + delta y) asInteger.<br></span><span class="tab" val="79"></span><span class="small">x2&larr; (scal*(rectangle maxX + pt x) + delta x) asInteger.<br></span><span class="tab" val="79"></span><span class="small">y2&larr; (scal*(rectangle maxY + pt y) + delta y) asInteger.<br></span><span class="tab" val="79"></span><span class="small">rect &larr; x1⌾y1 rect: x2⌾y2.<br></span><span class="tab" val="79"></span><span class="small">rect outline.<br></span><span class="tab" val="79"></span><span class="small">pt &larr; pt+origin.<br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: self length do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[rect &larr; (self◦i) rectangle.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">x1&larr; (scal*(rect minX + pt x) + delta x) asInteger.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">y1&larr; (scal*(rect minY + pt y) + delta y) asInteger.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">x2&larr; (scal*(rect maxX + pt x) + delta x) asInteger.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">y2&larr; (scal*(rect maxY + pt y) + delta y) asInteger.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">rect &larr; x1⌾y1 rect: x2⌾y2.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">rect color: gray mode: oring.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>MODULE ACCESS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">= image<br></span><span class="tab" val="79"></span><span class="small">[⇑(rectangle = (image rectangle))<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">bottom<br></span><span class="tab" val="79"></span><span class="small">["return the bottom y of the bounding rectangle of theImage."<br></span><span class="tab" val="79"></span><span class="small">⇑ rectangle corner y.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">center<br></span><span class="tab" val="79"></span><span class="small">["return the center of the Image."<br></span><span class="tab" val="79"></span><span class="small">⇑ rectangle center.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">contains: pt <br></span><span class="tab" val="79"></span><span class="small">["return true if the  bounding rectangle for the Image contains pt.."<br></span><span class="tab" val="79"></span><span class="small">⇑ rectangle has: pt<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">corner<br></span><span class="tab" val="79"></span><span class="small">["return the corner of the Image."<br></span><span class="tab" val="79"></span><span class="small">⇑ rectangle corner.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">corner&larr; pt<br></span><span class="tab" val="79"></span><span class="small">["modify the corner of the Image."<br></span><span class="tab" val="79"></span><span class="small"> rectangle corner&larr; pt.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">extent <br></span><span class="tab" val="79"></span><span class="small">["return the extent (width,height) of the Image."<br></span><span class="tab" val="79"></span><span class="small">⇑ rectangle extent<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">height<br></span><span class="tab" val="79"></span><span class="small">["return the height of the Image."<br></span><span class="tab" val="79"></span><span class="small">⇑ rectangle extent y.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">leftside<br></span><span class="tab" val="79"></span><span class="small">["return the leftmost x of the bounding rectangle of theImage."<br></span><span class="tab" val="79"></span><span class="small">⇑ rectangle origin x.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">origin<br></span><span class="tab" val="79"></span><span class="small">["return the origin of the image."<br></span><span class="tab" val="79"></span><span class="small">⇑ origin<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">origin: origin<br></span><span class="tab" val="79"></span><span class="small">["change the origin of the image."]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">rectangle <br></span><span class="tab" val="79"></span><span class="small">["return the rectangle that bounds the Image."<br></span><span class="tab" val="79"></span><span class="small">⇑ rectangle<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">rectangle: r <br></span><span class="tab" val="79"></span><span class="small">["redefine rectangle that bounds the Image."<br></span><span class="tab" val="79"></span><span class="small">rectangle&larr; r<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">resize | i <br></span><span class="tab" val="79"></span><span class="small">[" Recompute the bounding rectangle of the Image"<br></span><span class="tab" val="79"></span><span class="small">[nil≡ form</span><span class="tab" val="79"></span><span class="small">⇒ [rectangle &larr; Rectangle new origin: origin extent: 1⌾1]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">rectangle &larr; Rectangle new origin: origin extent: form extent].<br></span><span class="tab" val="79"></span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: self length do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[ rectangle  &larr; rectangle include: ((self◦i) rectangle) ]<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">rightside<br></span><span class="tab" val="79"></span><span class="small">["return the rightmost x of the bounding rectangle of theImage."<br></span><span class="tab" val="79"></span><span class="small">⇑ rectangle corner x.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">superimage<br></span><span class="tab" val="79"></span><span class="small">["return the superimage (Image containing) of this Image."<br></span><span class="tab" val="79"></span><span class="small">⇑ superimage<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">top<br></span><span class="tab" val="79"></span><span class="small">["return the top y of the bounding rectangle of theImage."<br></span><span class="tab" val="79"></span><span class="small">⇑ rectangle origin y.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">width<br></span><span class="tab" val="79"></span><span class="small">["return the width of the Image."<br></span><span class="tab" val="79"></span><span class="small">⇑ rectangle extent x.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>PATTERN ACCESS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">black<br></span><span class="tab" val="79"></span><span class="small">["black out the image"<br></span><span class="tab" val="79"></span><span class="small">self color: black effect: 0.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">boxcomp <br></span><span class="tab" val="79"></span><span class="small">["border without disturbing the interior."<br></span><span class="tab" val="79"></span><span class="small">rectangle comp<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">color: color effect: effect <br></span><span class="tab" val="79"></span><span class="small">["basic rectangle call to blt."<br></span><span class="tab" val="79"></span><span class="small">rectangle color: color mode: effect .<br></span><span class="tab" val="79"></span><span class="small">aurorarunning⇒</span><span class="tab" val="79"></span><span class="small">[user displayoffwhile⦂ [aurora destination: rectangle ; source: rectangle ;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">figure: figure ; ground: ground ;  function: 002117 "AoverB" ; doit<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]]<br> ]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">gray<br></span><span class="tab" val="79"></span><span class="small">["gray out the image"<br></span><span class="tab" val="79"></span><span class="small">self color: gray effect: storing<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">reverse<br></span><span class="tab" val="79"></span><span class="small">["reverse  the image (black to white and white to black)"<br></span><span class="tab" val="79"></span><span class="small">self color: black effect: 2<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">white <br></span><span class="tab" val="79"></span><span class="small">["white out the image"<br></span><span class="tab" val="79"></span><span class="small">form is: BorderedText⇒ [ (rectangle inset: (¬1⌾¬1) and: (¬1⌾¬1)) clear: 0]<br></span><span class="tab" val="79"></span><span class="small">self color: white effect: over.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>TRANSFORMATIONS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">griddedpoint: pt <br></span><span class="tab" val="79"></span><span class="small">[⇑ ((pt x)| xgrid) ⌾ ((pt y)| ygrid) ]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">normalize | delta i <br></span><span class="tab" val="79"></span><span class="small">["recompute origin, rectangle and path so that: path origin = 0⌾0."<br></span><span class="tab" val="79"></span><span class="small">[nil ≡ path ⇒ [] delta &larr; (path origin) copy. path normalize. origin translate: delta]. </span><span class="tab" val="79"></span><span class="small">for⦂ i to: self length do⦂ [ (self◦i) normalize ].<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">translate: delta <br></span><span class="tab" val="79"></span><span class="small">["translate the origin and bounding rectangle of the Image."<br></span><span class="tab" val="79"></span><span class="small">rectangle &larr; rectangle translate: delta.<br></span><span class="tab" val="79"></span><span class="small">origin translate: delta.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">translateto: pt <br></span><span class="tab" val="79"></span><span class="small">["move the Image to pt."<br></span><span class="tab" val="79"></span><span class="small">self translate: pt - origin.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>SYSTEM</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">copy </span><span class="small">| im i<br>[<br></span><span class="tab" val="79"></span><span class="small">im &larr; Image new origin: origin copy rectangle: rectangle copy path: path copy form: form copy figure: figure copy ground: ground copy xgrid: xgrid copy  ygrid: ygrid copy.<br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: self length do⦂ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[im add: (self◦i) copy].<br></span><span class="tab" val="79"></span><span class="small">⇑ im<br>]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">fromPress: press value: s </span><span class="small">| numberofsubimages i code t<br></span><span class="tab" val="79"></span><span class="small">["</span><span class="small italic">retrieves and builds an instance of class Image from a press file</span><span class="small">"<br></span><span class="tab" val="79"></span><span class="small">self default. <br></span><span class="tab" val="79"></span><span class="small">numberofsubimages&larr; s nextword.<br></span><span class="tab" val="79"></span><span class="small">origin &larr; s nextPoint.<br></span><span class="tab" val="79"></span><span class="small">i &larr; s nextPoint.<br></span><span class="tab" val="79"></span><span class="small">rectangle &larr; i rect: s nextPoint.<br></span><span class="tab" val="79"></span><span class="small">xgrid &larr; s nextword.<br></span><span class="tab" val="79"></span><span class="small">ygrid &larr; s nextword.<br></span><span class="tab" val="79"></span><span class="small">figure &larr; s nextword.<br></span><span class="tab" val="79"></span><span class="small">ground &larr; s nextword.<br><br></span><span class="tab" val="79"></span><span class="small">form &larr; s next.<br></span><span class="tab" val="79"></span><span class="small">path &larr; s next.<br><br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: numberofsubimages do⦂ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">s &larr; press nextControl asStream.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">code &larr; s next.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">t &larr; Image new.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">code = t pressCode⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">self addimage: (t fromPress: press value: s)]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user notify: &rsquo;subimage not Image&rsquo;].<br><br></span><span class="tab" val="79"></span><span class="small">[form=0⇒ [form &larr; nil]<br></span><span class="tab" val="79"></span><span class="small">s &larr; press nextControl asStream.<br></span><span class="tab" val="79"></span><span class="small">code &larr; s next.<br></span><span class="tab" val="79"></span><span class="small">form &larr; [code = 4⇒ [TextImage new]; =5⇒ [Form new]; = 6 ⇒[BorderedText new] false].<br></span><span class="tab" val="79"></span><span class="small">form and⦂ code = form pressCode⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[code=4⇒ [form frame &larr; rectangle copy]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[code=6⇒ [form frame &larr; rectangle copy]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">form fromPress: press value: s]<br></span><span class="tab" val="79"></span><span class="small">user notify: &rsquo;illegal form&rsquo;].<br><br></span><span class="tab" val="79"></span><span class="small">[path=0⇒ [path &larr; nil]<br></span><span class="tab" val="79"></span><span class="small">s &larr; press nextControl asStream.<br></span><span class="tab" val="79"></span><span class="small">code &larr; s next.<br></span><span class="tab" val="79"></span><span class="small">path &larr; [code = 6⇒ [Path new]; =7⇒ [Point new] false].<br></span><span class="tab" val="79"></span><span class="small">path and⦂ code = path pressCode⇒ [path fromPress: press value: s]<br></span><span class="tab" val="79"></span><span class="small">user notify: &rsquo;illegal path&rsquo;]<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">hideData: complete </span><span class="small">| s<br></span><span class="tab" val="79"></span><span class="small">["</span><span class="small italic">stores an instance of class Image on a press file. ignore complete</span><span class="small">"<br></span><span class="tab" val="79"></span><span class="small">Stream new of: (s &larr; String new: 24);<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">nextword&larr; self length; "</span><span class="small italic">number of subimages</span><span class="small">"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">nextPoint&larr; origin;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">nextPoint&larr; rectangle origin;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">nextPoint&larr; rectangle corner;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">nextword&larr; xgrid;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">nextword &larr; ygrid;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">nextword &larr; figure;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">nextword &larr; ground;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">next &larr; [form≡nil ⇒ [0] 1];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">next &larr; [path≡nil⇒ [0] 1].<br></span><span class="tab" val="79"></span><span class="small">⇑ s]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">hidePress: press complete: c </span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">c ≥ 0⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"</span><span class="small italic">called from </span><span class="small bold">PressPrinter print:in:</span><span class="small">"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[form≡nil⇒ ["</span><span class="small italic">already done</span><span class="small">"]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">form hidePress: press complete: c].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">path≡nil⇒ []<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">path hidePress: press complete: c]<br></span><span class="tab" val="79"></span><span class="small">"</span><span class="small italic">¬1. called from </span><span class="small bold">Image presson:in:</span><span class="small">"<br></span><span class="tab" val="79"></span><span class="small">press skipcode: self pressCode data: (self hideData: c)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">kbd | <br></span><span class="tab" val="79"></span><span class="small">[" default response for Images."<br></span><span class="tab" val="79"></span><span class="small">user kbd.<br></span><span class="tab" val="79"></span><span class="small">self reverse ; reverse.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">mp | p<br></span><span class="tab" val="79"></span><span class="small">[" returns a gridded point relative to my rectangle."<br></span><span class="tab" val="79"></span><span class="small">p &larr; user mp.<br></span><span class="tab" val="79"></span><span class="small">p x&larr; ((p x) - rectangle origin x) | xgrid. <br></span><span class="tab" val="79"></span><span class="small">p y&larr; ((p y) - rectangle origin y) | ygrid.<br></span><span class="tab" val="79"></span><span class="small">⇑ p<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">pressCode </span><span class="small">[⇑1]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">presson: press in: r </span><span class="small">| yvalue t h rect [</span><span class="small bold"><br></span><span class="tab" val="79"></span><span class="small">self length &gt; 0 and⦂ r height &lt; (h &larr; press scale * self height)⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"</span><span class="small italic">try on next page</span><span class="small">" ⇑self]<br><br></span><span class="tab" val="79"></span><span class="small">self hidePress: press complete: ¬1.<br></span><span class="tab" val="79"></span><span class="small">for⦂ t from: self do⦂ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">yvalue &larr;  t presson: press in: r.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"</span><span class="small italic">if subimage didn&rsquo;t fit, print version will be clipped,<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">but entire subimage will be stored</span><span class="small">"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">t hidePress: press complete: [yvalue is: Integer⇒ [0] 1]].<br><br></span><span class="tab" val="79"></span><span class="small">form≡nil⇒ [⇑r corner y - h]<br></span><span class="tab" val="79"></span><span class="small">rect &larr; r copy.<br></span><span class="tab" val="79"></span><span class="small">rect corner y &larr; rect corner y - (( path y)*(press scale)).<br></span><span class="tab" val="79"></span><span class="small">"</span><span class="small italic">form will be hidden by Image presson:in: or PressPrinter print:in:</span><span class="small">".<br></span><span class="tab" val="79"></span><span class="small">⇑form presson: press in: rect]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">printon: strm </span><span class="small">| t [<br></span><span class="tab" val="79"></span><span class="small">strm append: &rsquo;an Image: &rsquo;.<br></span><span class="tab" val="79"></span><span class="small">array is: String⇒ [strm space append: self]<br></span><span class="tab" val="79"></span><span class="small">for⦂ t from: self do⦂ [strm space print: t]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>ACCESS TO PARTS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">figure<br></span><span class="tab" val="79"></span><span class="small">["return the figure color (color associated with black) for this Image"<br></span><span class="tab" val="79"></span><span class="small">⇑ figure<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">figure: figure <br></span><span class="tab" val="79"></span><span class="small">["change the figure color (color associated with black) for this Image"]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">form <br></span><span class="tab" val="79"></span><span class="small">["return the form for this Image"<br></span><span class="tab" val="79"></span><span class="small">⇑ form<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">form: form <br></span><span class="tab" val="79"></span><span class="small">["change the form for this Image"]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">ground<br></span><span class="tab" val="79"></span><span class="small">["return the ground color (color associated with white) for this Image"<br></span><span class="tab" val="79"></span><span class="small">⇑ ground<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">ground: ground <br></span><span class="tab" val="79"></span><span class="small">["change the ground color (color associated with white) for this Image"]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">hash </span><span class="small">[⇑rectangle hash]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">path <br></span><span class="tab" val="79"></span><span class="small">["return the path for this Image"<br></span><span class="tab" val="79"></span><span class="small">⇑ path<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">path: path<br></span><span class="tab" val="79"></span><span class="small">["change the path for this Image"]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">superimage: superimage </span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">xgrid <br></span><span class="tab" val="79"></span><span class="small">["return the x gridding module for this Image"<br></span><span class="tab" val="79"></span><span class="small">⇑ xgrid<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">xgrid: xgrid <br></span><span class="tab" val="79"></span><span class="small">["set the x gridding module for this Image"<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">ygrid <br></span><span class="tab" val="79"></span><span class="small">["return the y gridding module for this Image"<br></span><span class="tab" val="79"></span><span class="small">⇑ ygrid<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">ygrid: ygrid <br></span><span class="tab" val="79"></span><span class="small">["set the y gridding module for this Image"<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Fist and last</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">close<br></span><span class="tab" val="79"></span><span class="small">| im<br></span><span class="tab" val="79"></span><span class="small">[[array≡nil<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">⇒[]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">for⦂ im  from: self asArray notNil do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[im close]].<br></span><span class="tab" val="79"></span><span class="small">superimage&larr;nil.<br></span><span class="tab" val="79"></span><span class="small">form&larr;nil.<br></span><span class="tab" val="79"></span><span class="small">self vector: 0]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">SystemOrganization classify: ↪Image under: &rsquo;Form Path Image&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">Image classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>"Path"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold">Class new title: &rsquo;Path&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">subclassof: Set<br></span><span class="tab" val="79"></span><span class="medium bold">fields: &rsquo;&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">declare: &rsquo;&rsquo;;<br></span><span class="tab" val="79"></span><span class="medium bold">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small italic"><br>This class has not yet been commented</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>INIT</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">init <br></span><span class="tab" val="79"></span><span class="small">["must be executed for each new instance."<br></span><span class="tab" val="79"></span><span class="small">self default.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>BUILDING PATHS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">comment <br></span><span class="tab" val="79"></span><span class="small">["see Set for these ... add:, append:, and ◦&larr; are the main ones"<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>ACCESSING PATHS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">pointnearestto: p </span><span class="small">| distance i nearest d<br></span><span class="tab" val="79"></span><span class="small">["return the index of the point  in the path nearest (manhatten norm) to p."<br></span><span class="tab" val="79"></span><span class="small">distance &larr; p dist: self◦1.<br></span><span class="tab" val="79"></span><span class="small">nearest &larr; 1.<br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: position do⦂ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[</span><span class="tab" val="79"></span><span class="small">d &larr;  p dist: self◦i .<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">d&lt; distance⇒ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[ nearest&larr; i. distance &larr; d.]  <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">⇑ nearest<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>MODIFYING PATHS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">deleteindex: i </span><span class="small">| r [<br></span><span class="tab" val="79"></span><span class="small">r &larr; array◦( i+1 to: position).<br></span><span class="tab" val="79"></span><span class="small">position &larr; i-1.<br></span><span class="tab" val="79"></span><span class="small">self append: r.<br></span><span class="tab" val="79"></span><span class="small">array◦(position+1) &larr; nil.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">insert: pt atindex: index </span><span class="small">| r <br></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">"insert pt at index in the path"<br></span><span class="tab" val="79"></span><span class="small">index &gt; position⇒ [self next &larr; pt]<br></span><span class="tab" val="79"></span><span class="small">r &larr; [position = limit⇒ [self grow] self growby: 0].<br></span><span class="tab" val="79"></span><span class="small">position &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">self append: (r ◦ 1 to: index-1);<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">next &larr; pt;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">append: r◦(index to: r length).<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>SPECIAL PATHS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">addarcfrom: p1 via: p2 to: p3 </span><span class="small">| pa pb i k s<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Kaehler method for Flegal curve"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">s&larr; Path new init. <br></span><span class="tab" val="79"></span><span class="small">s add: p1.<br></span><span class="tab" val="79"></span><span class="small">pa&larr; p2-p1. pb&larr; p3-p2.<br></span><span class="tab" val="79"></span><span class="small">k&larr; 5 max: (pa x abs + pa y abs + pb x abs + pb y abs)/20.<br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: k do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"k is a guess how many segments are appropriate"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[s add: (pa*i/k+p1*(k-i)) + (pb*(i-1)/k+p2*(i-1)) / (k-1)]<br></span><span class="tab" val="79"></span><span class="small">s add: p3 .<br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: (s length-1) do⦂ [  self addlinefrom: s◦i to: s◦(i+1) ] <br>]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">addlinefrom: p1 to: p2 |</span><span class="small"> x1 y1 dx dy yinc x0 y0 cdl i<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"for now just add points to the space at alto resolution between p1 and p2<br></span><span class="tab" val="79"></span><span class="small italic">inclusive"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">dx&larr; ( p2 x) - (p1 x).<br></span><span class="tab" val="79"></span><span class="small">dy&larr; ( p2 y) - (p1 y).<br><br></span><span class="tab" val="79"></span><span class="small">[dx &lt; 0 ⇒ [dx &larr; 0-dx. dy &larr; 0-dy. x0&larr; p2 x. y0 &larr; p2 y]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">x0 &larr; p1 x. y0 &larr; p1 y].<br></span><span class="tab" val="79"></span><span class="small">[dy ≥ 0 ⇒ [yinc&larr;1] yinc &larr; 0-1 . dy &larr; 0-dy].<br></span><span class="tab" val="79"></span><span class="small"><br></span><span class="tab" val="79"></span><span class="small"> dx≥dy⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[cdl &larr; ( dx/2).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">for⦂ i from: 0 to: dx do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[self add: (x0⌾y0). cdl &larr; cdl + dy.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">x0 &larr; x0+1. <br> </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">cdl &gt; dx⇒ [cdl &larr; cdl - dx. y0 &larr; y0 + yinc]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br><br></span><span class="tab" val="79"></span><span class="small italic">"y is fastest mover"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">cdl &larr; (dy/2).<br></span><span class="tab" val="79"></span><span class="small">for⦂ i from: 0 to: dy do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[self add: (x0⌾y0) . cdl &larr; cdl+ dx.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">y0 &larr; y0 + yinc.  <br></span><span class="tab" val="79"></span><span class="small"> cdl &gt; dy ⇒ [cdl &larr; cdl - dy. x0&larr; x0+1]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]. <br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>TRANSFORMATIONS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">+ delta </span><span class="small">| i<br></span><span class="tab" val="79"></span><span class="small">[ "add delta to every point in the path"<br></span><span class="tab" val="79"></span><span class="small">⇑ (self copy) translate: delta<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">normalize </span><span class="small">| delta i<br></span><span class="tab" val="79"></span><span class="small">[ "subtract the origin of the path from every point in the path"<br></span><span class="tab" val="79"></span><span class="small">delta &larr; self origin.<br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: self length  do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[ self◦i &larr; self◦i - delta<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">scale: factor </span><span class="small">| i<br></span><span class="tab" val="79"></span><span class="small">[ "scale every point in the path by factor"<br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: self length  do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[ self◦i &larr; self◦i * factor<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">translate: delta </span><span class="small">| i<br></span><span class="tab" val="79"></span><span class="small">[ "add delta to every point in the path"<br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: self length  do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[ self◦i &larr; self◦i + delta<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>MEASURING</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">corner <br></span><span class="tab" val="79"></span><span class="small">["return the corner of the bounding rectangle that includes all the points in the path."<br></span><span class="tab" val="79"></span><span class="small">⇑ (self rectangle) corner<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">extent <br></span><span class="tab" val="79"></span><span class="small">["return the extent of the bounding rectangle that includes all the points in the path."<br></span><span class="tab" val="79"></span><span class="small">⇑ (self rectangle) extent]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">height <br></span><span class="tab" val="79"></span><span class="small">["return the height of the bounding rectangle that includes all the points in the path."<br></span><span class="tab" val="79"></span><span class="small">⇑ self size y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">origin <br></span><span class="tab" val="79"></span><span class="small">["return the origin of the bounding rectangle that includes all the points in the path."<br></span><span class="tab" val="79"></span><span class="small">⇑ (self rectangle) origin<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">rectangle | r  i<br></span><span class="tab" val="79"></span><span class="small">["return the bounding rectangle that includes all the points in the path."<br></span><span class="tab" val="79"></span><span class="small">r &larr; Rectangle new origin: self◦1 extent: 1⌾1.<br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: self length do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[ r &larr; r include: self◦i</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">⇑ r<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">size <br></span><span class="tab" val="79"></span><span class="small">["return the extent of the bounding rectangle that includes all the points in the path."<br></span><span class="tab" val="79"></span><span class="small">⇑ (self rectangle) extent]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">width <br></span><span class="tab" val="79"></span><span class="small">["return the width of the bounding rectangle that includes all the points in the path."<br></span><span class="tab" val="79"></span><span class="small">⇑ self size x]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>SYSTEM</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">copy  | t<br></span><span class="tab" val="79"></span><span class="small">["returns a new instance of Path that is a copy "<br></span><span class="tab" val="79"></span><span class="small">t &larr; Path new init.<br></span><span class="tab" val="79"></span><span class="small">t append: (array◦(1 to: position)) copy.<br></span><span class="tab" val="79"></span><span class="small">⇑ t]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">pressCode </span><span class="small">[⇑6]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">printon: strm </span><span class="small">| t [<br></span><span class="tab" val="79"></span><span class="small">strm append: &rsquo;a Path: &rsquo;.<br></span><span class="tab" val="79"></span><span class="small">array is: String⇒ [strm space append: self]<br></span><span class="tab" val="79"></span><span class="small">for⦂ t from: self do⦂ [strm space print: t]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">SystemOrganization classify: ↪Path under: &rsquo;Form Path Image&rsquo;.</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>"Point"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold">Class new title: &rsquo;Point&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">subclassof: Object<br></span><span class="tab" val="79"></span><span class="medium bold">fields: &rsquo;x y&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">declare: &rsquo;&rsquo;;<br></span><span class="tab" val="79"></span><span class="medium bold">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small italic"><br>I am an x-y pair of numbers usually designating a location on the screen</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">copy <br></span><span class="tab" val="79"></span><span class="small">[⇑ (x⌾y)<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">x: x y: y</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Arithmetic</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">≤ pt </span><span class="small">[⇑ x≤pt x and⦂ y≤pt y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">≥ pt </span><span class="small">[⇑ x≥pt x and⦂ y≥pt y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">* scale<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Return a Point that is the product of me and scale (which is a Point or Number)"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">⇑Point new x: (x * scale asPtX) y: (y * scale asPtY)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">+ delta<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Return a Point that is the sum of me and delta (which is a Point or Number)"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">⇑Point new x: (x + delta asPtX) y: (y + delta asPtY)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">- delta<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Return a Point that is the difference of me and delta (which is a Point or Number)"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">⇑Point new x: (x - delta asPtX) y: (y - delta asPtY)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">/ scale<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Return a Point that is the quotient of me and scale (which is a Point or Number)"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">⇑Point new x: (x / scale asPtX) y: (y / scale asPtY)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">&lt; pt </span><span class="small">[⇑ x&lt;pt x and⦂ y&lt;pt y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">= pt </span><span class="small">[⇑x=pt x and⦂ y=pt y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">&gt; pt </span><span class="small">[⇑x&gt;pt x and⦂ y&gt;pt y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">abs</span><span class="tab" val="79"></span><span class="small italic">"absolute value of a point"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[</span><span class="tab" val="79"></span><span class="small">⇑Point new x: (x abs) y: (y abs)</span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">dist: pt </span><span class="small">| t</span><span class="tab" val="79"></span><span class="small italic">"distance (Manhattan norm) between pt and self"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[t &larr; (pt - self) abs.<br></span><span class="tab" val="79"></span><span class="small">⇑(t x) + (t y)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">length<br></span><span class="tab" val="79"></span><span class="small">[⇑((x asFloat*x asFloat)+(y asFloat*y asFloat)) sqrt]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">max: t<br></span><span class="tab" val="79"></span><span class="small">[⇑Point new x: (x max: t x) y: (y max: t y)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">min: t<br></span><span class="tab" val="79"></span><span class="small">[⇑Point new x: (x min: t x) y: (y min: t y)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">normal </span><span class="small">| n</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"unit vector rotated 90 deg clockwise"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[n&larr; y asFloat neg ⌾ x asFloat.<br></span><span class="tab" val="79"></span><span class="small">⇑n/n length]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">normalize <br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"set selt to zero"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">self x &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">self y &larr; 0.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">translate:  delta<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"increment self by delta"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">x &larr; x + delta x.<br></span><span class="tab" val="79"></span><span class="small">y &larr; y + delta y.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">| grid<br></span><span class="tab" val="79"></span><span class="small">[⇑Point new x: x|grid y: y|grid]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Conversion</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">asPoint<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Return self."</span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">asPtX<br></span><span class="tab" val="79"></span><span class="small">[⇑x]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">asPtY<br></span><span class="tab" val="79"></span><span class="small">[⇑y ]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">asRectangle<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Return a Rectangle with me as both origin and corner."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">⇑self rect: self]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">asRectCorner </span><span class="small italic">"pretend to be a Rectangle for Rectangle +-*/"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">asRectOrigin </span><span class="small italic">"pretend to be a Rectangle for Rectangle +-*/"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">corner<br></span><span class="tab" val="79"></span><span class="small">[⇑ self+ (1⌾1)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">extent<br></span><span class="tab" val="79"></span><span class="small">[⇑ (1⌾1)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">extent: p</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"infix creation of rectangles"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[⇑Rectangle new origin: self extent: p]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">height<br></span><span class="tab" val="79"></span><span class="small">[⇑ 1]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">origin<br></span><span class="tab" val="79"></span><span class="small">[⇑ self]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">printon: strm <br></span><span class="tab" val="79"></span><span class="small">[strm print: x; append: &rsquo;⌾&rsquo;; print: y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">rect: p</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"infix creation of rectangles"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[⇑Rectangle new origin: self corner: p]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">width<br></span><span class="tab" val="79"></span><span class="small">[⇑ 1]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Access to parts</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">hash </span><span class="small">[⇑(x lshift: 2) lxor: y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">theta </span><span class="small">| tan theta "return the angle the point makes with origin.  right is 0; down is 90."<br></span><span class="tab" val="79"></span><span class="small">[x=0 ⇒ [y≥0 ⇒ [⇑ 90.0] ⇑ 270.0].<br><br></span><span class="tab" val="79"></span><span class="small"> tan &larr; y asFloat/x asFloat.<br></span><span class="tab" val="79"></span><span class="small"> theta &larr; tan arctan.<br><br></span><span class="tab" val="79"></span><span class="small"> x≥0 ⇒ [y≥0 ⇒[⇑ theta] ⇑360.0 + theta].<br></span><span class="tab" val="79"></span><span class="small"> ⇑ 180.0 + theta]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">x</span><span class="tab" val="79"></span><span class="small bold"> </span><span class="small">[⇑x]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">x &larr; x</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">y </span><span class="small">[⇑y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">y &larr; y</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>SYSTEM</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">fromPress: press value: s<br></span><span class="tab" val="79"></span><span class="small">[ x &larr; s nextword. y &larr; s nextword]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">hideData: complete </span><span class="small">| s<br></span><span class="tab" val="79"></span><span class="small">[Stream new of: (s &larr; String new: 4); nextPoint&larr; self.<br></span><span class="tab" val="79"></span><span class="small">⇑ s]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">hidePress: press complete: c<br></span><span class="tab" val="79"></span><span class="small">[press skipcode: self pressCode data: (self hideData: c)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">pressCode </span><span class="small">[⇑7]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">SystemOrganization classify: ↪Point under: &rsquo;Form Path Image&rsquo;.</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>"Rectangle"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold">Class new title: &rsquo;Rectangle&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">subclassof: Object<br></span><span class="tab" val="79"></span><span class="medium bold">fields: &rsquo;origin corner&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">declare: &rsquo;&rsquo;;<br></span><span class="tab" val="79"></span><span class="medium bold">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small italic"><br>I am a pair of points, usually representing a rectangular area on the screen</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">copy  <br></span><span class="tab" val="79"></span><span class="small">["new rectangle"<br></span><span class="tab" val="79"></span><span class="small">⇑ (origin copy) rect: (corner copy)<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">fromuser </span><span class="small">| t<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Show the origin cursor until the user presses a mouse button,<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">then get my origin"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">origin&larr;OriginCursor showwhile⦂ [user waitbug].<br></span><span class="tab" val="79"></span><span class="small italic">"Show the corner cursor and complement me until the user presses<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">a button again.  The loop is arranged so <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">that complementing stays on for a little while."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">t&larr;origin.<br></span><span class="tab" val="79"></span><span class="small">CornerCursor showwhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[while⦂ [corner&larr;t.  t &larr; user mpnext] do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[self comp.  t &larr; t max: origin.  self comp]]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">fromuserevenword </span><span class="small">| t<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Show the origin cursor until the user presses a mouse button,<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">then get my origin"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">origin&larr;OriginCursor showwhile⦂ [user waitbug].<br></span><span class="tab" val="79"></span><span class="small italic">"Show the corner cursor and complement me until the user presses<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">a button again.  The loop is arranged so <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">that complementing stays on for a little while."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">t&larr;origin.<br></span><span class="tab" val="79"></span><span class="small">CornerCursor showwhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[while⦂ [corner &larr; t.  t &larr; user mpnext] do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[self comp.  t &larr; (((t x) + 15 | 16) ⌾ t y) max: origin.  self comp]].<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">origin: origin corner: corner</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">origin: origin extent: extent<br></span><span class="tab" val="79"></span><span class="small">[corner &larr; origin+extent]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Aspects</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">area </span><span class="small">[⇑(self width)*(self height)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">bottom </span><span class="small">[⇑corner y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">corner </span><span class="small">[⇑corner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">corners </span><span class="small">| v<br></span><span class="tab" val="79"></span><span class="small">[v&larr; Vector new: 4.<br></span><span class="tab" val="79"></span><span class="small">v◦1&larr; origin. v◦2&larr; corner x⌾ origin y.<br></span><span class="tab" val="79"></span><span class="small">v◦3&larr; corner. v◦4&larr; origin x⌾corner y.<br></span><span class="tab" val="79"></span><span class="small">⇑v]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">corner &larr; corner</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">edge: side </span><span class="small">"</span><span class="small italic">Returns one side as a number.</span><span class="small">"<br></span><span class="tab" val="79"></span><span class="small">"</span><span class="small italic">Sides are numbered 0-3.  +1 goes counterclockwise.  lxor: 2 gets opposite side.</span><span class="small">"<br></span><span class="tab" val="79"></span><span class="small">[side<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=0⇒["top" ⇑origin y];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=1⇒["left" ⇑origin x];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=2⇒["bottom" ⇑corner y];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=3⇒["right" ⇑corner x].<br></span><span class="tab" val="79"></span><span class="small">user notify: &rsquo;Invalid side&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">extent<br></span><span class="tab" val="79"></span><span class="small">[⇑corner-origin]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">extent &larr; extent<br></span><span class="tab" val="79"></span><span class="small">[corner &larr; origin+extent. ⇑extent]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">hash </span><span class="small">[⇑(origin lshift: 1) lxor: corner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">height<br></span><span class="tab" val="79"></span><span class="small">[⇑corner y - origin y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">height &larr; h </span><span class="small italic">"change my bottom y to make my height h"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[corner y &larr; origin y + h]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">leftside </span><span class="small">[⇑origin x]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">maxX </span><span class="small">[⇑corner x]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">maxY </span><span class="small">[⇑corner y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">minX </span><span class="small">[⇑origin x]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">minY </span><span class="small">[⇑origin y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">origin </span><span class="small">[⇑origin]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">origin &larr; origin</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">rightside </span><span class="small">[⇑corner x]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">side: side </span><span class="small italic">"Returns one side as a rectangle."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small italic">"Sides are numbered 0-3.  +1 goes counterclockwise.  Xor: 2 gets opposite side."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[side<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=0⇒[</span><span class="small italic">"top"</span><span class="small"> ⇑origin rect: corner x⌾origin y];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=1⇒[</span><span class="small italic">"left"</span><span class="small"> ⇑origin rect: origin x⌾corner y];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=2⇒[</span><span class="small italic">"bottom"</span><span class="small"> ⇑origin x⌾corner y rect: corner];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=3⇒[</span><span class="small italic">"right"</span><span class="small"> ⇑corner x⌾origin y rect: corner].<br></span><span class="tab" val="79"></span><span class="small">user notify: &rsquo;Invalid side&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">size<br></span><span class="tab" val="79"></span><span class="small">[⇑corner-origin]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">top </span><span class="small">[⇑origin y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">width<br></span><span class="tab" val="79"></span><span class="small">[⇑corner x - origin x]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">width &larr; w </span><span class="small italic">"change my right x to make my width w"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[corner x &larr; origin x + w]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">withEdge: side at: coord </span><span class="small">"Returns a rectangle with one side moved."<br></span><span class="tab" val="79"></span><span class="small">[side<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=0⇒ [⇑origin x⌾coord rect: corner];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=1⇒ [⇑coord⌾origin y rect: corner];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=2⇒ [⇑origin rect: corner x⌾coord];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=3⇒ [⇑origin rect: coord⌾corner y].<br></span><span class="tab" val="79"></span><span class="small">user notify: &rsquo;Invalid side&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">withSide: side at: pt </span><span class="small italic">"Returns a rectangle with one side moved."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[side<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=0⇒ [⇑origin x⌾pt y rect: corner];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=1⇒ [⇑pt x⌾origin y rect: corner];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=2⇒ [⇑origin rect: corner x⌾pt y];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=3⇒ [⇑origin rect: pt x⌾corner y].<br></span><span class="tab" val="79"></span><span class="small">user notify: &rsquo;Invalid side&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Arithmetic</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">* scale </span><span class="small">[<br></span><span class="small italic">"Return a Rectangle which is the product of me and scale (which is a Rectangle, Point, or Number)"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">⇑Rectangle new origin: origin * scale asRectOrigin corner: corner * scale asRectCorner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">+ delta </span><span class="small">[<br>"</span><span class="small italic">Return a Rectangle which is the sum of me and delta (which is a Rectangle, Point, or Number)"<br></span><span class="tab" val="79"></span><span class="small">⇑Rectangle new origin: origin + delta asRectOrigin corner: corner + delta asRectCorner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">- delta </span><span class="small">[<br></span><span class="small italic">"Return a Rectangle which is the difference of me and delta (which is a Rectangle, Point, or Number)"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">⇑Rectangle new origin: origin - delta asRectOrigin corner: corner - delta asRectCorner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">/ scale </span><span class="small">[<br></span><span class="small italic">"Return a Rectangle which is the quotient of me and scale (which is a Rectangle, Point, or Number)"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">⇑Rectangle new origin: origin / scale asRectOrigin corner: corner / scale asRectCorner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">= r<br></span><span class="tab" val="79"></span><span class="small">[⇑origin = r origin and: corner = r corner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">center<br></span><span class="tab" val="79"></span><span class="small">[⇑origin+corner/2]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">empty<br></span><span class="tab" val="79"></span><span class="small">[⇑(origin &lt; corner)≡false]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">has: pt </span><span class="small">[⇑origin ≤ pt and⦂ pt &lt; corner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">include: r </span><span class="small italic">"Returns the merge with an adjacent rectangle."</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[⇑(origin min: r origin) rect: (corner max: r corner)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">inset: p1<br></span><span class="tab" val="79"></span><span class="small">[⇑origin+p1 rect: corner-p1]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">inset: p1 and: p2<br></span><span class="tab" val="79"></span><span class="small">[⇑origin+p1 rect: corner-p2]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">intersect: r </span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">⇑Rectangle new origin: (origin max: r origin)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">corner: (corner min: r corner)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">intersects: r<br></span><span class="tab" val="79"></span><span class="small">[⇑(origin max: r origin) &lt; (corner min: r corner)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">isWithin: rect</span><span class="small bold italic">  </span><span class="small italic">"am I equal to or contained within rect"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[⇑origin ≥ rect origin and⦂ corner ≤ rect corner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">max: rect<br></span><span class="tab" val="79"></span><span class="small">[⇑Rectangle new<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">origin: (origin min: rect origin)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">corner: (corner max: rect corner)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">minus: r </span><span class="small">| s yorg ycor</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"return Vector of Rectangles comprising<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">the part of me not intersecting r "</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Make sure the intersection is non-empty"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[origin≤r corner and⦂ r origin≤corner⇒ [] ⇑self inVector].<br></span><span class="tab" val="79"></span><span class="small">s &larr; (Vector new: 4) asStream.<br></span><span class="tab" val="79"></span><span class="small">[r origin y&gt;origin y⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[s next &larr; origin rect: corner x⌾(yorg &larr; r origin y)]<br></span><span class="tab" val="79"></span><span class="small"> yorg &larr; origin y].<br></span><span class="tab" val="79"></span><span class="small">[r corner y&lt;corner y⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[s next &larr; origin x⌾(ycor &larr; r corner y) rect: corner]<br></span><span class="tab" val="79"></span><span class="small"> ycor &larr; corner y].<br></span><span class="tab" val="79"></span><span class="small">[r origin x&gt;origin x⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[s next &larr; origin x⌾yorg rect: r origin x⌾ycor]].<br></span><span class="tab" val="79"></span><span class="small">[r corner x&lt;corner x⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[s next &larr; r corner x⌾yorg rect: corner x⌾ycor]].<br></span><span class="tab" val="79"></span><span class="small">⇑s contents]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">nearest: pt<br></span><span class="tab" val="79"></span><span class="small">[⇑((origin x max: pt x) min: corner x) ⌾<br></span><span class="tab" val="79"></span><span class="small">((origin y max: pt y) min: corner y)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">side: side distanceTo: pt<br></span><span class="tab" val="79"></span><span class="small">[side<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=0⇒ [⇑pt y-origin y];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=1⇒ [⇑pt x-origin x];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=2⇒ [⇑corner y-pt y];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=3⇒ [⇑corner x-pt x].<br></span><span class="tab" val="79"></span><span class="small">user notify: &rsquo;Invalid side&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">sideNearest: pt </span><span class="small">| d dmin i imin<br></span><span class="tab" val="79"></span><span class="small">[dmin &larr; 077777.<br></span><span class="tab" val="79"></span><span class="small">for⦂ i from: (0 to: 3) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[dmin&gt;(d &larr; self side: i distanceTo: pt) abs⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[dmin &larr; d.  imin &larr; i]].<br></span><span class="tab" val="79"></span><span class="small">⇑imin]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Altering</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">dragto: dest </span><span class="small">| v i<br></span><span class="tab" val="79"></span><span class="small">[self blt: dest mode: storing.<br></span><span class="tab" val="79"></span><span class="small">v &larr; dest rect: dest+self extent.<br></span><span class="tab" val="79"></span><span class="small">for⦂ i from: (self minus: v) do⦂ [i clear].<br></span><span class="tab" val="79"></span><span class="small">origin &larr; dest. corner &larr; v corner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">growby: pt<br></span><span class="tab" val="79"></span><span class="small">[corner &larr; corner + pt]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">growto: corner </span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">maxstretch: bound </span><span class="small">| bx by boundr selfr<br></span><span class="tab" val="79"></span><span class="small">[bx&larr;(bound corner-origin) x. by&larr;(bound corner-origin) y.<br></span><span class="tab" val="79"></span><span class="small">boundr&larr;bx asFloat/by. selfr&larr;self width asFloat/self height.<br></span><span class="tab" val="79"></span><span class="small">selfr&gt;boundr⇒[self extent&larr;(bx⌾(bx asFloat/selfr) asInteger)]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">self extent&larr;((by asFloat*selfr) asInteger⌾by)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">moveby: pt<br></span><span class="tab" val="79"></span><span class="small">[origin &larr; origin+pt. corner &larr; corner+pt]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">moveto: pt<br></span><span class="tab" val="79"></span><span class="small">[corner &larr; corner+pt-origin. origin&larr;pt]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">translate: pt<br></span><span class="tab" val="79"></span><span class="small">[origin &larr; origin+pt. corner &larr; corner+pt]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">translateto: pt <br></span><span class="tab" val="79"></span><span class="small">[self translate:  pt - origin. ]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">usermove <br></span><span class="tab" val="79"></span><span class="small">[self usermove: user screenrect]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">usermove: bound </span><span class="small">| m lim<br></span><span class="tab" val="79"></span><span class="small">[lim&larr;bound corner-self extent. self bordercomp. m&larr;user mp.<br></span><span class="tab" val="79"></span><span class="small">while⦂ true do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[[user redbug⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[self bordercomp; moveto: (bound origin max: ((m&larr;user mp) min: lim)); bordercomp]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">while⦂ (user anybug and⦂ m=user mp) do⦂ [].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[user bluebug⇒[user waitnobug. ⇑self bordercomp]]]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">usersize <br></span><span class="tab" val="79"></span><span class="small">[self usersize: user screenrect]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">usersize: bound </span><span class="small">| m lim<br></span><span class="tab" val="79"></span><span class="small">[[self origin≡nil⇒[origin&larr;user mp. self extent&larr;16]].<br></span><span class="tab" val="79"></span><span class="small">self bordercomp. m&larr;user mp.<br></span><span class="tab" val="79"></span><span class="small">while⦂ true do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[lim&larr;bound corner-self extent.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[user redbug⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[self bordercomp; moveto: (bound origin max: ((m&larr;user mp) min: lim)); bordercomp]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[user yellowbug⇒[self bordercomp.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">corner&larr;m&larr;(user mp min: bound corner) max: origin. self bordercomp]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">while⦂ (user anybug and⦂ m=user mp) do⦂ [].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[user bluebug⇒[user waitnobug. ⇑self bordercomp]]]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Conversion</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">asRectangle<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Return self."</span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">asRectCorner<br></span><span class="tab" val="79"></span><span class="small">[⇑corner ]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">asRectOrigin<br></span><span class="tab" val="79"></span><span class="small">[⇑origin ]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">bitsFromStream: strm </span><span class="small">| rec s [<br></span><span class="tab" val="79"></span><span class="small">rec &larr; origin rect: origin + (self width ⌾ (16 min: self height)).<br></span><span class="tab" val="79"></span><span class="small">s&larr; String new: rec bitStringLength.<br></span><span class="tab" val="79"></span><span class="small">while⦂ rec maxY ≤ corner y do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[strm into: s.  rec bitsFromString: s; moveby: 0⌾16].<br></span><span class="tab" val="79"></span><span class="small">rec minY &lt; corner y⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[rec corner y&larr; corner y.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">s&larr; nil. s&larr; String new: rec bitStringLength.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">strm into: s.  rec bitsFromString: s]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">bitsFromString: str<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"default stores bits onto display"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">self bitsFromString: str mode: storing]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">bitsFromString: str mode: mode </span><span class="small">[user croak] primitive: 52</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">bitsFromString: str mode: mode clippedBy: clipRect<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">| destRect <br></span><span class="tab" val="79"></span><span class="small">["</span><span class="small italic">Load the screen bits within my area from those stored in </span><span class="small italic underline">str</span><span class="small italic">.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">If </span><span class="small italic underline">clipRect</span><span class="small italic"> is not nil, then load only those bits within both<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">myself and </span><span class="small italic underline">clipRect</span><span class="small">"<br></span><span class="tab" val="79"></span><span class="small">self bitStringLength≠str length⇒[user notify: &rsquo;wrong bit string length&rsquo;]<br></span><span class="tab" val="79"></span><span class="small">destRect&larr;self intersect: user screenrect.<br></span><span class="tab" val="79"></span><span class="small">[nil≡clipRect⇒[] destRect&larr;destRect intersect: clipRect].<br></span><span class="tab" val="79"></span><span class="small">BitBlt init destbase&larr;mem◦066;<br></span><span class="tab" val="79"></span><span class="small">destraster&larr;user screenrect width/16|2;<br></span><span class="tab" val="79"></span><span class="small">dest&larr;destRect origin;<br></span><span class="tab" val="79"></span><span class="small">extent&larr;destRect extent;<br></span><span class="tab" val="79"></span><span class="small">sourceraster&larr;corner x-origin x+15/16;<br></span><span class="tab" val="79"></span><span class="small">source&larr;destRect origin-origin;<br></span><span class="tab" val="79"></span><span class="small">sourcebase &larr; str ; copy: mode]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">bitsIntoString </span><span class="small">| str [<br></span><span class="tab" val="79"></span><span class="small">str &larr; String new: self bitStringLength.<br></span><span class="tab" val="79"></span><span class="small">self  bitsIntoString: str mode: storing.<br></span><span class="tab" val="79"></span><span class="small">⇑str]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">bitsIntoString: str<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"default stores bits into the string"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">self bitsIntoString: str mode: storing]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">bitsIntoString: str mode: mode </span><span class="small">[user croak] primitive: 51</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">bitsIntoString: str mode: mode clippedBy: clipRect<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">| sourceRect <br></span><span class="tab" val="79"></span><span class="small">["</span><span class="small italic">Store the screen bits within my area into </span><span class="small italic underline">str</span><span class="small italic">.  If </span><span class="small italic underline">clipRect</span><span class="small italic"> is not nil,<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">then store only those bits within both myself and </span><span class="small italic underline">clipRect</span><span class="small italic">,<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">leaving alone the other bits in </span><span class="small italic underline">str</span><span class="small">"<br></span><span class="tab" val="79"></span><span class="small">self bitStringLength≠str length⇒[user notify: &rsquo;wrong bit string length&rsquo;]<br></span><span class="tab" val="79"></span><span class="small">sourceRect&larr;self intersect: user screenrect.<br></span><span class="tab" val="79"></span><span class="small">[clipRect≡nil⇒[] sourceRect&larr;sourceRect intersect: clipRect].<br></span><span class="tab" val="79"></span><span class="small">BitBlt init destraster&larr;corner x-origin x+15/16;<br></span><span class="tab" val="79"></span><span class="small">dest&larr;sourceRect origin-origin;<br></span><span class="tab" val="79"></span><span class="small">extent&larr;sourceRect extent;<br></span><span class="tab" val="79"></span><span class="small">sourcebase&larr;mem◦066;<br></span><span class="tab" val="79"></span><span class="small">sourceraster&larr;user screenrect width/16|2;<br></span><span class="tab" val="79"></span><span class="small">source&larr;sourceRect origin;<br></span><span class="tab" val="79"></span><span class="small">destbase &larr; str ; copy: mode]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">bitsOntoStream: strm </span><span class="small">| rec s [<br></span><span class="tab" val="79"></span><span class="small">rec &larr; origin rect: origin + (self width ⌾ (16 min: self height)).<br></span><span class="tab" val="79"></span><span class="small">s&larr; (String new: rec bitStringLength) all&larr;0.<br></span><span class="tab" val="79"></span><span class="small">while⦂ rec maxY ≤ corner y do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[rec bitsIntoString: s; moveby: 0⌾16.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">strm append: s].<br></span><span class="tab" val="79"></span><span class="small">rec minY &lt; corner y⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[rec bitsIntoString: s.  strm append:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">s◦(1 to: s length/rec height*(corner y-rec minY))]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">bitStringLength </span><span class="small">| extent [<br></span><span class="tab" val="79"></span><span class="small">extent &larr; corner - origin.<br></span><span class="tab" val="79"></span><span class="small">⇑ 2 * extent y* (extent x +15/16)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">hardcopy: pf </span><span class="small">[self hardcopy: pf thickness: 2]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">hardcopy: pf thickness: th </span><span class="small">| r [<br></span><span class="tab" val="79"></span><span class="small">for⦂ r from: ((self inset: 0-th) minus: self) do⦂ [pf showrect: r color: 0]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">printon: strm <br></span><span class="tab" val="79"></span><span class="small">[strm print: origin; append: &rsquo; rect: &rsquo;; print: corner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Image</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">blowup: at by: scale </span><span class="small">| z dest<br></span><span class="tab" val="79"></span><span class="small">[dest &larr; Rectangle new origin: at extent: self extent*scale.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[(dest has: origin) or: (dest has: corner) ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[z &larr; self bitsIntoString. dest outline.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">self moveto: dest origin. self bitsFromString: z]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">dest outline].<br></span><span class="tab" val="79"></span><span class="small">self blowup: at by: scale spacing: 1]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">blowup: at by: scale spacing: spacing<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">| extent z inc sinc slice width height dest i j spread<br></span><span class="tab" val="79"></span><span class="small">[extent &larr; self extent.<br></span><span class="tab" val="79"></span><span class="small">scale &larr; scale asPoint.  spacing &larr; spacing asPoint.<br></span><span class="tab" val="79"></span><span class="small">dest &larr; Rectangle new origin: at extent: extent*scale.<br></span><span class="tab" val="79"></span><span class="small">z &larr; 1⌾0. width &larr; extent x. height &larr;  0⌾extent y.<br></span><span class="tab" val="79"></span><span class="small">spread &larr; (scale-spacing) x.<br></span><span class="tab" val="79"></span><span class="small">for⦂ i to: 2 do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"first do horiz, then vert"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[inc &larr; z * ¬1. sinc &larr; z * scale.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">slice &larr; Rectangle new<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">origin: (z * width) + [i = 1 ⇒[self origin] at]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">extent: z + height.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">dest &larr; at + (z * (scale * width)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">for⦂ j to: width do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"slice it up"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[dest &larr; dest - sinc.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">slice moveby: inc.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">slice blt: dest mode: storing]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">slice &larr; Rectangle new origin: at + z<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">extent: height+(z*(scale-1)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">for⦂ j to: width do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"clear slice source"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[slice clear: white. slice moveby: sinc]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">slice &larr; Rectangle new origin: at<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">extent: height + (z * ((scale*width)-1)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">for⦂ j to: spread - 1 do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"spread it out"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[slice blt: at + z mode: oring]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">z &larr; 0⌾1.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"flip to do vertical"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">width &larr; extent y. height &larr; (scale*extent) x⌾0.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">spread &larr; (scale-spacing) y]<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">blt: dest mode: mode </span><span class="small">[user croak] primitive: 47</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">blt: dest mode: mode clippedBy: clipRect<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">| destRect clippedSource<br></span><span class="tab" val="79"></span><span class="small">["</span><span class="small italic">Copy the screen bits within my area to the rectangle whose<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">origin is </span><span class="small italic underline">dest</span><span class="small italic"> and whose extent is the same as mine.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">If </span><span class="small italic underline">clipRect</span><span class="small italic"> is not nil, then copy only those bits within both<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">the destination rectangle and </span><span class="small italic underline">clipRect</span><span class="small">"<br></span><span class="tab" val="79"></span><span class="small">destRect&larr;(Rectangle new origin: dest extent: self extent)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">intersect: user screenrect.<br></span><span class="tab" val="79"></span><span class="small">[nil≡clipRect⇒[] destRect&larr;destRect intersect: clipRect].<br></span><span class="tab" val="79"></span><span class="small">"</span><span class="small italic">find the source for the bits after clipping</span><span class="small">"<br></span><span class="tab" val="79"></span><span class="small">clippedSource&larr;origin+destRect origin-dest.<br></span><span class="tab" val="79"></span><span class="small">BitBlt init<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">destbase&larr;mem◦066;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">destraster&larr;user screenrect width/16|2;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">dest&larr;destRect origin;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">extent&larr;destRect extent;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">sourcebase&larr;mem◦066;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">sourceraster&larr;user screenrect width/16|2;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">source&larr;clippedSource;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">copy: mode]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">bltcomp: dest mode: mode </span><span class="small">[user croak] primitive: 48</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">brush: dest mode: mode color: color </span><span class="small">[user croak] primitive: 49</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">brush: dest mode: mode color: color clippedBy: clipRect<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">| destRect clippedSource<br></span><span class="tab" val="79"></span><span class="small">["</span><span class="small italic">Brush the screen bits within my area to the rectangle whose<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">origin is </span><span class="small italic underline">dest</span><span class="small italic"> and whose extent is the same as mine.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">If </span><span class="small italic underline">clipRect</span><span class="small italic"> is not nil, then brush only those bits within both<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">the destination rectangle and </span><span class="small italic underline">clipRect</span><span class="small">"<br></span><span class="tab" val="79"></span><span class="small">destRect&larr;(Rectangle new origin: dest extent: self extent)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">intersect: user screenrect.<br></span><span class="tab" val="79"></span><span class="small">[nil≡clipRect⇒[] destRect&larr;destRect intersect: clipRect].<br></span><span class="tab" val="79"></span><span class="small">"</span><span class="small italic">find the source for the bits after clipping</span><span class="small">"<br></span><span class="tab" val="79"></span><span class="small">clippedSource&larr;origin+destRect origin-dest.<br></span><span class="tab" val="79"></span><span class="small">BitBlt init<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">color&larr;color;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">destbase&larr;mem◦066;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">destraster&larr;user screenrect width/16|2;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">dest&larr;destRect origin;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">extent&larr;destRect extent;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">sourcebase&larr;mem◦066;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">sourceraster&larr;user screenrect width/16|2;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">source&larr;clippedSource;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">paint: mode]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">clear</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">"default is backround"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[self color: background mode: storing]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">clear: color<br></span><span class="tab" val="79"></span><span class="small">[self color: color mode: storing]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">color: color mode: mode </span><span class="small">[user croak] primitive: 50</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">comp<br></span><span class="tab" val="79"></span><span class="small">[self color: black mode: xoring]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">comp: color<br></span><span class="tab" val="79"></span><span class="small">[self color: color mode: xoring]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">fillin: color mode: mode </span><span class="small">| T bits p s dirs i which</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"Rectangle new fromuser fillin: gray"<br></span><span class="tab" val="79"></span><span class="small">[T &larr; Turtle init.<br></span><span class="tab" val="79"></span><span class="small">p&larr; origin + (self width⌾0).<br></span><span class="tab" val="79"></span><span class="small">s&larr; Rectangle new origin: p extent: self extent.<br></span><span class="tab" val="79"></span><span class="small">dirs&larr;((1⌾0), (¬1⌾0), (0⌾1), (0⌾¬1)).<br></span><span class="tab" val="79"></span><span class="small">bits&larr; s bitsIntoString.<br></span><span class="tab" val="79"></span><span class="small">self blt: p mode: storing.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"s &larr; self"<br></span><span class="tab" val="79"></span><span class="small">user waitbug. T place: user mp; pendn.<br></span><span class="tab" val="79"></span><span class="small">while⦂ user anybug do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"draw seed in self"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[T goto: user mp].<br></span><span class="tab" val="79"></span><span class="small">self blt: p mode: xoring.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"s &larr; seed only"<br></span><span class="tab" val="79"></span><span class="small">s blt: origin mode: xoring.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"take seed out of self"<br></span><span class="tab" val="79"></span><span class="small">user waitbug.<br></span><span class="tab" val="79"></span><span class="small">while⦂ user anybug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[for⦂ which from: 0 to: 2 by: 2 do⦂ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">for⦂ i to: 2 do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[s blt: dirs◦(which+i)+p mode: oring]</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"smear seed around"<br> </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">self blt: p mode: erasing]]</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"then clip to outline"<br></span><span class="tab" val="79"></span><span class="small">s brush: origin mode: mode color: color.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"paint it in"<br></span><span class="tab" val="79"></span><span class="small">s bitsFromString: bits]</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"restore background to s"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">flash </span><span class="small">[self comp; comp]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">reverse<br></span><span class="tab" val="79"></span><span class="small">[self color: black mode: xoring]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">rotate</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"(0⌾0 rect: 128⌾128) rotate."<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">| size maskr spt mpt tpt data temp atab btab i unit<br></span><span class="tab" val="79"></span><span class="small">[size &larr; self extent x. spt &larr; size⌾size.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"size must be a power of 2"<br></span><span class="tab" val="79"></span><span class="small">data &larr; Rectangle new origin: origin extent: spt.<br></span><span class="tab" val="79"></span><span class="small">maskr &larr; Rectangle new origin: (mpt&larr; origin + (0⌾size)) extent: spt.<br></span><span class="tab" val="79"></span><span class="small">temp &larr; Rectangle new origin: (tpt&larr; mpt + (size⌾0)) extent: spt.<br></span><span class="tab" val="79"></span><span class="small">atab &larr; (0⌾0),(1⌾0),(0⌾0),(0⌾1),(1⌾1),(0⌾1),(1⌾0),(¬1⌾0),(1⌾0).<br></span><span class="tab" val="79"></span><span class="small">btab &larr; (0⌾0),(1⌾1),(0⌾0),(1⌾1),(¬1⌾¬1),(1⌾1).<br></span><span class="tab" val="79"></span><span class="small">unit &larr; size/2.<br></span><span class="tab" val="79"></span><span class="small">maskr clear: white.<br></span><span class="tab" val="79"></span><span class="small">(Rectangle new origin: mpt extent: unit⌾unit) clear: black.<br></span><span class="tab" val="79"></span><span class="small">until⦂ unit&lt;1 do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[for⦂ i to: 3 do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"flip left and right halves"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[temp clear: white.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">maskr blt: atab◦i*unit + tpt mode: storing.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">maskr blt: atab◦(3+i)*unit + tpt mode: oring.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">data bltcomp: tpt mode: erasing.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">temp blt: atab◦(6+i)*unit + origin mode: xoring].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">for⦂ i to: 3 do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"flip diagonals"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[temp clear: white.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">maskr blt: btab◦i*unit + tpt mode: storing.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">data bltcomp: tpt mode: erasing.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">temp blt: btab◦(3+i)*unit + origin mode: xoring].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">(unit&larr; unit/2)&lt;1⇒[]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">maskr blt: (0⌾unit)+mpt mode: erasing.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">maskr blt: (unit⌾0)+mpt mode: erasing.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">maskr blt: (unit*2⌾0)+mpt mode: oring.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">maskr blt: (0⌾(2*unit))+mpt mode: oring]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>Border</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">border: thick color: color</span><span class="tab" val="79"></span><span class="small italic">"paints a border withoud disturbing interior"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[(Rectangle new<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">origin: origin-(thick⌾thick) corner: (corner x+thick)⌾origin y)<br></span><span class="tab" val="79"></span><span class="small">clear: color;<br></span><span class="tab" val="79"></span><span class="small">moveto: (origin x-thick)⌾corner y; clear: color;<br></span><span class="tab" val="79"></span><span class="small">origin &larr; corner x⌾(origin y-thick); clear: color;<br></span><span class="tab" val="79"></span><span class="small">moveto: origin-(thick⌾thick); clear: color]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">boxcomp</span><span class="tab" val="79"></span><span class="small italic">"paints a border withoud disturbing interior"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[(Rectangle new<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">origin: origin-(2⌾2) corner: (corner x+2)⌾origin y)<br></span><span class="tab" val="79"></span><span class="small">color: black mode: xoring;<br></span><span class="tab" val="79"></span><span class="small">moveto: (origin x-2)⌾corner y; color: black mode: xoring;<br></span><span class="tab" val="79"></span><span class="small">origin &larr; corner x⌾(origin y-2); color: black mode: xoring;<br></span><span class="tab" val="79"></span><span class="small">moveto: origin-(2⌾2); color: black mode: xoring]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">outline </span><span class="tab" val="79"></span><span class="small italic">"default border is two thick"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">[self outline: 2]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">outline: thick </span><span class="small">| t<br></span><span class="tab" val="79"></span><span class="small">[t &larr; (¬1⌾¬1)*thick.<br></span><span class="tab" val="79"></span><span class="small">(self inset: t) clear: black.  self clear: white]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">SystemOrganization classify: ↪Rectangle under: &rsquo;Form Path Image&rsquo;.</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>"TextImage"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold">Class new title: &rsquo;TextImage&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">subclassof: Textframe<br></span><span class="tab" val="79"></span><span class="medium bold">fields: &rsquo;c1 c2 begintypein superimage figure ground&rsquo;<br></span><span class="tab" val="79"></span><span class="medium bold">declare: &rsquo;cut esc paste aurora Scrap scrap bs Deletion aurorarunning paragraphmenu ctlw &rsquo;;<br></span><span class="tab" val="79"></span><span class="medium bold">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small italic"><br>This class has not yet been commented</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>INIT</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">classInit <br></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">bs &larr; 8. ctlw &larr; 145. esc &larr; 160. cut &larr; 173. paste &larr; 158.<br></span><span class="tab" val="79"></span><span class="small">Scrap &larr; Deletion &larr; nullString.<br></span><span class="tab" val="79"></span><span class="small">paragraphmenu &larr; Menu new string:<br>&rsquo;resize<br>fit<br>cut<br>paste<br>copy<br>align<br>figure<br>ground<br>&rsquo;.<br></span><span class="tab" val="79"></span><span class="small">aurora &larr; "Aurora new" nil.<br></span><span class="tab" val="79"></span><span class="small">aurorarunning &larr; false.<br>]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">close<br></span><span class="tab" val="79"></span><span class="small">[superimage&larr;nil]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">paragraph: para frame: frame style: style<br></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">self paragraph: para frame: frame style: style figure: 1 ground: 0<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">paragraph: para frame: frame style: style figure: figure ground: ground<br></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">[nil≡ para ⇒ [ para &larr; nullString ]].<br></span><span class="tab" val="79"></span><span class="small">c1 &larr; c2 &larr; begintypein&larr; 1.<br></span><span class="tab" val="79"></span><span class="small">self para: para frame: frame style: style<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">text: t width: w | run r<br></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">c1 &larr; c2 &larr; begintypein&larr; 1.<br></span><span class="tab" val="79"></span><span class="small">run &larr; String new: 2. run word: 1 &larr;  16 * 7 + 0177400.<br></span><span class="tab" val="79"></span><span class="small">r &larr; Rectangle new origin: 0⌾0 extent: w⌾(DefaultTextStyle lineheight+2).<br></span><span class="tab" val="79"></span><span class="small">self paragraph: (Paragraph new text: t runs: run  alignment: 2) frame: r style: DefaultTextStyle.<br><br> ]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>EDITING</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">align<br></span><span class="tab" val="79"></span><span class="small">[para alignment &larr; ↪(1 2 4 0 0)◦(1+para alignment).<br></span><span class="tab" val="79"></span><span class="small">self show.<br></span><span class="tab" val="79"></span><span class="small">self reversefrom: c1 to: c2.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">checklooks </span><span class="small">| t val mask [<br></span><span class="tab" val="79"></span><span class="small">"see ParagraphEditor checklooks.<br></span><span class="tab" val="79"></span><span class="small">substitute c1 for loc1, c2 for loc2, oldEntity for oldpara, entity for para"<br></span><span class="tab" val="79"></span><span class="small">t &larr; ↪(166 150 137 151   230 214 201 215<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">135 159 144 143 128 127 129 131 180 149<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">199 223 208 207 192 191 240 226) find: user kbck.<br></span><span class="tab" val="79"></span><span class="small">t=0⇒[⇑false]<br></span><span class="tab" val="79"></span><span class="small">user kbd.<br></span><span class="tab" val="79"></span><span class="small">t=25⇒[self toBravo]; "ctl-T" <br></span><span class="tab" val="79"></span><span class="small"> =26⇒[self fromBravo]. "ctl-F" <br><br></span><span class="tab" val="79"></span><span class="small">"[oldEntity⇒[] oldEntity &larr; entity recopy]."<br></span><span class="tab" val="79"></span><span class="small">val &larr; ↪(1 2 4 256   ¬1 ¬2 ¬4 256  "ctl-b i - x   B I ¬ X"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">0 16 32 48 64 80 96 112 128 144  "ctl-0 1 ... 9"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">160 176 192 208 224 240)◦t.  "ctl-shift-0 1 ... 5"<br></span><span class="tab" val="79"></span><span class="small">[val=256⇒[mask&larr; 0377.  val&larr; 0]</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"reset all"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">val&lt;0⇒[mask&larr; 0-val.  val&larr; 0]</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"reset emphasis"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">val&gt;0 and⦂ val&lt;16⇒[mask&larr; val]</span><span class="tab" val="79"></span><span class="small">"set emphasis"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">mask&larr; 0360].</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"set font"<br></span><span class="tab" val="79"></span><span class="small">para maskrun: c1 to: c2-1 under: mask to: val]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">copyselection <br></span><span class="tab" val="79"></span><span class="small">["copy the current selection and store it in the Scrap."<br></span><span class="tab" val="79"></span><span class="small">Scrap &larr; para copy: c1 to: c2-1.<br></span><span class="tab" val="79"></span><span class="small">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">cut <br></span><span class="tab" val="79"></span><span class="small">["cut out the current selection and redisplay the paragraph."<br></span><span class="tab" val="79"></span><span class="small">Scrap &larr; para copy: c1 to: c2-1.<br></span><span class="tab" val="79"></span><span class="small">self reversefrom: c1 to: c2.</span><span class="tab" val="79"></span><span class="small">"deselect old selection"<br></span><span class="tab" val="79"></span><span class="small">para replace: c1 to: c2-1 by: nullString.<br></span><span class="tab" val="79"></span><span class="small">c2 &larr; c1.<br></span><span class="tab" val="79"></span><span class="small">begintypein &larr; false.<br></span><span class="tab" val="79"></span><span class="small">self show.<br></span><span class="tab" val="79"></span><span class="small">self reversefrom: c1 to: c2.</span><span class="tab" val="79"></span><span class="small">"show new selection"<br></span><span class="tab" val="79"></span><span class="small">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">edit: superimage </span><span class="small">| pt charindex<br></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">"eventually a general paragraph manipulator for now just a hack."<br></span><span class="tab" val="79"></span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">self show ; reversefrom: c1 to: c2." show current selection"user waitnobug.<br></span><span class="tab" val="79"></span><span class="small">until⦂ 1=2 do⦂ "forever for now"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user kbck⇒ [self kbd]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user yellowbug⇒ [paragraphmenu bug<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=1⇒</span><span class="tab" val="79"></span><span class="small">[self resize ]; "resize"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=2⇒</span><span class="tab" val="79"></span><span class="small">[self fit]; "include all of the text in the current selection"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=3⇒</span><span class="tab" val="79"></span><span class="small">[self cut]; "delete the current selection"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=4⇒</span><span class="tab" val="79"></span><span class="small">[self paste]; "paste the Scrap over the selection"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=5⇒</span><span class="tab" val="79"></span><span class="small">[self copyselection]; "copy current selection"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=6⇒</span><span class="tab" val="79"></span><span class="small">[self align]; "change the alignment of the paragraph"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=7⇒</span><span class="tab" val="79"></span><span class="small">[self setfigure]; "set color corrisponding to 1"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=8⇒</span><span class="tab" val="79"></span><span class="small">[self setground] "set color corrisponding to 1"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user redbug⇒ [self reversefrom: c1 to: c2. frame has: (pt &larr; user mp)⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[self select: pt]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">⇑self.]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user tabletbug⇒ [frame has: (pt &larr; user mp)⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[self tabletBug]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">self reversefrom: c1 to: c2. ⇑self.]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">user bluebug⇒ [self reversefrom: c1 to: c2. "erase current selection"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">⇑self.] "and exit back to the document"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">fintype<br></span><span class="tab" val="79"></span><span class="small">[begintypein⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[</span><span class="tab" val="79"></span><span class="small">[begintypein&lt;c1⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[Scrap &larr; para copy: begintypein to: c1-1.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">c1 &larr; begintypein]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">begintypein &larr; false]<br></span><span class="tab" val="79"></span><span class="small">⇑false]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">fit</span><span class="small">| t <br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"make the bounding rectangle of the TextImage contain all the textwhile not changing the width of the TextImage."<br></span><span class="tab" val="79"></span><span class="small">self white.<br></span><span class="tab" val="79"></span><span class="small">frame extent&larr; ((frame width)⌾ 1000).<br></span><span class="tab" val="79"></span><span class="small">t &larr; self rectofchar: (para length+1).<br></span><span class="tab" val="79"></span><span class="small">frame extent&larr; (frame width)⌾((t corner y) - (frame origin y)).<br></span><span class="tab" val="79"></span><span class="small">self show. frame border: 1 color: ¬1. self reversefrom: c1 to: c2.<br>]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">kbd </span><span class="small">| more char  "key struck on the keyboard"<br></span><span class="tab" val="79"></span><span class="small">[c1&lt;c2 and⦂ self checklooks⇒[⇑ self show reversefrom: c1 to: c2]<br></span><span class="tab" val="79"></span><span class="small">more &larr; Set new string: 16.<br></span><span class="tab" val="79"></span><span class="small">[begintypein⇒[] Deletion &larr; para copy: c1 to: c2-1. begintypein &larr; c1].<br></span><span class="tab" val="79"></span><span class="small">while⦂ (char &larr; user kbdnext) do⦂ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">char<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=bs⇒ ["backspace"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">more empty⇒ [begintypein &larr; begintypein min: (c1 &larr; 1 max: c1-1)]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">more skip: ¬1];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=cut⇒ [⇑self cut];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=paste⇒ [⇑self paste];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=ctlw⇒ ["ctl-w for backspace word"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">more reset.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">c1 &larr; 1 max: c1-1.</span><span class="tab" val="79"></span><span class="small"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">while⦂ [c1&gt;1 and⦂ (para◦(c1-1)) tokenish] do⦂ [c1 &larr; c1-1].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">begintypein &larr; begintypein min: c1];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">=esc⇒ ["</span><span class="small italic">select previous type-in</span><span class="small">"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[more empty⇒[self reversefrom: c1 to: c2]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">para replace: c1 to: c2-1 by:  more. c1 &larr; c2].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">self fintype.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">c1 &larr; c2-Scrap length.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">⇑self reversefrom: c1 to: c2]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">"just a normal character"<br></span><span class="tab" val="79"></span><span class="small">more next&larr; char].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">para replace: c1 to: c2-1 by:  more. c2 &larr; c1 + more length. c1 &larr; c2.<br></span><span class="tab" val="79"></span><span class="small">self show. self reversefrom: c1 to: c2]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">paste <br></span><span class="tab" val="79"></span><span class="small">["paste the Scrap over the current selection and redisplay the paragraph."<br></span><span class="tab" val="79"></span><span class="small">self fintype.<br></span><span class="tab" val="79"></span><span class="small">self reversefrom: c1 to: c2.</span><span class="tab" val="79"></span><span class="small">"deselect current selection"<br></span><span class="tab" val="79"></span><span class="small">para replace: c1 to: c2-1 by: Scrap.<br></span><span class="tab" val="79"></span><span class="small">c2 &larr; c1 + Scrap length.<br></span><span class="tab" val="79"></span><span class="small">self show.<br></span><span class="tab" val="79"></span><span class="small">self reversefrom: c1 to: c2.</span><span class="tab" val="79"></span><span class="small">"highlight new selection"<br></span><span class="tab" val="79"></span><span class="small">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">resize </span><span class="small">| t pt xgrid ygrid<br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"Show the origin cursor until the user presses a mouse button,<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small italic">then get my origin"<br></span><span class="tab" val="79"></span><span class="small italic">"Show the corner cursor and show me until  user nobug<br></span><span class="tab" val="79"></span><span class="small italic">"</span><span class="small"><br></span><span class="tab" val="79"></span><span class="small">t&larr;frame origin.<br></span><span class="tab" val="79"></span><span class="small">CornerCursor topage1.<br></span><span class="tab" val="79"></span><span class="small">user waitbug. self white.<br></span><span class="tab" val="79"></span><span class="small">frame corner&larr; frame origin.<br></span><span class="tab" val="79"></span><span class="small">until⦂ user nobug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[self white.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">( pt &larr; <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">((superimage superimage) mp)+<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">((superimage superimage) rectangle origin)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">frame corner&larr; pt max: frame origin+ (16⌾(style lineheight)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">self displayat: frame origin effect: 0 clippedBy: frame.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">NormalCursor topage1.<br></span><span class="tab" val="79"></span><span class="small">self show. frame boxcomp. self reversefrom: c1 to: c2.<br>]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">setfigure </span><span class="small">| <br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"for now just increment the figure color by 1 \ 14"<br></span><span class="tab" val="79"></span><span class="small">figure &larr; (figure +1 ) \ 14.<br></span><span class="tab" val="79"></span><span class="small">self displayat: (self frame origin) effect: 0 clippedBy: user screenrect.<br>]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">setground </span><span class="small">| <br></span><span class="tab" val="79"></span><span class="small">[</span><span class="small italic">"for now just increment the figure color by 1 \ 14"<br></span><span class="tab" val="79"></span><span class="small">ground &larr; (ground +1 ) \ 14.<br></span><span class="tab" val="79"></span><span class="small">self displayat: (self frame origin) effect: 0 clippedBy: user screenrect.<br>]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">white <br></span><span class="tab" val="79"></span><span class="small">["white out the image"<br></span><span class="tab" val="79"></span><span class="small">(frame inset: (¬2⌾¬2)) clear: 0.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>SELECTION</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">complementfrom: hair1 to: hair2 </span><span class="small">| temprect<br>["Complement the screen dots corresponding to the lines and part-lines of the paragraph between hair1 inclusive and hair2 exclusive.  If hair1 = hair2, this is a no-op.  If hair1 &gt; hair2, they are reversed. This complementing happens in three parts, A, B, and C, between points 1 and 2, according to the following illustration:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">1AAA<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">BBBB<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">BBBB<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">BBBB<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">CCC2<br>unless there is just one line involved, as in:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">1DD2<br>"<br></span><span class="tab" val="79"></span><span class="small">"one line case"<br></span><span class="tab" val="79"></span><span class="small">hair1 minY = hair2 minY⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[((([hair1 minX ≤ hair2 minX⇒ [hair1 origin rect: hair2 corner]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">hair2 origin rect: hair1 corner]) intersect: frame) intersect: window) comp]<br><br></span><span class="tab" val="79"></span><span class="small">[hair1 minY &gt; hair2 minY⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">temprect &larr; hair1. hair1 &larr; hair2. hair2 &larr; temprect]].<br><br></span><span class="tab" val="79"></span><span class="small">temprect &larr; (frame minX ⌾ hair1 maxY) rect: (frame maxX ⌾ hair2 minY).<br></span><span class="tab" val="79"></span><span class="small">(((hair1 origin rect: (temprect maxX ⌾ temprect minY)) intersect: frame) intersect: window)  comp.<br></span><span class="tab" val="79"></span><span class="small">((temprect intersect: frame) intersect: window)  comp.<br></span><span class="tab" val="79"></span><span class="small">((((temprect minX ⌾ temprect maxY) rect: hair2 corner) intersect: frame) intersect: window)  comp.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">reversefrom: char1 to: char2</span><span class="small">| h1 h2<br>["Complement the dots corresponding to the the lines and part-lines of the paragraph between the left edge of char1 and the left edge of char2.  If char1 = char2, this is sort of a no-op.  If char1 &gt; char2, this is undefined."<br></span><span class="tab" val="79"></span><span class="small">self ptofchar: char1. h1 &larr; reply1 rect: reply2.<br> </span><span class="tab" val="79"></span><span class="small">[char2=char1⇒[h2 &larr; h1+ (1⌾0)] self ptofchar: char2. h2 &larr; reply1 rect: reply2.].<br></span><span class="tab" val="79"></span><span class="small">self complementfrom: h1 to: h2]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">select: pt </span><span class="small">| h1 h2 c h drag2 selection<br></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">"draw out and record ( c1 and c2) a selection"<br></span><span class="tab" val="79"></span><span class="small">c1 &larr; c2 &larr; self charofpt: pt.<br></span><span class="tab" val="79"></span><span class="small">h1 &larr; reply1 rect: reply2.<br></span><span class="tab" val="79"></span><span class="small">h2 &larr; h1 + (1⌾0).<br></span><span class="tab" val="79"></span><span class="small">self complementfrom: h1 to: h2.<br></span><span class="tab" val="79"></span><span class="small">selection &larr; true.<br></span><span class="tab" val="79"></span><span class="small">while⦂ (pt &larr; user mpnext) do⦂ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">c &larr; self charofpt: pt.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">h &larr; "proj screenHairBeforeThatChar" reply1 rect: reply2.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[c1 = c2⇒ [drag2 &larr; c ≥ c2]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[drag2⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[c &lt; c1⇒ [h &larr; self ptofchar: (c &larr; c1). h &larr; reply1 rect: reply2.]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">self complementfrom: h to: h2.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">c2 &larr; c. h2 &larr; h]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[c &gt; c2⇒ [h &larr; self ptofchar: (c &larr; c2). h &larr; reply1 rect: reply2.]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">self complementfrom: h1 to: h.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">c1 &larr; c. h1 &larr; h].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">h1 = h2⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">self complementfrom: h1 to: (h2 &larr; h1 + (1⌾0))]].<br></span><span class="tab" val="79"></span><span class="small">drag2⇒ []<br></span><span class="tab" val="79"></span><span class="small">"get rid of extra line in backwards select"<br></span><span class="tab" val="79"></span><span class="small">self complementfrom: h2 - (1⌾0) to: h2]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>SYSTEM</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">copy | t<br></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">t &larr;  TextImage new paragraph: para copy frame: (frame copy) style: style copy.<br></span><span class="tab" val="79"></span><span class="small">t c1&larr; c1 ; c2&larr; c2 ; begintypein &larr; begintypein.<br></span><span class="tab" val="79"></span><span class="small">⇑ t<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">fromPress: press value: s </span><span class="small">[</span><span class="small bold"><br></span><span class="tab" val="79"></span><span class="small">"</span><span class="small italic">frame set by Image</span><span class="small">"<br></span><span class="tab" val="79"></span><span class="small">para &larr; Paragraph new fromPress: press value: s.<br></span><span class="tab" val="79"></span><span class="small">figure &larr; s nextword.<br></span><span class="tab" val="79"></span><span class="small">self paragraph: para frame: frame style: DefaultTextStyle<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">figure: figure ground: s nextword]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">hideData: complete </span><span class="small">| s p [ <br></span><span class="tab" val="79"></span><span class="small">p &larr; para hideData: complete.<br></span><span class="tab" val="79"></span><span class="small">Stream new of: (s &larr; String new: p length+4);<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">append: p;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">nextword &larr; figure;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">nextword &larr; ground.<br></span><span class="tab" val="79"></span><span class="small">⇑s]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">hidePress: press complete: c </span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">press skipcode: self pressCode data: (self hideData: c)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">pressCode </span><span class="small">[⇑4]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">presson: press in: r <br></span><span class="tab" val="79"></span><span class="small">[<br></span><span class="tab" val="79"></span><span class="small">⇑ para presson: press in: r.<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">show | </span><span class="small">lastvisible</span><span class="small bold"><br></span><span class="tab" val="79"></span><span class="small">["display text and expand the frame in y to include all of<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">the text if the textimage is too small"<br></span><span class="tab" val="79"></span><span class="small">super show.<br></span><span class="tab" val="79"></span><span class="small">lastvisible &larr; self rectofchar: para length.</span><span class="tab" val="79"></span><span class="small">"see if lastvisible out of frame"<br></span><span class="tab" val="79"></span><span class="small">lastvisible bottom &gt; frame bottom ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[frame corner y&larr; lastvisible corner y.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">super show.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>ACCESS TO PARTS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">begintypein&larr; begintypein </span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">c1&larr; c1 </span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">c2&larr; c2 </span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">figure <br></span><span class="tab" val="79"></span><span class="small">["return the figure color (color associated with black) for this TextImage"<br></span><span class="tab" val="79"></span><span class="small">⇑ figure<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">figure: figure <br></span><span class="tab" val="79"></span><span class="small">["change the figure color (color associated with black) for this TextImage"]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">ground <br></span><span class="tab" val="79"></span><span class="small">["return the ground color (color associated with white) for this TextImage"<br></span><span class="tab" val="79"></span><span class="small">⇑ ground<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">ground: ground <br></span><span class="tab" val="79"></span><span class="small">["change the ground color (color associated with white) for this TextImage"]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">leftflush<br></span><span class="tab" val="79"></span><span class="small">[ (self para) flushleft]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">rectangle<br></span><span class="tab" val="79"></span><span class="small">["Return rectangle (frame of Textframe) for compatibility with Image calls -- <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">needed in findbyrect: in Document"<br></span><span class="tab" val="79"></span><span class="small">⇑frame]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">text<br></span><span class="tab" val="79"></span><span class="small">[⇑ self para text]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>DISPLAY</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small bold">displayat: pt effect: effect clippedBy: cliprect | clippedrect<br></span><span class="tab" val="79"></span><span class="small">["display text "<br></span><span class="tab" val="79"></span><span class="small">super displayat: pt effect: effect clippedBy: cliprect.<br></span><span class="tab" val="79"></span><span class="small">aurorarunning⇒ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[user displayoffwhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">[clippedrect &larr; (super frame) intersect: (user screenrect).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">aurora destination: clippedrect ; source: clippedrect ;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">figure: figure ; ground: ground ;  function: 002117 "AoverB" ;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small"> doit; function: 0 ; doit.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="small">]<br></span><span class="tab" val="79"></span><span class="small">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">SystemOrganization classify: ↪TextImage under: &rsquo;Form Path Image&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="small">TextImage classInit</span></div>
<script>function do_tabs() { // unit = px
  var tabs = document.getElementsByClassName("tab");
  for (var i = 0; i < tabs.length; ++i) {
    var span = tabs[i];
    var val = span.getAttribute("val");
    if (val == null) console.log("Couldn't get val");
    var rect = span.getBoundingClientRect();
    var tabstop;
    if (val > 0) tabstop = Math.ceil(rect.left / val) * val;
    else tabstop = -val;
    console.log("do_tabs", val, tabstop)
    if (tabstop > 0) {
      var width = tabstop - rect.left;
      span.style.display = "inline-block";
      span.style.width = width + "px";
    }
  }
}
do_tabs();
</script>
  </body>
</html>
