<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <title>Smalltalk76/FPI-Packages.st</title>
	<link rel="stylesheet" type="text/css" href="font.css"/>
  </head>
  <body>
    <div class="line left">
<span class="small">&rsquo;From Smalltalk 5.5k XM November 24 on 22 November 1980 at 2:57:08 am.&rsquo;<br></span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span class="medium bold">"BitImage"</span></div>
<div class="line left">
<span class="medium bold">Class new title: &rsquo;BitImage&rsquo;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="medium bold">subclassof: Image<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="medium bold">fields: &rsquo;strips nstrips&rsquo;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="medium bold">declare: &rsquo;brush aurora stripheightSPARE stripheight black white bitimagemenu erase SPARE color formmenu under reverse blankcursor over dotsetter &rsquo;;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="medium bold">asFollows</span></div>
<div class="line left">
<span class="small italic"><br>This class is a virtual bit map represented as a smalltalk String</span></div>
<div class="line left">
<span class="medium bold"><br>INIT</span></div>
<div class="line left">
<span class="small bold">classInit <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["sets up colors and effects for BITBLT."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">black &larr; 0-1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">white &larr; 0.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">over &larr; 0.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">under &larr; 1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">reverse &larr; 2.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">erase &larr; 3.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">brush &larr; Form new extent: 5⌾5. brush black.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">color &larr; 1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">stripheight &larr; 20.<br>bitimagemenu &larr; Menu new string:<br>&rsquo;size<br>figure<br>ground<br>newform<br>pasteform<br>arc<br>areafill<br>shade<br>vertical<br>horizontal<br>rotate<br>&rsquo;.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">aurora &larr; "Aurora new" nil.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">fromImage: image <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["creates a virtual bit map with width = (image width) and height = (image height) with the bits in image."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self fromrectangle: image rectangle.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;</div>
<div class="line left">
<span class="small bold">fromrectangle: rect </span><span class="small">| </span><span class="small bold">r i leftover image yposition<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["creates a virtual bit map with width = (r width) , height = (r height)<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"> and the bits in rect. The Image is  made up of forms that are stripheight high."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">super origin: rect origin extent: rect extent.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">nstrips &larr; (rect height + (stripheight -1))/stripheight.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">yposition &larr; 0.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">leftover &larr; rect height \ stripheight.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[ (leftover = 0) ⇒ [leftover &larr; stripheight]].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">r &larr; Rectangle new origin: rect origin extent: (rect width)⌾stripheight.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ i to: nstrips do⦂ <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[ i = nstrips ⇒ [ r extent &larr; ((rect width)⌾leftover)]].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">image &larr; Image new origin: (0⌾0) extent: rect extent.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">image form: (Form new fromrectangle: r) ; path: (0⌾yposition).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self addimage: image.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">yposition &larr; yposition + stripheight.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">r translate: (0⌾stripheight).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;</div>
<div class="line left">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="small bold">fromuser  | r<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["create a new Form whose rectangle is specified by the user. "<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">r &larr; Rectangle new fromuser.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self fromrectangle: r<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">fromuserevenword  | r<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["create a new BitImage whose rectangle is specified by the user,<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">truncated to nearest multiple of 16 (for Spruce printing). "<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">r &larr; Rectangle new fromuserevenword.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self fromrectangle: r.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="medium bold"><br>PATTERN ACCESS</span></div>
<div class="line left">
<span class="small bold">erase </span><span class="small">| i<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["sets all bits in the BitImage to white ( to zeros)"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ i to: nstrips do⦂ [ (strips◦i) white]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">nstrips<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇑ nstrips <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span></div>
<div class="line left">
<span class="small bold">nstrips: nstrips <br></span></div>
<div class="line left">
<span class="small bold">saveScreenBits<br></span><span class="small">[<br>]</span></div>
<div class="line left">
<span class="small bold">strips <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["return the set of Forms making up this BitImage)"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇑ strips<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">strips: strips <br></span></div>
<div class="line left">
<span class="medium bold"><br>MODULE ACCESS</span></div>
<div class="line left">
<span class="small bold">comment <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["see class Image"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">frame </span><span class="small">[ ⇑ rectangle]</span></div>
<div class="line left">
<span class="small bold">moveto: pt  <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[self translateto: pt<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="medium bold"><br>FILING</span></div>
<div class="line left">
<span class="small bold">read: filename </span><span class="small">| file subimage strip yposition i<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["Reads the Image in the format nstrips , Form(1) , Form(2) , Form(3) . . .<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">Form(nstips). Where each Form is saved as width,height then bits.  "<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self origin: 0⌾0 extent: 1⌾1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">yposition &larr; 0.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">file&larr; (dp0 oldFile: filename) readonly.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">nstrips &larr; file nextword.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ i to: nstrips do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">strip &larr; Form new fromInstance: file.  <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self addform: strip andpath: (0⌾yposition).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">yposition&larr; yposition+ strip height.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">file close.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">write: filename </span><span class="small">| file subimage<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["Saves the Form in the format nstrips , Form(1) , Form(2) , Form(3) . . .<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">Form(nstips). Where each Form is saved as width,height then bits.  "<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">file &larr; (dp0 file: filename).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">file nextword&larr; nstrips.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ subimage from: self do⦂ [ file append: (subimage form) asInstance. ]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">file close.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="medium bold"><br>DISPLAY</span></div>
<div class="line left">
<span class="small bold">displayat:  path effect: effect clippedBy: cliprect<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">super displayat: path effect: effect clippedBy: cliprect<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">show<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">super displayat: (0⌾0) effect: 0 clippedBy: user screenrect<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="medium bold"><br>SYSTEM</span></div>
<div class="line left">
<span class="small bold">copy </span><span class="small">| t i<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["return a copy of myself"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">t &larr; BitImage new origin: (origin copy) extent: (self extent) copy.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ i to: self length do⦂ [ t add: (self◦i) copy].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇑ t<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">pressCode </span><span class="small">[⇑3]</span></div>
<div class="line left">
<span class="small bold">printon: strm </span><span class="small">| t<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">strm append: &rsquo;a Bitmage: &rsquo;.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span></div>
<div class="line left">
<span class="small bold">title <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇑ &rsquo;&rsquo;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="medium bold"><br>EDITING</span></div>
<div class="line left">
<span class="small bold">arc </span><span class="small">| pt1 pt2 pt3 p pt<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["arc tool for forms."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">BlankCursor topage1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user clear; print: &rsquo;Redbug 3 points&rsquo;; cr; print: &rsquo;Paints using current brush.&rsquo; .<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user waitnobug.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">until⦂ user redbug do⦂</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[ pt1 &larr; self blinkbrush].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">brush displayat: pt1 effect: color clippedBy: user screenrect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user waitnobug.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">until⦂ user redbug do⦂</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[ pt2 &larr; self blinkbrush].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">brush displayat: pt2 effect: color clippedBy: user screenrect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user waitnobug.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">until⦂ user redbug do⦂</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[ pt3 &larr; self blinkbrush].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">brush displayat: pt3 effect: color clippedBy: user screenrect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">XeqCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">p &larr; Path new init.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">p addarcfrom: pt1 via: pt2 to: pt3.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ pt from: p do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[ brush displayat: pt effect: color clippedBy: user screenrect].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">NormalCursor show<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span></div>
<div class="line left">
<span class="small bold">blinkbrush </span><span class="small">| pt <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["to show current position of brush in the BitImage."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">pt &larr; self mp + rectangle origin.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">brush displayat: pt<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">effect: 2 clippedBy: user screenrect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">brush displayat: pt<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">effect: 2 clippedBy: user screenrect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇑ pt<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span></div>
<div class="line left">
<span class="small bold">edit: superimage | bits <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["uses the BitRect toolbox editor"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">XeqCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">dotsetter &larr; BitRectEditor new picture: self.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">dotsetter firsttime.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">NormalCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">while⦂ true do⦂ "forever"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">(dotsetter lostMouse and: (user anybug)) ⇒<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">dotsetter outside⇒ []<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">XeqCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">dotsetter lasttime.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">bits &larr; self fromrectangle: rectangle.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">NormalCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇑ bits<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">dotsetter eachtime<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span></div>
<div class="line left">
<span class="small bold">grayEdit </span><span class="small">| a b c i d p r v bits "edit up a gray pattern and return it"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["first a rectangle for it.  Then redbug is black, yellow is white,<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">blue terminates"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">r &larr; Rectangle new fromuser. bits&larr;0.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">a &larr; r extent. a&larr; (a x max:  a y) | 4. a &larr; a⌾a.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">b &larr; r origin. r extent&larr; a; color: white mode: storing; moveby: 0⌾(0-a y).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">c &larr; a/4.  d &larr; b rect: b+c.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">until⦂ user bluebug do⦂ [<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user redbug ⇒[p &larr; user mp -b /c.  i &larr; p y *4 +p x +1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">i&lt;1 or⦂ i&gt;16 ⇒[r flash]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">d moveto: b+(c*p); color: black mode: storing.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">bits &larr; bits lor: (1 lshift: 16-i).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">r color: bits mode: storing. user waitnobug]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user yellowbug ⇒[p &larr; user mp -b /c.  i &larr; p y *4 +p x +1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">i&lt;1 or⦂ i&gt;16 ⇒[r flash]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">d moveto: b+(c*p); color: white mode: storing.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">bits &larr; (¬1 lxor:(1 lshift: 16-i)) land: bits.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">r color: bits mode: storing. user waitnobug]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">] ⇑bits]<br>"aa grayEdit base8 ."</span></div>
<div class="line left">
<span class="small bold">horizontalsymmetry </span><span class="small">| r f i <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["horizontal symmetry tool"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user clear; show: &rsquo;Define rectangle. Reflection will be around lower edge&rsquo;.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">r &larr; Rectangle new fromuser.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">XeqCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ i to: ( r height) do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">f &larr; Form new fromrectangle: (Rectangle new origin: ((r origin x)⌾((r bottom)-i)) extent: ((r width)⌾1)).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">f displayat: (r origin x)⌾((r bottom) +i) effect: 0 clippedBy: user screenrect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">NormalCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">line </span><span class="small">| pt1 pt2 p pt<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["line tool for forms."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">BlankCursor topage1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">until⦂ user redbug do⦂</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[ pt1 &larr; self blinkbrush].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">brush displayat: pt1 effect: color clippedBy: user screenrect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">until⦂ user nobug do⦂</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[ pt2 &larr; self blinkbrush].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">brush displayat: pt2 effect: color clippedBy: user screenrect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">p &larr; Path new init.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">p addlinefrom: pt1 to: pt2.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ pt from: p do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[ brush displayat: pt effect: color clippedBy: user screenrect].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">NormalCursor topage1<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span></div>
<div class="line left">
<span class="small bold">newbrush </span><span class="small">|  pt rect<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">OriginCursor topage1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user waitbug.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">pt &larr; ( self mp)+ rectangle origin.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">rect &larr; pt rect: pt.</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">CornerCursor topage1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">until⦂ user nobug do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[rect reverse.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">rect reverse.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">pt &larr; <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">( self mp)+ rectangle origin.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">rect corner &larr; (rect origin) max: pt.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br> </span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">brush &larr; Form new fromrectangle: rect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">NormalCursor topage1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span></div>
<div class="line left">
<span class="small bold">pastebrush </span><span class="small">| pt1 <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["one-copy tool for forms."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user waitnobug.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">OriginCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user waitbug.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">while⦂ user redbug do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[ pt1 &larr; self blinkbrush].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">XeqCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">brush displayat: pt1 effect: (dotsetter tool mode) clippedBy: user screenrect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">NormalCursor show]</span></div>
<div class="line left">
<span class="small bold">resize: superimage </span><span class="small">|  pt f<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[dotsetter leave.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">CornerCursor topage1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user waitbug. <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">until⦂ user nobug do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[self reverse.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self reverse.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">( pt &larr; <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">(superimage  mp)+<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"> superimage rectangle origin).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self corner&larr; pt max: ((self origin) + (16⌾16)).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br> </span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self fromrectangle: rectangle.<br> </span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self white ; display.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">NormalCursor topage1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self edit: superimage<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span></div>
<div class="line left">
<span class="small bold">rotate </span><span class="small">| r f i j<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["90 degree rotation tool"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">r &larr; Rectangle new fromuser.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ i to: ( r width) do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ j to: ( r height) do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">f &larr; Form new fromrectangle: (Rectangle new origin: (((r origin x)+i)⌾(r top+j)) extent: (1⌾1)).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">f displayat: (((r corner x)+j))⌾((r top)+i) effect: 0 clippedBy: user screenrect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">setfigure </span><span class="small">| t<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[</span><span class="small italic">"for now just increment the figure color by 1 \ 12"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">figure &larr; (figure +1 ) \ 12.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ t from: self do⦂ [ (t form) figure: figure].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self display<br>]<br></span></div>
<div class="line left">
<span class="small bold">setground </span><span class="small">| t<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[</span><span class="small italic">"for now just increment the ground color by 1 \ 12"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">ground &larr; (ground +1 ) \ 12.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ t from: self do⦂ [ (t form) ground: ground].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self display<br>]<br></span></div>
<div class="line left">
<span class="small bold">verticalsymmetry </span><span class="small">| r f i <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["vertical symmetry tool"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user clear; show: &rsquo;Define rectangle. Reflection will be around right-hand edge&rsquo;.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">r &larr; Rectangle new fromuser.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">XeqCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ i to: ( r width) do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">f &larr; Form new fromrectangle: (Rectangle new origin: (((r origin x)+(r width)-i)⌾(r top)) extent: (1⌾(r height))).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">f displayat: ((r corner x) + i)⌾(r top) effect: 0 clippedBy: user screenrect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">NormalCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">yellowbug </span><span class="small">| <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">bitimagemenu bug<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=1⇒</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[self resize: superimage<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]; "change size"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=2⇒</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[self setfigure];</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=3⇒</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[self setground];</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=4⇒</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[self newbrush];</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=5⇒</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[self pastebrush];</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=6⇒</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[self arc ];<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=7⇒</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[Rectangle new fromuser fillin: ((dotsetter tool) tone)<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">mode: ((dotsetter tool) mode) ];<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=8⇒  [(dotsetter tool) shade];<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=9⇒  [self verticalsymmetry];<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=10⇒  [self horizontalsymmetry];<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=11⇒  [self rotate]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small"></span></div>
<div class="line left">
<span class="small">SystemOrganization classify: ↪BitImage under: &rsquo;FPI Packages&rsquo;.</span></div>
<div class="line left">
<span class="small">BitImage classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>"BorderedText"</span></div>
<div class="line left">
<span class="medium bold">Class new title: &rsquo;BorderedText&rsquo;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="medium bold">subclassof: TextImage<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="medium bold">fields: &rsquo;&rsquo;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="medium bold">declare: &rsquo;&rsquo;;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="medium bold">asFollows</span></div>
<div class="line left">
<span class="small italic"><br>This class has not yet been commented</span></div>
<div class="line left">
<span class="medium bold"><br>DISPLAY</span></div>
<div class="line left">
<span class="small bold">displayat: pt effect: effect clippedBy: cliprect | origin corner<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["display text and border around it "<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">super displayat: pt effect: effect clippedBy: cliprect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">origin &larr; frame origin.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">corner &larr; frame corner.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">(Rectangle new<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">origin: origin-(1⌾1) corner: (corner x+1)⌾origin y)<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">color: ¬1 mode: effect;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">moveto: (origin x-1)⌾corner y; color: ¬1 mode: effect;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">origin &larr; corner x⌾(origin y-1); color: ¬1 mode: effect;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">moveto: origin-(1⌾1); color: ¬1 mode: effect<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="medium bold"><br>SYSTEM</span></div>
<div class="line left">
<span class="small bold">copy </span><span class="small">| t<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">t &larr;  BorderedText new paragraph: para copy frame: (frame copy) style: style copy.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">t c1&larr; c1 ; c2&larr; c2 ; begintypein &larr; begintypein.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇑ t<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">pressCode </span><span class="small">[⇑6]</span></div>
<div class="line left">
<span class="small bold">presson: press in: r | scale<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">scale &larr; press scale.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">press setp: (r origin x- scale)⌾(r corner y-(3*scale)) ;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">showrectwidth: (scale*(2+self width)) height: scale.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">press setp: (r origin x- scale)⌾(r corner y-((self height+5)*scale)) ;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">showrectwidth: (scale*(2+self width)) height: scale.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">press setp: (r origin x- scale)⌾(r corner y-(scale*(self height+4))) ;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">showrectwidth: scale height: (scale*(self height+2)).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">press setp: (r origin x+(scale*(self width)))⌾(r corner y-(scale*(self height+4))) ;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">showrectwidth: scale height: (scale*(self height+2)).<br><br>⇑ para presson: press in: r.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small"></span></div>
<div class="line left">
<span class="small">SystemOrganization classify: ↪BorderedText under: &rsquo;FPI Packages&rsquo;.</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>"Document"</span></div>
<div class="line left">
<span class="medium bold">Class new title: &rsquo;Document&rsquo;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="medium bold">subclassof: Image<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="medium bold">fields: &rsquo;displayorder style&rsquo;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="medium bold">declare: &rsquo;leading micasperinch &rsquo;;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="medium bold">asFollows</span></div>
<div class="line left">
<span class="small italic"><br>basic document class</span></div>
<div class="line left">
<span class="medium bold"><br>EDITING</span></div>
<div class="line left">
<span class="small bold">bubbledelete: image </span><span class="small">| delta i k<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["delete image from the document  and subtracting images extent y from all subimages below it."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">i &larr; self find: image.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">i⇒ [<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self deleteI: i .<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">delta &larr; image extent y.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ k from: i to: self length do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">(self◦k) translate: (0⌾(0-delta))<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">bubbleinsert: image </span><span class="small">| delta i k<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["insert image into the document keeping the document y-sorted and adding images extent y to all subimages below it."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">i &larr; self findindex: image.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self insertI: i value: image.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">delta &larr; image extent y.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ k from: i+1 to: self length do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">(self◦k) translate: (0⌾delta)<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">delete: image </span><span class="small">|  i <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["delete image from the document and leave its space. "<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">i &larr; self find: image.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">i⇒ [ self deleteI: i.]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">edit <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["Documents are edited with a DocumentEditor"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">DocumentEditor new init: self.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">findindex: image </span><span class="small">| y guess top bottom<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["binary search on the origins of the rectangles surrounding my subimages<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">returns the index of the subimage just below image."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">position = 0 ⇒ [ ⇑ 1]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">top &larr; 1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">bottom &larr; position.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">y&larr; image rectangle origin y.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">y ≤ ((self◦1) rectangle origin y) ⇒ [ ⇑ 1].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">y ≥ ((self◦position) rectangle origin y) ⇒ [ ⇑ position+1]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">guess &larr; position/2.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">until⦂  bottom = (top+1) do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[((self◦guess) rectangle origin y) ≥ y ⇒ [ bottom &larr; guess ] top &larr; guess].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">guess &larr; (bottom + top) /2<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇑ bottom<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">insert: image </span><span class="small">| i<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["insert image into the document keeping the document y-sorted."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">i &larr; self findindex: image.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self insertI: i value: image.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">resize </span><span class="small">| delta t<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["make sure the document does not have subimages that have negative y values and resize the document"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[position ≥ 1 ⇒<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">(delta &larr; (self◦1) top) ≤ 0 ⇒ <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ t from: self do⦂ [ t translate: (0⌾(0-delta)) ] <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">super resize<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="medium bold"><br>INIT</span></div>
<div class="line left">
<span class="small bold">classInit <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">micasperinch &larr; 2540.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">name<br>[ ⇑  displayorder </span><span class="small">"returns the name of the document ( displayorder is currently used for name... note that name is a string."<br></span><span class="small bold"> ] <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span></div>
<div class="line left">
<span class="small bold">name: displayorder <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["sets the name of the document ( displayorder is currently used for name... note that name is a string."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="medium bold"><br>SYSTEM</span></div>
<div class="line left">
<span class="small bold">copy </span><span class="small">| im i<br>[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">im &larr; Document new origin: origin copy rectangle: rectangle copy path: path copy form: form copy figure: figure copy ground: ground copy xgrid: xgrid copy  ygrid: ygrid copy.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ i to: self length do⦂ <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[im add: (self◦i) copy].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">im name: (self name) copy.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇑ im<br>]</span></div>
<div class="line left">
<span class="small bold">fromPress: displayorder </span><span class="small">| press s<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["</span><span class="small italic">retrieves an instance of class Document from a press file</span><span class="small">"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user displayoffwhile⦂ <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self default.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"> press &larr; (dp0 pressfile: </span><span class="small bold">displayorder</span><span class="small">). press open.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">s &larr; (press nextControl) asStream.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">s next = self pressCode ⇒ [self fromPress: press value: s]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user notify: &rsquo;error in pressfile&rsquo;.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">fromPress: press value:  s </span><span class="small">| numberofsubimages t t1 i code <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["builds an instance of class Document from a press file"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">numberofsubimages&larr; s nextword.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">origin &larr; s nextPoint.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">t &larr; s nextPoint.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">t1 &larr; s nextPoint.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">rectangle &larr; t rect: t1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">xgrid &larr; s nextword.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">ygrid &larr; s nextword.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">displayorder&larr; s nextString.</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ i to: numberofsubimages do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[s &larr; (press nextControl) asStream.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">code &larr; s next. <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">t &larr; [code = 1⇒ [Image new]; = 2⇒ [Heading new];<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">= 3⇒ [BitImage new] false].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">t and⦂ code = t pressCode⇒ [<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self addimage: (t fromPress: press value: s)]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user notify: &rsquo;illegal code or code mismatch&rsquo;]</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇑ self<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">hardcopy </span><span class="small">|</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">p i press bottoms rect pressscale pageheight pagewidth  lastrect </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">currentrect oldytop oldybottom <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">oldytop &larr; 11*micasperinch.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">pageheight &larr; 11*micasperinch.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">pagewidth&larr; 8*micasperinch.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user displayoffwhile⦂ <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">press &larr; dp0 pressfile: (displayorder + &rsquo;.doc&rsquo;).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">pressscale &larr; press scale.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self hidePress: press complete: ¬1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">p &larr; PressPrinter init.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">p press: press;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">frame &larr;  ("in micas"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">((1*micasperinch)⌾(1*micasperinch)) rect:<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">((pagewidth-micasperinch)⌾(pageheight-micasperinch))).<br><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">lastrect &larr; ((self◦1) rectangle)*pressscale.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">rect &larr; ((lastrect leftside)⌾(1*micasperinch))<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">rect: ((lastrect rightside) ⌾(pageheight - (lastrect top))).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">oldybottom &larr; p print: self◦1 in: rect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ i from: (2 to: self length) do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[oldybottom &gt; oldytop⇒ <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["page break" oldytop &larr; pageheight-micasperinch.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">currentrect&larr; ((self◦i) rectangle) * pressscale.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[(currentrect top &gt; lastrect bottom)⇒<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[oldytop &larr; oldybottom+(lastrect bottom-currentrect top)"no overlap"]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">oldytop &larr; (oldytop+(lastrect top-currentrect top))"overlap"].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">rect &larr; ((currentrect leftside)⌾(1*micasperinch))<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">rect: ((currentrect rightside) ⌾(oldytop)).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">oldybottom &larr; p print: (self◦i) in: rect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">lastrect &larr; ((self◦i) rectangle)*pressscale.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">].<br><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">press close; toPrinter "send over ethernet to printer"]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">hideData: complete </span><span class="small">| s<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["stores an instance of class Document from a press file"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">s &larr; Stream new of: (String new: 100).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">s nextword&larr; self length; "number of subimages"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">nextPoint&larr; origin;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">nextPoint&larr; rectangle origin;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">nextPoint&larr; rectangle corner;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">nextword&larr; xgrid;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">nextword&larr; ygrid;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">nextString&larr; displayorder.</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇑ s contents]</span></div>
<div class="line left">
<span class="small bold">pressCode </span><span class="small">[⇑0]</span></div>
<div class="line left">
<span class="small bold">printon: strm </span><span class="small">| t<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">strm append: &rsquo;a Document &rsquo;.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small"></span></div>
<div class="line left">
<span class="small">SystemOrganization classify: ↪Document under: &rsquo;FPI Packages&rsquo;.</span></div>
<div class="line left">
<span class="small">Document classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>"DocumentEditor"</span></div>
<div class="line left">
<span class="medium bold">Class new title: &rsquo;DocumentEditor&rsquo;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="medium bold">subclassof: Window<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="medium bold">fields: &rsquo;document documentwindow screenimage firstindex lastindex<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="medium bold">indexofselection selection &rsquo;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="medium bold">declare: &rsquo;jumpcursor documentmenu scrap blankcursor &rsquo;;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="medium bold">asFollows</span></div>
<div class="line left">
<span class="small italic"><br>This class has not yet been commented</span></div>
<div class="line left">
<span class="medium bold"><br>INIT</span></div>
<div class="line left">
<span class="small bold">buildscreenimage |</span><span class="small"> i r delta  <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["This function copies the subimages intersecting the document window<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">into the screen image."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">screenimage &larr; Image new origin: self frame origin extent: self frame extent.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">screenimage  xgrid: (document xgrid) ; ygrid: (document ygrid).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">delta &larr; documentwindow origin y.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">firstindex &larr; 1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">" find the index of the first subimage that intersects the document window."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">until⦂ ((firstindex≥(document length)) or⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">((((document◦firstindex) rectangle) bottom) &gt; (documentwindow top))) do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[firstindex &larr; firstindex+1].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">lastindex &larr; firstindex.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ i from: (firstindex to: document length) do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">((((document◦i) rectangle) top) &lt; (documentwindow bottom))⇒<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[lastindex &larr; i. screenimage add: (((document◦i) "copy")<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">translate: 0⌾0 - (0⌾delta))<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">] ⇑ lastindex<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br>]</span></div>
<div class="line left">
<span class="small bold">classInit <br></span><span class="small italic">"  DocumentEditor classInit.    "<br></span><span class="small">[</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">documentmenu &larr; Menu new string:<br>&rsquo;move<br>erase<br>place<br>cut<br>paste<br>copy<br>top<br>bottom<br>jump<br>addspace<br>deletespace<br>show<br>&rsquo;.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">jumpcursor &larr; Cursor new fromtext: &rsquo;<br>1111111111111111<br>1111111111111111<br>0000000000000000<br>0000000000000000<br>0000000000000000<br>0000000000000000<br>0000001110000000<br>0000011111000000<br>0000011111000000<br>0000001110000000<br>0000000000000000<br>0000000000000000<br>0000000000000000<br>0000000000000000<br>1111111111111111<br>1111111111111111&rsquo; offset: 2⌾1.<br>]<br><br></span></div>
<div class="line left">
<span class="small bold">defaultdocument <br></span><span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self defaultdocument: &rsquo;document&rsquo;<br>]</span></div>
<div class="line left">
<span class="small bold">defaultdocument: name </span><span class="small">| defaultdocument run r textimage f im dot heading head text char b image row<br>[" name is a string"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">defaultdocument &larr; Document new origin: 0⌾0<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">extent: (user screenrect) extent.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">defaultdocument name: name.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">defaultdocument xgrid: DefaultTextStyle tab.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">defaultdocument ygrid: DefaultTextStyle lineheight.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">textimage &larr; BorderedText new.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">textimage text: &rsquo;Text that is bordered&rsquo; width: 200.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">defaultdocument addform: textimage andpath: 0⌾0.<br><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">textimage &larr; TextImage new.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">textimage text: &rsquo;This is a paragraph&rsquo; width: 600.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">defaultdocument addform: textimage andpath: 0⌾0.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">b &larr; BitImage new fromrectangle:<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">(Rectangle new origin: 0⌾200 extent: 100⌾100).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">defaultdocument insert: b.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">head &larr; Set new default.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">text &larr; &rsquo;HEADING&rsquo;.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ char from: text do⦂ [ head add: char ].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">heading &larr; Heading new origin: 0⌾400 index: 9 charactercodes: head<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">currentcharacter: 0.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">defaultdocument insert: heading.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">"defaultdocument insert: CurveIdiom new init."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self init: defaultdocument.<br>]</span></div>
<div class="line left">
<span class="small bold">init: document </span><span class="small">| i <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["This is the paragraph (subimage) level document editor."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self fixedwidthfromuser: document width.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">documentwindow &larr; Rectangle new origin: document rectangle origin<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">extent: (document width) ⌾ (self frame height).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self buildscreenimage.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection &larr; false.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user topWindow leave.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self takeCursor; enter.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user restartup: self<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="medium bold"><br>DEFAULT EVENT RESPONSES</span></div>
<div class="line left">
<span class="small bold">close<br></span><span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">XeqCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">document close.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">document &larr; nil.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">screenimage &larr; Vector new: 0.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">NormalCursor show<br>]</span></div>
<div class="line left">
<span class="small bold">enter </span><span class="small">[selection &larr; false. self show]</span></div>
<div class="line left">
<span class="small bold">hardcopy<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["write a press file and hardcopy this document"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self leave.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self top.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">document hardcopy<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">kbd | c x y<br>[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">   c &larr; user kbd. <br> </span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">c = 120⇒<br> </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[ user clearshow: &rsquo;x gridding is &rsquo;. document xgrid print.<br> </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user cr.<br> </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">document xgrid: (x&larr;<br> </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">(user request: &rsquo;x gridding . . . &rsquo;) asInteger).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">screenimage xgrid: x. <br> </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">] <br> </span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">c = 121⇒<br> </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[ user clearshow: &rsquo;y gridding is &rsquo;. document ygrid print.<br> </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user cr.<br> </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">document ygrid: (y&larr;<br> </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">(user request: &rsquo;y gridding . . . &rsquo;) asInteger).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">screenimage ygrid: y.<br> </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">] <br>]<br></span></div>
<div class="line left">
<span class="small bold">leave<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">document ≡ nil ⇒ []<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[selection⇒ [ selection highlite]].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self update ; buildscreenimage.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection &larr; false.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">print <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["write a press file and hardcopy this document"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">document hardcopy<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">redbug | pt rect newrect start t<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[pt &larr; user mp.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">start&larr;pt.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">rect&larr;newrect&larr;(Rectangle new origin: start corner: start).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[selection⇒ [selection highlite. self deselect. selection &larr; false.]]. <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">while⦂ user anybug do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[rect&larr;newrect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">rect comp.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">t&larr;user mp.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">newrect&larr;(Rectangle new origin: (start min: t) corner: (start max: t)).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">rect comp].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">(rect width &lt; 10) ⇒<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection &larr;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">screenimage smallestsubimageat:  pt- screenimage origin.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection⇒<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection  translate: screenimage origin.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection edit: screenimage.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection translate: ((0⌾0) - screenimage origin).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection &larr; false.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">rect origin &larr; screenimage griddedpoint: (rect origin).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection &larr; screenimage subimageswithin: <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">(rect translate: ((0⌾0)- screenimage origin)).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection ⇒<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[selection translate: screenimage origin ; highlite]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">yellowbug | pt<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[</span><span class="small bold"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">documentmenu bug<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=1⇒[self move];<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=2⇒[self delete];<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=3⇒[self place];<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=4⇒[self cut];<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=5⇒[self paste];<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=6⇒[self copyselection];<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=7⇒[self top];<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=8⇒[self bottom];<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=9⇒[self jump];<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=10⇒[self addspace];<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=11⇒[self deletespace];<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=12⇒[self deselect. selection &larr; false. self show]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="medium bold"><br>FRAMING</span></div>
<div class="line left">
<span class="small bold">newframe<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[self update.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self fixedwidthfromuser: document width.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self buildscreenimage ; show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">show </span><span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">XeqCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self outline .<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">growing⇒[]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">titleframe put: (Paragraph new text: self title runs: titlerun alignment: 0)<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">at: frame origin+titleloc; window outline; show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">screenimage  white.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">screenimage displayat: 0⌾0 effect: 1 clippedBy: self frame.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection ⇒ [ selection boxcomp].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">NormalCursor show<br><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">title </span><span class="small">[ ⇑ document name] </span></div>
<div class="line left">
<span class="medium bold"><br>EDITING</span></div>
<div class="line left">
<span class="small bold">addspace </span><span class="small">| image i k r delta<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["add whitespace to the document  ."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self update. selection &larr; false.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">r &larr; document rectanglefromuser.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">i &larr; (document indexofsubimagebelow: (r top- screenimage top) + documentwindow top).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[i⇒ </span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">delta &larr; r height.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ k from: i to: document length do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">(document◦k) translate: (0⌾(delta))<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">document resize<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self buildscreenimage ; show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">bottom </span><span class="small">|  i delta <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["translate the current selection to the bottom of the window and update the document to reflect any changes in the subimages which are scrolled out of the screenimage."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection⇒<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">delta &larr; (selection rectangle corner - screenimage rectangle corner).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self update. selection &larr; false.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">documentwindow translate: (0⌾ (delta y)). "move window on document"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self buildscreenimage ; show. <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">"reconstruct screen image, including reestablishing  first and last indices"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self update.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">documentwindow &larr; Rectangle new origin:<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">(document rectangle corner-self frame height)<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">extent: (document width) ⌾ (self frame height).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self buildscreenimage ; show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span></div>
<div class="line left">
<span class="small bold">closeScrap<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">scrap ≡ nil⇒ []<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">scrap close<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">copy </span><span class="small">| <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["copy the selection and put it in scrap"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self copyselection<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">copyselection </span><span class="small">| <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["copy the selection and put it in scrap"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection⇒<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">XeqCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self closeScrap.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">scrap &larr; selection copy.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">NormalCursor show<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">frame flash<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">cut </span><span class="small">| t <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["delete subimage (paragraph) from the screenimage and save it in the scrap"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection⇒<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">XeqCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self closeScrap.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">scrap &larr; selection.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self update.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ t from: selection do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">document bubbledelete: t.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection &larr; false.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self buildscreenimage ; show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">NormalCursor show<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">frame flash<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">delete | t<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["delete subimage (paragraph) from the screenimage and save it in the scrap"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection⇒<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">XeqCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self closeScrap.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">scrap &larr; selection.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection highlite ;  display: 3.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ t from: selection do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[screenimage delete: t<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]. <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection &larr; false.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">NormalCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">frame flash<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">deletespace </span><span class="small">| image i k r delta<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["delete whitespace from the document  ."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self update. selection &larr; false.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">r &larr; document rectanglefromuser.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">i &larr; (document indexofsubimagebelow: (r top - screenimage top) + documentwindow top).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[i⇒ </span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">delta &larr; r height.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ k from: i to: document length do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">(document◦k) translate: (0⌾(0-delta))<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">document resize<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self buildscreenimage ; show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">deselect </span><span class="small">| t<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[selection⇒ [<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection translate: ((0⌾0) - screenimage origin).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ t from: selection do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[t translate: selection origin<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">].<br><br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"> ]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">] </span></div>
<div class="line left">
<span class="small bold">editTitle<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[titlepara&larr;document name asParagraph.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">super editTitle.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">document name: titlepara text]</span></div>
<div class="line left">
<span class="small bold">jump<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">|  y deltay yprime deltayprime rect pt newY scal r<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[user waitnobug.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">XeqCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self update.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">y &larr; document height.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">yprime &larr; frame height.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">deltay &larr; (documentwindow origin y) - (document  origin y).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">scal&larr;yprime asFloat/y.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">deltayprime &larr; (scal*deltay) asInteger.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">pt &larr; ((screenimage leftside+((1.0-scal)*frame width/2))⌾((screenimage top) + deltayprime)).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">document quickDisplayAt: 0⌾0 scale: scal offset: (frame minX + ((1.0-scal)*frame width/2))⌾frame minY.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">rect&larr;0⌾0 rect: 1⌾1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">rect origin &larr; pt.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">rect corner x&larr;pt x +(scal*frame width) asInteger.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">rect corner y&larr;pt y + (scal*frame height) asInteger.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user cursorloc&larr;pt.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">OriginCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user waitbug.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[user redbug<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇒</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[rect comp.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">while⦂ user redbug do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[r&larr;rect copy.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">newY&larr;user mp y.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[newY&lt;(frame minY- rect height) ⇒ [newY&larr;frame minY-rect height]].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[newY&gt;frame maxY ⇒ [newY&larr;frame maxY]].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">rect translateto: pt x⌾newY.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">r comp.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">rect comp].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">rect comp.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">XeqCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">deltayprime &larr; newY - (frame origin y).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">deltay &larr; y*deltayprime/yprime.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">documentwindow translateto: (0⌾deltay).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection &larr; false]].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self buildscreenimage.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">NormalCursor show]</span></div>
<div class="line left">
<span class="small bold">move </span><span class="small">| pt t<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["used to place subimages (paragraphs) in the Image."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇒</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[user waitnobug.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">OriginCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user waitbug. <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection highlite ; displayat: 0⌾0 effect: 3 clippedBy: frame.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">while⦂ user redbug do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[pt &larr;screenimage mp + screenimage rectangle origin.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection translateto: pt.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection blink].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">XeqCursor show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection displayat: 0⌾0 effect: 1 clippedBy: frame .<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self deselect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection &larr; false.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">NormalCursor show]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">frame flash]</span></div>
<div class="line left">
<span class="small bold">paste </span><span class="small">| </span><span class="small bold">pt t</span><span class="small"><br><br>["add the subimage (paragraph) in the scrap to the screenimage."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection⇒ [selection highlite]].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self update.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection &larr; scrap copy.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">OriginCursor showwhile⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user waitbug.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">until⦂ user nobug do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">pt &larr;screenimage mp + screenimage rectangle origin.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection  translateto: pt ; blink<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection displayat: 0⌾0 effect: 1 clippedBy: self frame .<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self deselect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ t from: selection do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">document bubbleinsert: (t translate: documentwindow origin).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection &larr; false.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self buildscreenimage ; show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">place </span><span class="small">| pt tempimage t<br><br>["add the image in the scrap to the screenimage."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[selection⇒[selection highlite]].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self deselect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection &larr; scrap copy.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">OriginCursor showwhile⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user waitbug.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">until⦂ user nobug do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">pt &larr;screenimage mp + screenimage rectangle origin.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection translateto: pt ; blink<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection  displayat: 0⌾0 effect: 1 clippedBy: self frame.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self deselect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ t from: selection do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">screenimage add: t.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection &larr; false.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">top </span><span class="small">|  i delta <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["translate the current selection to the top of the window and update the document to reflect any changes in the subimages which are scrolled out of the screenimage."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">selection⇒<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">delta &larr; (selection rectangle origin - screenimage rectangle origin).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self update. selection &larr; false.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">documentwindow translate: (0⌾ (delta y)). "move window on document"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"> self buildscreenimage ; show. <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">"reconstruct screen image, including reestablishing  first and last indices"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self update.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">documentwindow &larr; Rectangle new origin: document rectangle origin<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">extent: (document width) ⌾ (self frame height).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self buildscreenimage ; show.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span></div>
<div class="line left">
<span class="small bold">update </span><span class="small">|  i <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["update the document to reflect any changes in the subimages ."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">XeqCursor topage1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[selection⇒</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[self deselect]].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">document deleteI: firstindex to: lastindex. "update document"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ i to: screenimage length  do⦂ <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[document insert: <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">(screenimage◦i translate: (0⌾documentwindow origin y)).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">document resize.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">NormalCursor topage1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span></div>
<div class="line left">
<span class="small"></span></div>
<div class="line left">
<span class="small">SystemOrganization classify: ↪DocumentEditor under: &rsquo;FPI Packages&rsquo;.</span></div>
<div class="line left">
<span class="small">DocumentEditor classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span class="medium bold"><br>"Heading"</span></div>
<div class="line left">
<span class="medium bold">Class new title: &rsquo;Heading&rsquo;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="medium bold">subclassof: Image<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="medium bold">fields: &rsquo;formset index charactercodes currentcharacter&rsquo;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="medium bold">declare: &rsquo;headingmenu &rsquo;;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="medium bold">asFollows</span></div>
<div class="line left">
<span class="small italic"><br>This class has not yet been commented</span></div>
<div class="line left">
<span class="medium bold"><br>INIT</span></div>
<div class="line left">
<span class="small bold">classInit <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["menu for the Heading edits."<br><br>headingmenu &larr; Menu new string:<br>&rsquo;right<br>left<br>up<br>down<br>font<br>&rsquo;.<br><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">origin: origin formset: formset currentcharacter: currentcharacter<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["initilization of a Heading (used in copy)"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[formset is: Integer⇒ [ formset &larr; FormSet new fromstyle:<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">DefaultTextStyle styleindex: formset.]].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self origin: origin extent: (200⌾formset height).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">origin: origin index: index charactercodes: charactercodes<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small bold">currentcharacter: currentcharacter | char w delta<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["initilization of a Heading (used in copy)"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">formset &larr; FormSet new fromstyle:<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">DefaultTextStyle styleindex: index.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[ nil ≡ charactercodes ⇒ [ charactercodes &larr; Set new default]].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self origin: origin extent: (200⌾formset height).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">w &larr; 0.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">delta &larr; origin copy.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self translate: (0⌾0 - delta).</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ char from: charactercodes do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">char &larr; formset asForm: char.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self addpath: w⌾0 andform: char.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">w &larr; w + char width.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self translate: delta.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇑ self<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="medium bold"><br>EDIT</span></div>
<div class="line left">
<span class="small bold">down | delta<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["move the current character down one bit."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self boxcomp.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">(self◦currentcharacter) translate: (0⌾1).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">delta &larr; origin copy.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self translate: (0⌾0 - delta) ; resize ; translate: delta.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self white ; display: 1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self boxcomp.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">edit: parentimage </span><span class="small">| pt <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["Simple Heading (line) editor for now."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self display: 0.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">until⦂ 1=2 do⦂ "forever for now"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user kbck⇒<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[ self typein ]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user yellowbug ⇒</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">headingmenu bug<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=1⇒</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[self right]; "move current character right one bit"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=2⇒</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[self left]; "move current character left one bit"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=3⇒</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[self up]; "move current character up one bit"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=4⇒</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[self down]; "move current character down one bit"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">=5⇒</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[self newfont] "change fonts"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user redbug ⇒ </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[(rectangle has: (pt&larr; user mp))⇒<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[pt &larr; pt - (rectangle origin).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">currentcharacter&larr; self indexofsubimageat: pt.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">currentcharacter⇒<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self◦currentcharacter displayat: self origin<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">effect: 2 clippedBy: user screenrect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self◦currentcharacter displayat: self origin<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">effect: 2 clippedBy: user screenrect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇑ self<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">user bluebug ⇒ </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇑ self.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">] "exit back to the parentimage" <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">left | i delta<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["move the current character and all those to the right of it to the left one bit."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self boxcomp.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ i from: (currentcharacter to: self length) do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[ (self◦i) translate: (0⌾0) -(1⌾0) ].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">delta &larr; origin copy.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self translate: (0⌾0 - delta) ; resize ; translate: delta.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self white ; display: 1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self boxcomp.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">newfont </span><span class="small">| w char charcount delta i<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">index &larr;(user request: &rsquo;index of new font . .  &rsquo; ) asInteger.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">formset &larr; FormSet new fromstyle: DefaultTextStyle styleindex: index.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self white.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ i to: position do⦂ [ self◦i &larr; nil ].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">position &larr; 0.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">w &larr; 0.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">charcount &larr; 0.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">delta &larr; origin copy.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self translate: (0⌾0 - delta).</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ char from: charactercodes do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[nil≡ char ⇒ []<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">char &larr; formset asForm: char.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">char displayat: delta+ (w⌾0) effect: 0 clippedBy: user screenrect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self addpath: w⌾0 andform: char.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">w &larr; w + char width.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">charcount &larr; charcount+1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self resize.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self translate: delta.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇑ self<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">right | i delta<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["move the current character and all those to the right of it to the right one bit."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self boxcomp.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ i from: (currentcharacter to: self length) do⦂ [ (self◦i) translate: (1⌾0) ].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">delta &larr; origin copy.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self translate: (0⌾0 - delta) ; resize ; translate: delta.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self white ; display: 1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self boxcomp.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">typein </span><span class="small">| w char charcount delta i<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self white.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ i to: position do⦂ [ self◦i &larr; nil ].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">position &larr; 0.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">w &larr; 0.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">charcount &larr; 0.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">charactercodes &larr; Set new default.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">delta &larr; origin copy.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self translate: (0⌾0 - delta).</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">until⦂ (char &larr; user kbd) = 13 do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">(char = 8) ⇒"back space" <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[charcount ≠  0 ⇒ [ <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"> </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">w &larr; w - ( (self◦charcount) width).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">(self◦charcount) white.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self deleteimage: charcount.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">charactercodes deleteI: charcount.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">charcount &larr; charcount -1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">charactercodes add: char.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">char &larr; formset asForm: char.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">char displayat: delta+ (w⌾0) effect: 0 clippedBy: user screenrect.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self addpath: w⌾0 andform: char.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">w &larr; w + char width.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">charcount &larr; charcount+1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self resize.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self translate: delta.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇑ self<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">up | delta<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["move the current character up one bit."<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self boxcomp.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">(self◦currentcharacter) translate: (0⌾0) - (0⌾1).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">delta &larr; origin copy.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self translate: (0⌾0 - delta) ; resize ; translate: delta.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self white ; display: 1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self boxcomp.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="medium bold"><br>SYSTEM</span></div>
<div class="line left">
<span class="small bold">copy </span><span class="small">| h i<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">h&larr; Heading new origin: (rectangle origin) copy index: index charactercodes: (charactercodes copy)<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">currentcharacter: currentcharacter copy.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">h rectangle: rectangle copy.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ i to: self length do⦂ <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">h add: (self◦i) copy <br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇑ h<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">fromPress: press value:  s </span><span class="small">| numberofcharacters  i <br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["retrieves and builds an instance of class Heading from a press file"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">numberofcharacters&larr; s nextword.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">origin &larr; s nextPoint.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">index &larr; s nextword.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">charactercodes &larr; Set new default.<br><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ i to: numberofcharacters do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[ charactercodes add: s nextword ]</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small"><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇑ self origin: origin index: index charactercodes: charactercodes<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">currentcharacter: 1<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small bold">hideData: complete </span><span class="small">| s i<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">["stores an instance of class Heading on a press file"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">s &larr; Stream new of: (String new: 100).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">s nextword&larr; self length; "number of characters"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">nextPoint&larr; origin;<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">nextword &larr; index.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ i to: self length do⦂ [s nextword &larr; charactercodes◦i].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇑ s contents]</span></div>
<div class="line left">
<span class="small bold">pressCode </span><span class="small">[⇑2]</span></div>
<div class="line left">
<span class="small bold">presson: press in: r </span><span class="small">| hs y t i pressscale [<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">(hs  &larr; press scale*self height) &gt; r height⇒ [<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">"not enough room left on current page.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">assume for now that it will at least fit on an entire page"<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇑ self]<br><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">self hidePress: press complete: ¬1.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">pressscale &larr; press scale.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">press selectfont: (press fontindex: 16*index style: DefaultTextStyle) - 1.<br><br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">for⦂ i to: self length  do⦂<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">[<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">press setx:  r leftside + ((self◦i) leftside*pressscale).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">press sety: r bottom - ((self◦i) top*pressscale).<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">press showchar: (charactercodes◦i)<br></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">].<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">⇑ r bottom - ((self height)*pressscale)]</span></div>
<div class="line left">
<span class="small bold">printon: strm </span><span class="small">| t [<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">strm append: &rsquo;a Heading &rsquo;.<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="small">]</span></div>
<div class="line left">
<span class="small"></span></div>
<div class="line left">
<span class="small">SystemOrganization classify: ↪Heading under: &rsquo;FPI Packages&rsquo;.</span></div>
<div class="line left">
<span class="small">Heading classInit</span></div>
  </body>
</html>
